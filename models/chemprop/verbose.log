Command line
python /usr/local/lib/python3.10/dist-packages/ipykernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-0831b817-b956-44b6-9ad1-5b41ca65693c.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/data/binarized_chemprop_trainset.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc', 'accuracy', 'f1'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc', 'accuracy', 'f1'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/models/antibiotic_chemprop',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': '/content/data/binarized_chemprop_testset.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['fluor'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 6.9953e-01, PNorm = 34.0109, GNorm = 0.3122, lr_0 = 2.1512e-04
Loss = 6.8686e-01, PNorm = 34.0154, GNorm = 1.3049, lr_0 = 3.1977e-04
Loss = 6.7338e-01, PNorm = 34.0253, GNorm = 0.3134, lr_0 = 4.2442e-04
Loss = 6.8090e-01, PNorm = 34.0417, GNorm = 0.8247, lr_0 = 5.2907e-04
Validation prc-auc = 0.680886
Validation auc = 0.723451
Validation accuracy = 0.566116
Validation f1 = 0.198473
Epoch 1
Loss = 6.6386e-01, PNorm = 34.0712, GNorm = 0.2993, lr_0 = 6.4419e-04
Loss = 6.5340e-01, PNorm = 34.1165, GNorm = 1.5097, lr_0 = 7.4884e-04
Loss = 6.3751e-01, PNorm = 34.1676, GNorm = 1.1612, lr_0 = 8.5349e-04
Loss = 6.9849e-01, PNorm = 34.2251, GNorm = 1.4039, lr_0 = 9.5814e-04
Validation prc-auc = 0.699399
Validation auc = 0.736049
Validation accuracy = 0.557851
Validation f1 = 0.195489
Epoch 2
Loss = 6.5388e-01, PNorm = 34.3043, GNorm = 0.5742, lr_0 = 9.8859e-04
Loss = 6.2257e-01, PNorm = 34.4112, GNorm = 0.7720, lr_0 = 9.6986e-04
Loss = 6.3234e-01, PNorm = 34.4872, GNorm = 0.3516, lr_0 = 9.5149e-04
Loss = 6.4128e-01, PNorm = 34.5468, GNorm = 0.8312, lr_0 = 9.3347e-04
Loss = 6.2014e-01, PNorm = 34.6154, GNorm = 0.4503, lr_0 = 9.1579e-04
Loss = 6.2809e-01, PNorm = 34.6216, GNorm = 0.4801, lr_0 = 9.1404e-04
Validation prc-auc = 0.701640
Validation auc = 0.743923
Validation accuracy = 0.681818
Validation f1 = 0.713755
Epoch 3
Loss = 5.9822e-01, PNorm = 34.6885, GNorm = 1.1773, lr_0 = 8.9672e-04
Loss = 6.1916e-01, PNorm = 34.7417, GNorm = 0.3856, lr_0 = 8.7974e-04
Loss = 5.9645e-01, PNorm = 34.8085, GNorm = 0.2987, lr_0 = 8.6307e-04
Loss = 5.6652e-01, PNorm = 34.8809, GNorm = 1.9513, lr_0 = 8.4672e-04
Validation prc-auc = 0.707061
Validation auc = 0.749572
Validation accuracy = 0.665289
Validation f1 = 0.703297
Epoch 4
Loss = 6.1176e-01, PNorm = 34.9347, GNorm = 0.8625, lr_0 = 8.3068e-04
Loss = 5.8234e-01, PNorm = 34.9926, GNorm = 0.3948, lr_0 = 8.1495e-04
Loss = 5.6366e-01, PNorm = 35.0718, GNorm = 0.2801, lr_0 = 7.9951e-04
Loss = 5.5102e-01, PNorm = 35.1340, GNorm = 0.3753, lr_0 = 7.8437e-04
Validation prc-auc = 0.727360
Validation auc = 0.773571
Validation accuracy = 0.706612
Validation f1 = 0.710204
Epoch 5
Loss = 5.4678e-01, PNorm = 35.1847, GNorm = 0.9270, lr_0 = 7.6804e-04
Loss = 5.7156e-01, PNorm = 35.2455, GNorm = 0.8314, lr_0 = 7.5349e-04
Loss = 5.7202e-01, PNorm = 35.3059, GNorm = 0.5418, lr_0 = 7.3921e-04
Loss = 5.7909e-01, PNorm = 35.3503, GNorm = 0.6941, lr_0 = 7.2521e-04
Loss = 5.9907e-01, PNorm = 35.4019, GNorm = 0.8188, lr_0 = 7.1147e-04
Validation prc-auc = 0.698048
Validation auc = 0.770010
Validation accuracy = 0.694215
Validation f1 = 0.739437
Epoch 6
Loss = 5.5719e-01, PNorm = 35.4847, GNorm = 0.5028, lr_0 = 6.9800e-04
Loss = 5.6521e-01, PNorm = 35.5636, GNorm = 0.5220, lr_0 = 6.8478e-04
Loss = 5.7196e-01, PNorm = 35.6039, GNorm = 0.8594, lr_0 = 6.7180e-04
Loss = 5.7550e-01, PNorm = 35.6397, GNorm = 0.3841, lr_0 = 6.5908e-04
Validation prc-auc = 0.754229
Validation auc = 0.785074
Validation accuracy = 0.723140
Validation f1 = 0.714894
Epoch 7
Loss = 5.8676e-01, PNorm = 35.7121, GNorm = 0.8454, lr_0 = 6.4536e-04
Loss = 5.5711e-01, PNorm = 35.7714, GNorm = 1.3054, lr_0 = 6.3313e-04
Loss = 5.7014e-01, PNorm = 35.8159, GNorm = 1.3420, lr_0 = 6.2114e-04
Loss = 5.1633e-01, PNorm = 35.8717, GNorm = 1.1637, lr_0 = 6.0937e-04
Validation prc-auc = 0.743535
Validation auc = 0.780555
Validation accuracy = 0.727273
Validation f1 = 0.729508
Epoch 8
Loss = 6.2733e-01, PNorm = 35.9088, GNorm = 0.6415, lr_0 = 5.9783e-04
Loss = 5.4927e-01, PNorm = 35.9729, GNorm = 0.7951, lr_0 = 5.8651e-04
Loss = 5.4036e-01, PNorm = 36.0439, GNorm = 0.7974, lr_0 = 5.7540e-04
Loss = 5.6997e-01, PNorm = 36.0825, GNorm = 0.9467, lr_0 = 5.6450e-04
Loss = 4.9307e-01, PNorm = 36.1332, GNorm = 0.4912, lr_0 = 5.5380e-04
Validation prc-auc = 0.733725
Validation auc = 0.786957
Validation accuracy = 0.690083
Validation f1 = 0.678112
Epoch 9
Loss = 5.2678e-01, PNorm = 36.1668, GNorm = 1.3765, lr_0 = 5.4227e-04
Loss = 5.5563e-01, PNorm = 36.2117, GNorm = 0.6829, lr_0 = 5.3200e-04
Loss = 5.1895e-01, PNorm = 36.2549, GNorm = 0.5571, lr_0 = 5.2192e-04
Loss = 5.3573e-01, PNorm = 36.3137, GNorm = 0.5231, lr_0 = 5.1204e-04
Validation prc-auc = 0.747090
Validation auc = 0.801232
Validation accuracy = 0.727273
Validation f1 = 0.707965
Epoch 10
Loss = 5.4894e-01, PNorm = 36.3582, GNorm = 0.6937, lr_0 = 5.0234e-04
Loss = 5.5134e-01, PNorm = 36.4150, GNorm = 2.0435, lr_0 = 4.9282e-04
Loss = 5.3178e-01, PNorm = 36.4766, GNorm = 0.5504, lr_0 = 4.8349e-04
Loss = 5.3776e-01, PNorm = 36.5313, GNorm = 1.2301, lr_0 = 4.7433e-04
Validation prc-auc = 0.743393
Validation auc = 0.796782
Validation accuracy = 0.723140
Validation f1 = 0.719665
Epoch 11
Loss = 4.8132e-01, PNorm = 36.5786, GNorm = 0.4918, lr_0 = 4.6445e-04
Loss = 5.1624e-01, PNorm = 36.6259, GNorm = 1.2940, lr_0 = 4.5566e-04
Loss = 5.4175e-01, PNorm = 36.6655, GNorm = 0.9738, lr_0 = 4.4703e-04
Loss = 5.0929e-01, PNorm = 36.7074, GNorm = 0.5690, lr_0 = 4.3856e-04
Loss = 5.4113e-01, PNorm = 36.7400, GNorm = 0.9218, lr_0 = 4.3025e-04
Validation prc-auc = 0.735941
Validation auc = 0.797090
Validation accuracy = 0.698347
Validation f1 = 0.683983
Epoch 12
Loss = 5.2960e-01, PNorm = 36.7720, GNorm = 0.8262, lr_0 = 4.2210e-04
Loss = 5.1044e-01, PNorm = 36.8115, GNorm = 0.5181, lr_0 = 4.1410e-04
Loss = 5.1225e-01, PNorm = 36.8588, GNorm = 0.7519, lr_0 = 4.0626e-04
Loss = 5.3071e-01, PNorm = 36.8916, GNorm = 0.5487, lr_0 = 3.9856e-04
Validation prc-auc = 0.759092
Validation auc = 0.811708
Validation accuracy = 0.727273
Validation f1 = 0.729508
Epoch 13
Loss = 5.0257e-01, PNorm = 36.9351, GNorm = 0.6724, lr_0 = 3.9101e-04
Loss = 5.0998e-01, PNorm = 36.9754, GNorm = 0.3946, lr_0 = 3.8361e-04
Loss = 5.4360e-01, PNorm = 37.0076, GNorm = 0.4595, lr_0 = 3.7634e-04
Loss = 4.9787e-01, PNorm = 37.0328, GNorm = 0.3241, lr_0 = 3.6921e-04
Validation prc-auc = 0.758912
Validation auc = 0.815748
Validation accuracy = 0.739669
Validation f1 = 0.731915
Epoch 14
Loss = 5.3929e-01, PNorm = 37.0784, GNorm = 0.7899, lr_0 = 3.6153e-04
Loss = 5.0397e-01, PNorm = 37.1198, GNorm = 0.4940, lr_0 = 3.5468e-04
Loss = 5.0154e-01, PNorm = 37.1504, GNorm = 0.5426, lr_0 = 3.4796e-04
Loss = 4.7036e-01, PNorm = 37.1889, GNorm = 0.4886, lr_0 = 3.4137e-04
Loss = 5.1678e-01, PNorm = 37.2184, GNorm = 0.8808, lr_0 = 3.3490e-04
Validation prc-auc = 0.773750
Validation auc = 0.827319
Validation accuracy = 0.743802
Validation f1 = 0.735043
Epoch 15
Loss = 4.7891e-01, PNorm = 37.2474, GNorm = 0.6786, lr_0 = 3.2856e-04
Loss = 5.0735e-01, PNorm = 37.2685, GNorm = 0.8262, lr_0 = 3.2233e-04
Loss = 4.7783e-01, PNorm = 37.2982, GNorm = 0.5754, lr_0 = 3.1623e-04
Loss = 4.9432e-01, PNorm = 37.3311, GNorm = 0.8448, lr_0 = 3.1024e-04
Validation prc-auc = 0.767796
Validation auc = 0.825471
Validation accuracy = 0.743802
Validation f1 = 0.737288
Epoch 16
Loss = 4.7576e-01, PNorm = 37.3583, GNorm = 0.6422, lr_0 = 3.0378e-04
Loss = 4.8349e-01, PNorm = 37.3880, GNorm = 0.7090, lr_0 = 2.9802e-04
Loss = 4.8645e-01, PNorm = 37.4104, GNorm = 1.6263, lr_0 = 2.9238e-04
Loss = 4.9356e-01, PNorm = 37.4403, GNorm = 1.0377, lr_0 = 2.8684e-04
Loss = 5.0370e-01, PNorm = 37.4710, GNorm = 0.8809, lr_0 = 2.8141e-04
Validation prc-auc = 0.782543
Validation auc = 0.834646
Validation accuracy = 0.739669
Validation f1 = 0.722467
Epoch 17
Loss = 5.1630e-01, PNorm = 37.4996, GNorm = 0.8696, lr_0 = 2.7608e-04
Loss = 4.8626e-01, PNorm = 37.5212, GNorm = 1.1495, lr_0 = 2.7085e-04
Loss = 4.9725e-01, PNorm = 37.5451, GNorm = 0.5650, lr_0 = 2.6572e-04
Loss = 4.8674e-01, PNorm = 37.5763, GNorm = 1.0487, lr_0 = 2.6068e-04
Validation prc-auc = 0.756514
Validation auc = 0.823382
Validation accuracy = 0.735537
Validation f1 = 0.721739
Epoch 18
Loss = 4.3705e-01, PNorm = 37.6158, GNorm = 0.5510, lr_0 = 2.5526e-04
Loss = 4.9641e-01, PNorm = 37.6427, GNorm = 1.0161, lr_0 = 2.5042e-04
Loss = 4.7619e-01, PNorm = 37.6619, GNorm = 1.6084, lr_0 = 2.4568e-04
Loss = 5.1961e-01, PNorm = 37.6761, GNorm = 0.7381, lr_0 = 2.4102e-04
Validation prc-auc = 0.773866
Validation auc = 0.834474
Validation accuracy = 0.735537
Validation f1 = 0.680000
Epoch 19
Loss = 5.2198e-01, PNorm = 37.7033, GNorm = 1.8506, lr_0 = 2.3646e-04
Loss = 4.8139e-01, PNorm = 37.7252, GNorm = 0.7012, lr_0 = 2.3198e-04
Loss = 4.8038e-01, PNorm = 37.7512, GNorm = 1.1610, lr_0 = 2.2758e-04
Loss = 4.9285e-01, PNorm = 37.7716, GNorm = 1.4957, lr_0 = 2.2327e-04
Loss = 4.3918e-01, PNorm = 37.7913, GNorm = 0.8638, lr_0 = 2.1904e-04
Loss = 4.8115e-01, PNorm = 37.7937, GNorm = 1.7152, lr_0 = 2.1863e-04
Validation prc-auc = 0.779692
Validation auc = 0.835638
Validation accuracy = 0.735537
Validation f1 = 0.721739
Epoch 20
Loss = 4.6622e-01, PNorm = 37.8154, GNorm = 0.7512, lr_0 = 2.1448e-04
Loss = 4.7771e-01, PNorm = 37.8353, GNorm = 0.7528, lr_0 = 2.1042e-04
Loss = 4.6430e-01, PNorm = 37.8556, GNorm = 0.7992, lr_0 = 2.0644e-04
Loss = 4.4817e-01, PNorm = 37.8808, GNorm = 1.0675, lr_0 = 2.0252e-04
Validation prc-auc = 0.775141
Validation auc = 0.836597
Validation accuracy = 0.727273
Validation f1 = 0.705357
Epoch 21
Loss = 4.4931e-01, PNorm = 37.8933, GNorm = 0.7017, lr_0 = 1.9869e-04
Loss = 4.7786e-01, PNorm = 37.9101, GNorm = 0.6686, lr_0 = 1.9492e-04
Loss = 4.5029e-01, PNorm = 37.9288, GNorm = 1.6921, lr_0 = 1.9123e-04
Loss = 4.9837e-01, PNorm = 37.9478, GNorm = 0.6488, lr_0 = 1.8761e-04
Validation prc-auc = 0.786151
Validation auc = 0.841630
Validation accuracy = 0.760331
Validation f1 = 0.756303
Epoch 22
Loss = 4.7032e-01, PNorm = 37.9683, GNorm = 0.8270, lr_0 = 1.8370e-04
Loss = 4.4796e-01, PNorm = 37.9882, GNorm = 1.0942, lr_0 = 1.8022e-04
Loss = 4.6436e-01, PNorm = 38.0024, GNorm = 0.5666, lr_0 = 1.7681e-04
Loss = 4.6217e-01, PNorm = 38.0193, GNorm = 2.0101, lr_0 = 1.7346e-04
Loss = 4.8475e-01, PNorm = 38.0360, GNorm = 0.6884, lr_0 = 1.7018e-04
Validation prc-auc = 0.787832
Validation auc = 0.841253
Validation accuracy = 0.752066
Validation f1 = 0.739130
Epoch 23
Loss = 4.9252e-01, PNorm = 38.0509, GNorm = 2.3701, lr_0 = 1.6695e-04
Loss = 4.6096e-01, PNorm = 38.0667, GNorm = 0.7224, lr_0 = 1.6379e-04
Loss = 4.2645e-01, PNorm = 38.0835, GNorm = 0.9966, lr_0 = 1.6069e-04
Loss = 4.5504e-01, PNorm = 38.1001, GNorm = 1.2369, lr_0 = 1.5764e-04
Validation prc-auc = 0.787426
Validation auc = 0.839404
Validation accuracy = 0.768595
Validation f1 = 0.770492
Epoch 24
Loss = 4.6857e-01, PNorm = 38.1147, GNorm = 1.7386, lr_0 = 1.5436e-04
Loss = 4.6010e-01, PNorm = 38.1282, GNorm = 0.7035, lr_0 = 1.5144e-04
Loss = 4.4308e-01, PNorm = 38.1425, GNorm = 1.3283, lr_0 = 1.4857e-04
Loss = 4.6297e-01, PNorm = 38.1581, GNorm = 1.0536, lr_0 = 1.4575e-04
Validation prc-auc = 0.793307
Validation auc = 0.844094
Validation accuracy = 0.772727
Validation f1 = 0.771784
Epoch 25
Loss = 4.9856e-01, PNorm = 38.1704, GNorm = 1.1050, lr_0 = 1.4299e-04
Loss = 4.3846e-01, PNorm = 38.1867, GNorm = 1.0028, lr_0 = 1.4028e-04
Loss = 4.2486e-01, PNorm = 38.2019, GNorm = 1.4696, lr_0 = 1.3763e-04
Loss = 4.9254e-01, PNorm = 38.2106, GNorm = 0.7029, lr_0 = 1.3502e-04
Loss = 4.2348e-01, PNorm = 38.2233, GNorm = 0.9992, lr_0 = 1.3246e-04
Validation prc-auc = 0.793852
Validation auc = 0.845977
Validation accuracy = 0.756198
Validation f1 = 0.733032
Epoch 26
Loss = 4.2181e-01, PNorm = 38.2402, GNorm = 1.1335, lr_0 = 1.2995e-04
Loss = 4.9194e-01, PNorm = 38.2535, GNorm = 0.8476, lr_0 = 1.2749e-04
Loss = 4.4322e-01, PNorm = 38.2653, GNorm = 1.0267, lr_0 = 1.2508e-04
Loss = 4.1214e-01, PNorm = 38.2784, GNorm = 0.6317, lr_0 = 1.2271e-04
Validation prc-auc = 0.803866
Validation auc = 0.844197
Validation accuracy = 0.764463
Validation f1 = 0.759494
Epoch 27
Loss = 4.4261e-01, PNorm = 38.2878, GNorm = 1.5836, lr_0 = 1.2015e-04
Loss = 4.2358e-01, PNorm = 38.3008, GNorm = 0.9436, lr_0 = 1.1788e-04
Loss = 4.5626e-01, PNorm = 38.3118, GNorm = 0.6711, lr_0 = 1.1564e-04
Loss = 4.4567e-01, PNorm = 38.3215, GNorm = 0.8250, lr_0 = 1.1345e-04
Validation prc-auc = 0.788739
Validation auc = 0.846183
Validation accuracy = 0.747934
Validation f1 = 0.726457
Epoch 28
Loss = 5.2678e-01, PNorm = 38.3310, GNorm = 0.6695, lr_0 = 1.1130e-04
Loss = 4.6126e-01, PNorm = 38.3382, GNorm = 2.0853, lr_0 = 1.0920e-04
Loss = 4.5221e-01, PNorm = 38.3465, GNorm = 0.8689, lr_0 = 1.0713e-04
Loss = 4.1899e-01, PNorm = 38.3570, GNorm = 0.7192, lr_0 = 1.0510e-04
Loss = 4.2556e-01, PNorm = 38.3682, GNorm = 1.0134, lr_0 = 1.0311e-04
Validation prc-auc = 0.790188
Validation auc = 0.848066
Validation accuracy = 0.776860
Validation f1 = 0.784000
Epoch 29
Loss = 4.4773e-01, PNorm = 38.3784, GNorm = 0.9675, lr_0 = 1.0096e-04
Loss = 4.6395e-01, PNorm = 38.3875, GNorm = 1.3411, lr_0 = 1.0000e-04
Loss = 4.5229e-01, PNorm = 38.3968, GNorm = 1.0258, lr_0 = 1.0000e-04
Loss = 4.1108e-01, PNorm = 38.4064, GNorm = 0.8065, lr_0 = 1.0000e-04
Validation prc-auc = 0.803530
Validation auc = 0.852311
Validation accuracy = 0.764463
Validation f1 = 0.753247
Model 0 best validation prc-auc = 0.803866 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.706763
Model 0 test auc = 0.817911
Model 0 test accuracy = 0.745068
Model 0 test f1 = 0.715254
Ensemble test prc-auc = 0.706763
Ensemble test auc = 0.817911
Ensemble test accuracy = 0.745068
Ensemble test f1 = 0.715254
Fold 1
Splitting data with seed 1
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 6.8406e-01, PNorm = 34.0123, GNorm = 0.7002, lr_0 = 2.1512e-04
Loss = 6.9604e-01, PNorm = 34.0161, GNorm = 1.8470, lr_0 = 3.1977e-04
Loss = 6.9545e-01, PNorm = 34.0229, GNorm = 0.3932, lr_0 = 4.2442e-04
Loss = 6.8814e-01, PNorm = 34.0360, GNorm = 0.2409, lr_0 = 5.2907e-04
Validation prc-auc = 0.572507
Validation auc = 0.656060
Validation accuracy = 0.599174
Validation f1 = 0.492147
Epoch 1
Loss = 6.8564e-01, PNorm = 34.0587, GNorm = 0.0975, lr_0 = 6.4419e-04
Loss = 6.6470e-01, PNorm = 34.0935, GNorm = 1.3877, lr_0 = 7.4884e-04
Loss = 6.5907e-01, PNorm = 34.1508, GNorm = 0.6390, lr_0 = 8.5349e-04
Loss = 6.3449e-01, PNorm = 34.2331, GNorm = 0.6176, lr_0 = 9.5814e-04
Validation prc-auc = 0.622311
Validation auc = 0.721393
Validation accuracy = 0.677686
Validation f1 = 0.621359
Epoch 2
Loss = 6.1460e-01, PNorm = 34.3064, GNorm = 1.1247, lr_0 = 9.8859e-04
Loss = 6.1700e-01, PNorm = 34.3903, GNorm = 1.2881, lr_0 = 9.6986e-04
Loss = 6.2773e-01, PNorm = 34.4742, GNorm = 0.9816, lr_0 = 9.5149e-04
Loss = 6.1346e-01, PNorm = 34.5451, GNorm = 1.5277, lr_0 = 9.3347e-04
Loss = 6.0184e-01, PNorm = 34.6252, GNorm = 1.2047, lr_0 = 9.1579e-04
Loss = 8.4170e-01, PNorm = 34.6325, GNorm = 0.9241, lr_0 = 9.1404e-04
Validation prc-auc = 0.616812
Validation auc = 0.719009
Validation accuracy = 0.657025
Validation f1 = 0.684411
Epoch 3
Loss = 6.1151e-01, PNorm = 34.6986, GNorm = 0.4713, lr_0 = 8.9672e-04
Loss = 6.1305e-01, PNorm = 34.7742, GNorm = 0.5737, lr_0 = 8.7974e-04
Loss = 5.7042e-01, PNorm = 34.8688, GNorm = 0.4016, lr_0 = 8.6307e-04
Loss = 6.0566e-01, PNorm = 34.9367, GNorm = 0.4109, lr_0 = 8.4672e-04
Validation prc-auc = 0.653260
Validation auc = 0.742019
Validation accuracy = 0.685950
Validation f1 = 0.608247
Epoch 4
Loss = 6.1009e-01, PNorm = 35.0101, GNorm = 0.5837, lr_0 = 8.3068e-04
Loss = 5.9349e-01, PNorm = 35.0774, GNorm = 0.3912, lr_0 = 8.1495e-04
Loss = 5.5080e-01, PNorm = 35.1417, GNorm = 1.0797, lr_0 = 7.9951e-04
Loss = 5.4390e-01, PNorm = 35.2105, GNorm = 0.6259, lr_0 = 7.8437e-04
Validation prc-auc = 0.665503
Validation auc = 0.762334
Validation accuracy = 0.719008
Validation f1 = 0.660000
Epoch 5
Loss = 5.6488e-01, PNorm = 35.2775, GNorm = 0.3856, lr_0 = 7.6804e-04
Loss = 5.5442e-01, PNorm = 35.3531, GNorm = 0.4279, lr_0 = 7.5349e-04
Loss = 5.9780e-01, PNorm = 35.4125, GNorm = 1.3619, lr_0 = 7.3921e-04
Loss = 5.7218e-01, PNorm = 35.4791, GNorm = 1.4494, lr_0 = 7.2521e-04
Loss = 5.5729e-01, PNorm = 35.5492, GNorm = 0.4172, lr_0 = 7.1147e-04
Validation prc-auc = 0.668196
Validation auc = 0.768277
Validation accuracy = 0.714876
Validation f1 = 0.660099
Epoch 6
Loss = 5.4536e-01, PNorm = 35.6166, GNorm = 0.3942, lr_0 = 6.9800e-04
Loss = 5.7687e-01, PNorm = 35.6753, GNorm = 1.4555, lr_0 = 6.8478e-04
Loss = 5.6861e-01, PNorm = 35.7390, GNorm = 0.4223, lr_0 = 6.7180e-04
Loss = 5.3442e-01, PNorm = 35.8053, GNorm = 1.3797, lr_0 = 6.5908e-04
Validation prc-auc = 0.697685
Validation auc = 0.779194
Validation accuracy = 0.735537
Validation f1 = 0.711712
Epoch 7
Loss = 4.9020e-01, PNorm = 35.8921, GNorm = 1.3461, lr_0 = 6.4536e-04
Loss = 5.5236e-01, PNorm = 35.9626, GNorm = 1.4336, lr_0 = 6.3313e-04
Loss = 5.8728e-01, PNorm = 36.0141, GNorm = 0.6516, lr_0 = 6.2114e-04
Loss = 5.6739e-01, PNorm = 36.0829, GNorm = 0.2870, lr_0 = 6.0937e-04
Validation prc-auc = 0.698102
Validation auc = 0.780438
Validation accuracy = 0.714876
Validation f1 = 0.711297
Epoch 8
Loss = 6.3028e-01, PNorm = 36.1348, GNorm = 0.3571, lr_0 = 5.9783e-04
Loss = 5.1947e-01, PNorm = 36.1799, GNorm = 0.4765, lr_0 = 5.8651e-04
Loss = 4.9004e-01, PNorm = 36.2486, GNorm = 1.4069, lr_0 = 5.7540e-04
Loss = 5.5852e-01, PNorm = 36.2956, GNorm = 1.0533, lr_0 = 5.6450e-04
Loss = 5.3273e-01, PNorm = 36.3366, GNorm = 0.4761, lr_0 = 5.5380e-04
Validation prc-auc = 0.703245
Validation auc = 0.785690
Validation accuracy = 0.723140
Validation f1 = 0.709957
Epoch 9
Loss = 5.2660e-01, PNorm = 36.3859, GNorm = 1.3191, lr_0 = 5.4227e-04
Loss = 5.0144e-01, PNorm = 36.4358, GNorm = 1.9063, lr_0 = 5.3200e-04
Loss = 5.0904e-01, PNorm = 36.4832, GNorm = 0.5577, lr_0 = 5.2192e-04
Loss = 5.5277e-01, PNorm = 36.5234, GNorm = 0.5577, lr_0 = 5.1204e-04
Validation prc-auc = 0.705994
Validation auc = 0.779643
Validation accuracy = 0.706612
Validation f1 = 0.692641
Epoch 10
Loss = 5.0027e-01, PNorm = 36.5677, GNorm = 0.8005, lr_0 = 5.0234e-04
Loss = 5.1050e-01, PNorm = 36.6157, GNorm = 0.4519, lr_0 = 4.9282e-04
Loss = 5.0143e-01, PNorm = 36.6701, GNorm = 0.8773, lr_0 = 4.8349e-04
Loss = 5.0134e-01, PNorm = 36.7199, GNorm = 0.6374, lr_0 = 4.7433e-04
Validation prc-auc = 0.723973
Validation auc = 0.799198
Validation accuracy = 0.747934
Validation f1 = 0.702439
Epoch 11
Loss = 5.3440e-01, PNorm = 36.7583, GNorm = 0.9854, lr_0 = 4.6445e-04
Loss = 4.7880e-01, PNorm = 36.8010, GNorm = 0.4589, lr_0 = 4.5566e-04
Loss = 5.0129e-01, PNorm = 36.8440, GNorm = 0.7717, lr_0 = 4.4703e-04
Loss = 5.2680e-01, PNorm = 36.8778, GNorm = 0.6955, lr_0 = 4.3856e-04
Loss = 5.1250e-01, PNorm = 36.9158, GNorm = 1.4266, lr_0 = 4.3025e-04
Validation prc-auc = 0.719808
Validation auc = 0.791356
Validation accuracy = 0.731405
Validation f1 = 0.723404
Epoch 12
Loss = 4.8730e-01, PNorm = 36.9554, GNorm = 0.5404, lr_0 = 4.2210e-04
Loss = 4.9461e-01, PNorm = 36.9980, GNorm = 1.0741, lr_0 = 4.1410e-04
Loss = 5.0883e-01, PNorm = 37.0380, GNorm = 1.0293, lr_0 = 4.0626e-04
Loss = 5.2500e-01, PNorm = 37.0730, GNorm = 0.9199, lr_0 = 3.9856e-04
Validation prc-auc = 0.721437
Validation auc = 0.800926
Validation accuracy = 0.710744
Validation f1 = 0.642857
Epoch 13
Loss = 5.4265e-01, PNorm = 37.1086, GNorm = 0.5975, lr_0 = 3.9101e-04
Loss = 5.0510e-01, PNorm = 37.1491, GNorm = 0.8481, lr_0 = 3.8361e-04
Loss = 5.1221e-01, PNorm = 37.1805, GNorm = 0.9827, lr_0 = 3.7634e-04
Loss = 4.9296e-01, PNorm = 37.2088, GNorm = 0.7547, lr_0 = 3.6921e-04
Validation prc-auc = 0.731365
Validation auc = 0.809943
Validation accuracy = 0.735537
Validation f1 = 0.724138
Epoch 14
Loss = 4.1758e-01, PNorm = 37.2527, GNorm = 0.7765, lr_0 = 3.6153e-04
Loss = 4.8886e-01, PNorm = 37.2915, GNorm = 0.7510, lr_0 = 3.5468e-04
Loss = 4.6565e-01, PNorm = 37.3310, GNorm = 0.6620, lr_0 = 3.4796e-04
Loss = 4.8227e-01, PNorm = 37.3612, GNorm = 0.9550, lr_0 = 3.4137e-04
Loss = 4.8892e-01, PNorm = 37.3885, GNorm = 0.9164, lr_0 = 3.3490e-04
Validation prc-auc = 0.749381
Validation auc = 0.817130
Validation accuracy = 0.760331
Validation f1 = 0.733945
Epoch 15
Loss = 4.9923e-01, PNorm = 37.4128, GNorm = 0.5686, lr_0 = 3.2856e-04
Loss = 4.8041e-01, PNorm = 37.4342, GNorm = 0.8311, lr_0 = 3.2233e-04
Loss = 4.8874e-01, PNorm = 37.4565, GNorm = 1.0342, lr_0 = 3.1623e-04
Loss = 4.7718e-01, PNorm = 37.4942, GNorm = 0.5570, lr_0 = 3.1024e-04
Validation prc-auc = 0.752596
Validation auc = 0.824040
Validation accuracy = 0.743802
Validation f1 = 0.701923
Epoch 16
Loss = 4.7049e-01, PNorm = 37.5267, GNorm = 1.3867, lr_0 = 3.0378e-04
Loss = 5.0013e-01, PNorm = 37.5510, GNorm = 0.9139, lr_0 = 2.9802e-04
Loss = 4.9637e-01, PNorm = 37.5677, GNorm = 0.9705, lr_0 = 2.9238e-04
Loss = 4.4127e-01, PNorm = 37.5967, GNorm = 0.5564, lr_0 = 2.8684e-04
Loss = 4.7568e-01, PNorm = 37.6297, GNorm = 0.8080, lr_0 = 2.8141e-04
Validation prc-auc = 0.755645
Validation auc = 0.825249
Validation accuracy = 0.743802
Validation f1 = 0.728070
Epoch 17
Loss = 4.6978e-01, PNorm = 37.6572, GNorm = 1.3856, lr_0 = 2.7608e-04
Loss = 4.3626e-01, PNorm = 37.6813, GNorm = 1.4775, lr_0 = 2.7085e-04
Loss = 4.9835e-01, PNorm = 37.7061, GNorm = 0.8449, lr_0 = 2.6572e-04
Loss = 4.5867e-01, PNorm = 37.7344, GNorm = 1.0960, lr_0 = 2.6068e-04
Validation prc-auc = 0.768744
Validation auc = 0.824800
Validation accuracy = 0.743802
Validation f1 = 0.735043
Epoch 18
Loss = 4.7038e-01, PNorm = 37.7636, GNorm = 0.8977, lr_0 = 2.5526e-04
Loss = 4.5957e-01, PNorm = 37.7846, GNorm = 0.9969, lr_0 = 2.5042e-04
Loss = 4.9018e-01, PNorm = 37.8044, GNorm = 0.6171, lr_0 = 2.4568e-04
Loss = 4.3643e-01, PNorm = 37.8271, GNorm = 1.2167, lr_0 = 2.4102e-04
Validation prc-auc = 0.748772
Validation auc = 0.822692
Validation accuracy = 0.760331
Validation f1 = 0.738739
Epoch 19
Loss = 4.7147e-01, PNorm = 37.8505, GNorm = 0.7686, lr_0 = 2.3646e-04
Loss = 4.5590e-01, PNorm = 37.8781, GNorm = 2.2149, lr_0 = 2.3198e-04
Loss = 4.7721e-01, PNorm = 37.8994, GNorm = 0.7761, lr_0 = 2.2758e-04
Loss = 4.5246e-01, PNorm = 37.9129, GNorm = 0.9454, lr_0 = 2.2327e-04
Loss = 4.7385e-01, PNorm = 37.9306, GNorm = 1.2815, lr_0 = 2.1904e-04
Loss = 3.3642e-01, PNorm = 37.9327, GNorm = 0.9432, lr_0 = 2.1863e-04
Validation prc-auc = 0.761149
Validation auc = 0.824903
Validation accuracy = 0.764463
Validation f1 = 0.737327
Epoch 20
Loss = 4.3014e-01, PNorm = 37.9546, GNorm = 0.8500, lr_0 = 2.1448e-04
Loss = 4.7479e-01, PNorm = 37.9728, GNorm = 0.8618, lr_0 = 2.1042e-04
Loss = 4.2691e-01, PNorm = 37.9938, GNorm = 0.9523, lr_0 = 2.0644e-04
Loss = 4.7657e-01, PNorm = 38.0078, GNorm = 0.6080, lr_0 = 2.0252e-04
Validation prc-auc = 0.761877
Validation auc = 0.827045
Validation accuracy = 0.752066
Validation f1 = 0.714286
Epoch 21
Loss = 4.3338e-01, PNorm = 38.0280, GNorm = 0.9795, lr_0 = 1.9869e-04
Loss = 4.3649e-01, PNorm = 38.0458, GNorm = 0.9983, lr_0 = 1.9492e-04
Loss = 4.6840e-01, PNorm = 38.0607, GNorm = 0.9706, lr_0 = 1.9123e-04
Loss = 4.5569e-01, PNorm = 38.0753, GNorm = 0.5820, lr_0 = 1.8761e-04
Validation prc-auc = 0.766572
Validation auc = 0.832366
Validation accuracy = 0.752066
Validation f1 = 0.727273
Epoch 22
Loss = 4.4372e-01, PNorm = 38.0928, GNorm = 0.9998, lr_0 = 1.8370e-04
Loss = 4.6459e-01, PNorm = 38.1099, GNorm = 1.1004, lr_0 = 1.8022e-04
Loss = 4.8409e-01, PNorm = 38.1209, GNorm = 2.2687, lr_0 = 1.7681e-04
Loss = 4.3165e-01, PNorm = 38.1381, GNorm = 0.9447, lr_0 = 1.7346e-04
Loss = 4.0951e-01, PNorm = 38.1574, GNorm = 1.0642, lr_0 = 1.7018e-04
Validation prc-auc = 0.766680
Validation auc = 0.829671
Validation accuracy = 0.747934
Validation f1 = 0.735931
Epoch 23
Loss = 4.4971e-01, PNorm = 38.1741, GNorm = 1.3707, lr_0 = 1.6695e-04
Loss = 4.5967e-01, PNorm = 38.1882, GNorm = 0.7435, lr_0 = 1.6379e-04
Loss = 4.0545e-01, PNorm = 38.2048, GNorm = 0.9471, lr_0 = 1.6069e-04
Loss = 4.5454e-01, PNorm = 38.2188, GNorm = 0.7027, lr_0 = 1.5764e-04
Validation prc-auc = 0.776244
Validation auc = 0.839345
Validation accuracy = 0.768595
Validation f1 = 0.747748
Epoch 24
Loss = 3.8376e-01, PNorm = 38.2351, GNorm = 0.7354, lr_0 = 1.5436e-04
Loss = 4.4725e-01, PNorm = 38.2494, GNorm = 0.9420, lr_0 = 1.5144e-04
Loss = 4.6586e-01, PNorm = 38.2596, GNorm = 1.2218, lr_0 = 1.4857e-04
Loss = 4.1921e-01, PNorm = 38.2726, GNorm = 1.5561, lr_0 = 1.4575e-04
Validation prc-auc = 0.772986
Validation auc = 0.836892
Validation accuracy = 0.764463
Validation f1 = 0.734884
Epoch 25
Loss = 4.1448e-01, PNorm = 38.2878, GNorm = 2.0986, lr_0 = 1.4299e-04
Loss = 4.5806e-01, PNorm = 38.2997, GNorm = 0.9114, lr_0 = 1.4028e-04
Loss = 4.2517e-01, PNorm = 38.3132, GNorm = 0.8552, lr_0 = 1.3763e-04
Loss = 4.1755e-01, PNorm = 38.3269, GNorm = 1.0189, lr_0 = 1.3502e-04
Loss = 4.1217e-01, PNorm = 38.3395, GNorm = 1.1688, lr_0 = 1.3246e-04
Validation prc-auc = 0.774896
Validation auc = 0.838689
Validation accuracy = 0.764463
Validation f1 = 0.748899
Epoch 26
Loss = 3.9625e-01, PNorm = 38.3500, GNorm = 0.6891, lr_0 = 1.2995e-04
Loss = 4.0299e-01, PNorm = 38.3611, GNorm = 1.1455, lr_0 = 1.2749e-04
Loss = 3.8940e-01, PNorm = 38.3754, GNorm = 0.8053, lr_0 = 1.2508e-04
Loss = 4.7823e-01, PNorm = 38.3849, GNorm = 1.7469, lr_0 = 1.2271e-04
Validation prc-auc = 0.775581
Validation auc = 0.838481
Validation accuracy = 0.760331
Validation f1 = 0.721154
Epoch 27
Loss = 4.3362e-01, PNorm = 38.3925, GNorm = 1.0007, lr_0 = 1.2015e-04
Loss = 4.0650e-01, PNorm = 38.4031, GNorm = 0.8522, lr_0 = 1.1788e-04
Loss = 4.3756e-01, PNorm = 38.4125, GNorm = 0.9351, lr_0 = 1.1564e-04
Loss = 4.5571e-01, PNorm = 38.4218, GNorm = 0.5762, lr_0 = 1.1345e-04
Validation prc-auc = 0.776058
Validation auc = 0.840209
Validation accuracy = 0.756198
Validation f1 = 0.737778
Epoch 28
Loss = 4.8009e-01, PNorm = 38.4321, GNorm = 1.0499, lr_0 = 1.1130e-04
Loss = 3.8776e-01, PNorm = 38.4427, GNorm = 0.9666, lr_0 = 1.0920e-04
Loss = 4.3517e-01, PNorm = 38.4532, GNorm = 1.0200, lr_0 = 1.0713e-04
Loss = 4.0171e-01, PNorm = 38.4624, GNorm = 1.1715, lr_0 = 1.0510e-04
Loss = 4.3287e-01, PNorm = 38.4710, GNorm = 0.7245, lr_0 = 1.0311e-04
Validation prc-auc = 0.773260
Validation auc = 0.839518
Validation accuracy = 0.768595
Validation f1 = 0.740741
Epoch 29
Loss = 3.9633e-01, PNorm = 38.4799, GNorm = 1.1089, lr_0 = 1.0096e-04
Loss = 4.1884e-01, PNorm = 38.4904, GNorm = 1.1999, lr_0 = 1.0000e-04
Loss = 4.2464e-01, PNorm = 38.5010, GNorm = 0.9306, lr_0 = 1.0000e-04
Loss = 4.1138e-01, PNorm = 38.5098, GNorm = 1.2246, lr_0 = 1.0000e-04
Validation prc-auc = 0.777698
Validation auc = 0.842351
Validation accuracy = 0.764463
Validation f1 = 0.742081
Model 0 best validation prc-auc = 0.777698 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.711636
Model 0 test auc = 0.830626
Model 0 test accuracy = 0.749621
Model 0 test f1 = 0.727273
Ensemble test prc-auc = 0.711636
Ensemble test auc = 0.830626
Ensemble test accuracy = 0.749621
Ensemble test f1 = 0.727273
Fold 2
Splitting data with seed 2
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 6.8594e-01, PNorm = 34.0119, GNorm = 1.2120, lr_0 = 2.1512e-04
Loss = 7.0336e-01, PNorm = 34.0156, GNorm = 1.1518, lr_0 = 3.1977e-04
Loss = 6.8674e-01, PNorm = 34.0230, GNorm = 0.6285, lr_0 = 4.2442e-04
Loss = 6.7650e-01, PNorm = 34.0396, GNorm = 0.3586, lr_0 = 5.2907e-04
Validation prc-auc = 0.637818
Validation auc = 0.707925
Validation accuracy = 0.512397
Validation f1 = 0.626582
Epoch 1
Loss = 6.9552e-01, PNorm = 34.0679, GNorm = 0.9751, lr_0 = 6.4419e-04
Loss = 6.6378e-01, PNorm = 34.1073, GNorm = 1.1411, lr_0 = 7.4884e-04
Loss = 6.4873e-01, PNorm = 34.1696, GNorm = 0.2576, lr_0 = 8.5349e-04
Loss = 6.7018e-01, PNorm = 34.2405, GNorm = 2.0647, lr_0 = 9.5814e-04
Validation prc-auc = 0.643117
Validation auc = 0.738234
Validation accuracy = 0.661157
Validation f1 = 0.493827
Epoch 2
Loss = 6.8073e-01, PNorm = 34.3171, GNorm = 0.5340, lr_0 = 9.8859e-04
Loss = 6.2967e-01, PNorm = 34.4178, GNorm = 0.6344, lr_0 = 9.6986e-04
Loss = 6.2705e-01, PNorm = 34.5119, GNorm = 2.6032, lr_0 = 9.5149e-04
Loss = 6.4604e-01, PNorm = 34.5825, GNorm = 0.4773, lr_0 = 9.3347e-04
Loss = 6.5272e-01, PNorm = 34.6595, GNorm = 0.2780, lr_0 = 9.1579e-04
Loss = 6.1628e-01, PNorm = 34.6679, GNorm = 0.4893, lr_0 = 9.1404e-04
Validation prc-auc = 0.644278
Validation auc = 0.742614
Validation accuracy = 0.673554
Validation f1 = 0.690196
Epoch 3
Loss = 6.1647e-01, PNorm = 34.7543, GNorm = 0.3921, lr_0 = 8.9672e-04
Loss = 6.1846e-01, PNorm = 34.8331, GNorm = 1.1299, lr_0 = 8.7974e-04
Loss = 6.1296e-01, PNorm = 34.8992, GNorm = 0.2457, lr_0 = 8.6307e-04
Loss = 6.0847e-01, PNorm = 34.9457, GNorm = 1.2086, lr_0 = 8.4672e-04
Validation prc-auc = 0.678529
Validation auc = 0.761661
Validation accuracy = 0.714876
Validation f1 = 0.690583
Epoch 4
Loss = 6.2514e-01, PNorm = 35.0040, GNorm = 0.2619, lr_0 = 8.3068e-04
Loss = 5.7439e-01, PNorm = 35.0646, GNorm = 0.5625, lr_0 = 8.1495e-04
Loss = 6.0036e-01, PNorm = 35.1118, GNorm = 0.2714, lr_0 = 7.9951e-04
Loss = 5.7937e-01, PNorm = 35.1713, GNorm = 0.5213, lr_0 = 7.8437e-04
Validation prc-auc = 0.689946
Validation auc = 0.774209
Validation accuracy = 0.723140
Validation f1 = 0.719665
Epoch 5
Loss = 5.5223e-01, PNorm = 35.2450, GNorm = 0.2899, lr_0 = 7.6804e-04
Loss = 5.6904e-01, PNorm = 35.2949, GNorm = 0.6633, lr_0 = 7.5349e-04
Loss = 5.7448e-01, PNorm = 35.3505, GNorm = 1.2925, lr_0 = 7.3921e-04
Loss = 5.7055e-01, PNorm = 35.4049, GNorm = 0.4848, lr_0 = 7.2521e-04
Loss = 5.7827e-01, PNorm = 35.4675, GNorm = 0.6428, lr_0 = 7.1147e-04
Validation prc-auc = 0.708460
Validation auc = 0.775217
Validation accuracy = 0.706612
Validation f1 = 0.660287
Epoch 6
Loss = 5.9436e-01, PNorm = 35.5385, GNorm = 0.3207, lr_0 = 6.9800e-04
Loss = 5.4792e-01, PNorm = 35.5993, GNorm = 0.7218, lr_0 = 6.8478e-04
Loss = 5.3639e-01, PNorm = 35.6518, GNorm = 0.5045, lr_0 = 6.7180e-04
Loss = 5.6172e-01, PNorm = 35.7055, GNorm = 0.6700, lr_0 = 6.5908e-04
Validation prc-auc = 0.708256
Validation auc = 0.773236
Validation accuracy = 0.706612
Validation f1 = 0.639594
Epoch 7
Loss = 5.8208e-01, PNorm = 35.7718, GNorm = 0.4548, lr_0 = 6.4536e-04
Loss = 5.3107e-01, PNorm = 35.8512, GNorm = 0.4925, lr_0 = 6.3313e-04
Loss = 5.7217e-01, PNorm = 35.8920, GNorm = 0.3876, lr_0 = 6.2114e-04
Loss = 5.5924e-01, PNorm = 35.9376, GNorm = 0.3341, lr_0 = 6.0937e-04
Validation prc-auc = 0.704834
Validation auc = 0.775634
Validation accuracy = 0.735537
Validation f1 = 0.714286
Epoch 8
Loss = 6.1315e-01, PNorm = 36.0060, GNorm = 0.8792, lr_0 = 5.9783e-04
Loss = 5.5889e-01, PNorm = 36.0637, GNorm = 0.4379, lr_0 = 5.8651e-04
Loss = 5.2542e-01, PNorm = 36.1102, GNorm = 0.4375, lr_0 = 5.7540e-04
Loss = 5.2561e-01, PNorm = 36.1629, GNorm = 0.8943, lr_0 = 5.6450e-04
Loss = 5.3278e-01, PNorm = 36.2173, GNorm = 0.4943, lr_0 = 5.5380e-04
Validation prc-auc = 0.723575
Validation auc = 0.773827
Validation accuracy = 0.690083
Validation f1 = 0.619289
Epoch 9
Loss = 5.3000e-01, PNorm = 36.2852, GNorm = 0.5368, lr_0 = 5.4227e-04
Loss = 5.1785e-01, PNorm = 36.3287, GNorm = 0.8387, lr_0 = 5.3200e-04
Loss = 5.2748e-01, PNorm = 36.3756, GNorm = 0.7200, lr_0 = 5.2192e-04
Loss = 5.0377e-01, PNorm = 36.4154, GNorm = 1.1589, lr_0 = 5.1204e-04
Validation prc-auc = 0.723260
Validation auc = 0.783420
Validation accuracy = 0.710744
Validation f1 = 0.650000
Epoch 10
Loss = 5.0786e-01, PNorm = 36.4563, GNorm = 1.6566, lr_0 = 5.0234e-04
Loss = 5.1656e-01, PNorm = 36.4993, GNorm = 1.3154, lr_0 = 4.9282e-04
Loss = 5.2688e-01, PNorm = 36.5469, GNorm = 0.5332, lr_0 = 4.8349e-04
Loss = 5.3000e-01, PNorm = 36.5835, GNorm = 0.3832, lr_0 = 4.7433e-04
Validation prc-auc = 0.729830
Validation auc = 0.780188
Validation accuracy = 0.731405
Validation f1 = 0.713656
Epoch 11
Loss = 4.6730e-01, PNorm = 36.6251, GNorm = 0.4072, lr_0 = 4.6445e-04
Loss = 4.7866e-01, PNorm = 36.6758, GNorm = 0.6794, lr_0 = 4.5566e-04
Loss = 5.0998e-01, PNorm = 36.7160, GNorm = 1.7473, lr_0 = 4.4703e-04
Loss = 5.2439e-01, PNorm = 36.7428, GNorm = 0.6921, lr_0 = 4.3856e-04
Loss = 5.1612e-01, PNorm = 36.7833, GNorm = 0.4467, lr_0 = 4.3025e-04
Validation prc-auc = 0.714372
Validation auc = 0.783281
Validation accuracy = 0.723140
Validation f1 = 0.704846
Epoch 12
Loss = 5.1696e-01, PNorm = 36.8206, GNorm = 0.5212, lr_0 = 4.2210e-04
Loss = 5.2994e-01, PNorm = 36.8533, GNorm = 1.6892, lr_0 = 4.1410e-04
Loss = 4.5398e-01, PNorm = 36.8936, GNorm = 0.9433, lr_0 = 4.0626e-04
Loss = 5.2956e-01, PNorm = 36.9279, GNorm = 0.6221, lr_0 = 3.9856e-04
Validation prc-auc = 0.723041
Validation auc = 0.786757
Validation accuracy = 0.727273
Validation f1 = 0.688679
Epoch 13
Loss = 4.9118e-01, PNorm = 36.9550, GNorm = 0.6584, lr_0 = 3.9101e-04
Loss = 4.8186e-01, PNorm = 36.9912, GNorm = 0.4722, lr_0 = 3.8361e-04
Loss = 5.0127e-01, PNorm = 37.0257, GNorm = 0.6772, lr_0 = 3.7634e-04
Loss = 4.8819e-01, PNorm = 37.0490, GNorm = 1.3990, lr_0 = 3.6921e-04
Validation prc-auc = 0.734537
Validation auc = 0.795203
Validation accuracy = 0.719008
Validation f1 = 0.656566
Epoch 14
Loss = 6.6239e-01, PNorm = 37.0786, GNorm = 2.4179, lr_0 = 3.6153e-04
Loss = 4.9584e-01, PNorm = 37.1163, GNorm = 0.6574, lr_0 = 3.5468e-04
Loss = 4.6682e-01, PNorm = 37.1470, GNorm = 0.6023, lr_0 = 3.4796e-04
Loss = 4.9562e-01, PNorm = 37.1761, GNorm = 0.6244, lr_0 = 3.4137e-04
Loss = 4.9886e-01, PNorm = 37.1978, GNorm = 0.4978, lr_0 = 3.3490e-04
Validation prc-auc = 0.722940
Validation auc = 0.789955
Validation accuracy = 0.706612
Validation f1 = 0.635897
Epoch 15
Loss = 4.9950e-01, PNorm = 37.2236, GNorm = 0.9729, lr_0 = 3.2856e-04
Loss = 4.7572e-01, PNorm = 37.2556, GNorm = 2.3518, lr_0 = 3.2233e-04
Loss = 5.1370e-01, PNorm = 37.2779, GNorm = 0.3854, lr_0 = 3.1623e-04
Loss = 4.9010e-01, PNorm = 37.3018, GNorm = 0.7684, lr_0 = 3.1024e-04
Validation prc-auc = 0.741408
Validation auc = 0.802676
Validation accuracy = 0.747934
Validation f1 = 0.699507
Epoch 16
Loss = 5.1210e-01, PNorm = 37.3285, GNorm = 0.7138, lr_0 = 3.0378e-04
Loss = 4.8462e-01, PNorm = 37.3548, GNorm = 0.5558, lr_0 = 2.9802e-04
Loss = 4.6834e-01, PNorm = 37.3834, GNorm = 0.7315, lr_0 = 2.9238e-04
Loss = 4.4986e-01, PNorm = 37.4096, GNorm = 0.9661, lr_0 = 2.8684e-04
Loss = 5.0892e-01, PNorm = 37.4226, GNorm = 0.7847, lr_0 = 2.8141e-04
Validation prc-auc = 0.742963
Validation auc = 0.799479
Validation accuracy = 0.735537
Validation f1 = 0.683168
Epoch 17
Loss = 4.7279e-01, PNorm = 37.4471, GNorm = 1.5130, lr_0 = 2.7608e-04
Loss = 4.6329e-01, PNorm = 37.4802, GNorm = 1.3379, lr_0 = 2.7085e-04
Loss = 4.7076e-01, PNorm = 37.5042, GNorm = 0.8825, lr_0 = 2.6572e-04
Loss = 5.0801e-01, PNorm = 37.5181, GNorm = 1.4157, lr_0 = 2.6068e-04
Validation prc-auc = 0.749969
Validation auc = 0.809906
Validation accuracy = 0.747934
Validation f1 = 0.721461
Epoch 18
Loss = 4.3408e-01, PNorm = 37.5363, GNorm = 1.6905, lr_0 = 2.5526e-04
Loss = 4.8849e-01, PNorm = 37.5572, GNorm = 1.6332, lr_0 = 2.5042e-04
Loss = 4.9753e-01, PNorm = 37.5809, GNorm = 0.7901, lr_0 = 2.4568e-04
Loss = 4.7863e-01, PNorm = 37.6008, GNorm = 0.7420, lr_0 = 2.4102e-04
Validation prc-auc = 0.749419
Validation auc = 0.806361
Validation accuracy = 0.743802
Validation f1 = 0.701923
Epoch 19
Loss = 4.5186e-01, PNorm = 37.6233, GNorm = 0.5391, lr_0 = 2.3646e-04
Loss = 4.5849e-01, PNorm = 37.6440, GNorm = 1.0741, lr_0 = 2.3198e-04
Loss = 4.5634e-01, PNorm = 37.6633, GNorm = 0.8980, lr_0 = 2.2758e-04
Loss = 4.7000e-01, PNorm = 37.6830, GNorm = 0.5167, lr_0 = 2.2327e-04
Loss = 4.6021e-01, PNorm = 37.7011, GNorm = 1.1943, lr_0 = 2.1904e-04
Loss = 4.3393e-01, PNorm = 37.7027, GNorm = 1.2736, lr_0 = 2.1863e-04
Validation prc-auc = 0.740220
Validation auc = 0.807647
Validation accuracy = 0.723140
Validation f1 = 0.712446
Epoch 20
Loss = 4.9994e-01, PNorm = 37.7180, GNorm = 0.8490, lr_0 = 2.1448e-04
Loss = 4.3374e-01, PNorm = 37.7350, GNorm = 0.5876, lr_0 = 2.1042e-04
Loss = 4.3554e-01, PNorm = 37.7548, GNorm = 0.8051, lr_0 = 2.0644e-04
Loss = 4.5438e-01, PNorm = 37.7759, GNorm = 0.9527, lr_0 = 2.0252e-04
Validation prc-auc = 0.755577
Validation auc = 0.811679
Validation accuracy = 0.752066
Validation f1 = 0.729730
Epoch 21
Loss = 4.2886e-01, PNorm = 37.7910, GNorm = 0.8641, lr_0 = 1.9869e-04
Loss = 4.6295e-01, PNorm = 37.8069, GNorm = 1.4461, lr_0 = 1.9492e-04
Loss = 4.8361e-01, PNorm = 37.8229, GNorm = 0.5432, lr_0 = 1.9123e-04
Loss = 4.6499e-01, PNorm = 37.8359, GNorm = 1.5285, lr_0 = 1.8761e-04
Validation prc-auc = 0.766720
Validation auc = 0.814216
Validation accuracy = 0.747934
Validation f1 = 0.708134
Epoch 22
Loss = 4.1059e-01, PNorm = 37.8524, GNorm = 0.6451, lr_0 = 1.8370e-04
Loss = 4.2195e-01, PNorm = 37.8669, GNorm = 0.5361, lr_0 = 1.8022e-04
Loss = 4.2698e-01, PNorm = 37.8825, GNorm = 0.7803, lr_0 = 1.7681e-04
Loss = 4.9641e-01, PNorm = 37.8958, GNorm = 0.7025, lr_0 = 1.7346e-04
Loss = 4.7268e-01, PNorm = 37.9081, GNorm = 1.0061, lr_0 = 1.7018e-04
Validation prc-auc = 0.750621
Validation auc = 0.807195
Validation accuracy = 0.719008
Validation f1 = 0.714286
Epoch 23
Loss = 4.4031e-01, PNorm = 37.9215, GNorm = 0.5306, lr_0 = 1.6695e-04
Loss = 4.7797e-01, PNorm = 37.9362, GNorm = 0.5983, lr_0 = 1.6379e-04
Loss = 4.5572e-01, PNorm = 37.9504, GNorm = 1.2491, lr_0 = 1.6069e-04
Loss = 4.6270e-01, PNorm = 37.9639, GNorm = 0.9489, lr_0 = 1.5764e-04
Validation prc-auc = 0.773077
Validation auc = 0.813312
Validation accuracy = 0.760331
Validation f1 = 0.738739
Epoch 24
Loss = 4.3299e-01, PNorm = 37.9779, GNorm = 0.7233, lr_0 = 1.5436e-04
Loss = 4.5793e-01, PNorm = 37.9908, GNorm = 1.0098, lr_0 = 1.5144e-04
Loss = 4.2382e-01, PNorm = 38.0018, GNorm = 2.5330, lr_0 = 1.4857e-04
Loss = 4.5039e-01, PNorm = 38.0120, GNorm = 1.6028, lr_0 = 1.4575e-04
Validation prc-auc = 0.759235
Validation auc = 0.820195
Validation accuracy = 0.735537
Validation f1 = 0.724138
Epoch 25
Loss = 4.5254e-01, PNorm = 38.0243, GNorm = 0.7781, lr_0 = 1.4299e-04
Loss = 4.3229e-01, PNorm = 38.0368, GNorm = 0.9848, lr_0 = 1.4028e-04
Loss = 4.1387e-01, PNorm = 38.0506, GNorm = 0.6713, lr_0 = 1.3763e-04
Loss = 4.0936e-01, PNorm = 38.0651, GNorm = 1.6781, lr_0 = 1.3502e-04
Loss = 5.2003e-01, PNorm = 38.0714, GNorm = 1.0122, lr_0 = 1.3246e-04
Validation prc-auc = 0.757324
Validation auc = 0.816371
Validation accuracy = 0.727273
Validation f1 = 0.713043
Epoch 26
Loss = 4.3021e-01, PNorm = 38.0831, GNorm = 1.0472, lr_0 = 1.2995e-04
Loss = 4.3783e-01, PNorm = 38.0943, GNorm = 0.7867, lr_0 = 1.2749e-04
Loss = 4.5870e-01, PNorm = 38.1039, GNorm = 0.7337, lr_0 = 1.2508e-04
Loss = 4.3307e-01, PNorm = 38.1140, GNorm = 1.1821, lr_0 = 1.2271e-04
Validation prc-auc = 0.774282
Validation auc = 0.822106
Validation accuracy = 0.776860
Validation f1 = 0.754545
Epoch 27
Loss = 3.7894e-01, PNorm = 38.1254, GNorm = 0.6089, lr_0 = 1.2015e-04
Loss = 4.1807e-01, PNorm = 38.1372, GNorm = 1.1970, lr_0 = 1.1788e-04
Loss = 4.6443e-01, PNorm = 38.1472, GNorm = 1.1005, lr_0 = 1.1564e-04
Loss = 4.2285e-01, PNorm = 38.1545, GNorm = 0.8385, lr_0 = 1.1345e-04
Validation prc-auc = 0.786870
Validation auc = 0.822906
Validation accuracy = 0.756198
Validation f1 = 0.717703
Epoch 28
Loss = 4.7009e-01, PNorm = 38.1632, GNorm = 1.2412, lr_0 = 1.1130e-04
Loss = 4.2049e-01, PNorm = 38.1701, GNorm = 1.5377, lr_0 = 1.0920e-04
Loss = 4.3373e-01, PNorm = 38.1791, GNorm = 0.7799, lr_0 = 1.0713e-04
Loss = 4.2728e-01, PNorm = 38.1885, GNorm = 0.6749, lr_0 = 1.0510e-04
Loss = 4.5089e-01, PNorm = 38.1972, GNorm = 0.8210, lr_0 = 1.0311e-04
Validation prc-auc = 0.774903
Validation auc = 0.823879
Validation accuracy = 0.760331
Validation f1 = 0.741071
Epoch 29
Loss = 4.0612e-01, PNorm = 38.2078, GNorm = 0.6548, lr_0 = 1.0096e-04
Loss = 4.5563e-01, PNorm = 38.2178, GNorm = 0.7687, lr_0 = 1.0000e-04
Loss = 4.1766e-01, PNorm = 38.2244, GNorm = 1.0039, lr_0 = 1.0000e-04
Loss = 4.1952e-01, PNorm = 38.2322, GNorm = 0.8837, lr_0 = 1.0000e-04
Validation prc-auc = 0.788645
Validation auc = 0.831526
Validation accuracy = 0.764463
Validation f1 = 0.737327
Model 0 best validation prc-auc = 0.788645 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.704526
Model 0 test auc = 0.822381
Model 0 test accuracy = 0.757208
Model 0 test f1 = 0.712230
Ensemble test prc-auc = 0.704526
Ensemble test auc = 0.822381
Ensemble test accuracy = 0.757208
Ensemble test f1 = 0.712230
Fold 3
Splitting data with seed 3
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 6.9504e-01, PNorm = 34.0113, GNorm = 1.1024, lr_0 = 2.1512e-04
Loss = 6.7318e-01, PNorm = 34.0170, GNorm = 0.8509, lr_0 = 3.1977e-04
Loss = 6.8146e-01, PNorm = 34.0272, GNorm = 1.1499, lr_0 = 4.2442e-04
Loss = 6.8911e-01, PNorm = 34.0391, GNorm = 0.3537, lr_0 = 5.2907e-04
Validation prc-auc = 0.602944
Validation auc = 0.588577
Validation accuracy = 0.475207
Validation f1 = 0.211180
Epoch 1
Loss = 6.6337e-01, PNorm = 34.0658, GNorm = 0.9560, lr_0 = 6.4419e-04
Loss = 6.5952e-01, PNorm = 34.1062, GNorm = 0.1804, lr_0 = 7.4884e-04
Loss = 6.6553e-01, PNorm = 34.1590, GNorm = 1.4847, lr_0 = 8.5349e-04
Loss = 6.6190e-01, PNorm = 34.2315, GNorm = 0.2374, lr_0 = 9.5814e-04
Validation prc-auc = 0.644298
Validation auc = 0.662403
Validation accuracy = 0.500000
Validation f1 = 0.359788
Epoch 2
Loss = 6.1580e-01, PNorm = 34.3228, GNorm = 0.6572, lr_0 = 9.8859e-04
Loss = 6.3254e-01, PNorm = 34.4105, GNorm = 1.2968, lr_0 = 9.6986e-04
Loss = 6.3937e-01, PNorm = 34.4846, GNorm = 0.6519, lr_0 = 9.5149e-04
Loss = 6.1846e-01, PNorm = 34.5787, GNorm = 0.3857, lr_0 = 9.3347e-04
Loss = 6.0411e-01, PNorm = 34.6554, GNorm = 0.8655, lr_0 = 9.1579e-04
Loss = 5.1185e-01, PNorm = 34.6635, GNorm = 0.7885, lr_0 = 9.1404e-04
Validation prc-auc = 0.670543
Validation auc = 0.696754
Validation accuracy = 0.702479
Validation f1 = 0.755102
Epoch 3
Loss = 5.6819e-01, PNorm = 34.7532, GNorm = 2.0902, lr_0 = 8.9672e-04
Loss = 6.1842e-01, PNorm = 34.8031, GNorm = 0.5834, lr_0 = 8.7974e-04
Loss = 5.9863e-01, PNorm = 34.8743, GNorm = 0.3111, lr_0 = 8.6307e-04
Loss = 6.2065e-01, PNorm = 34.9455, GNorm = 0.5097, lr_0 = 8.4672e-04
Validation prc-auc = 0.692484
Validation auc = 0.711333
Validation accuracy = 0.652893
Validation f1 = 0.669291
Epoch 4
Loss = 5.8907e-01, PNorm = 34.9944, GNorm = 0.3884, lr_0 = 8.3068e-04
Loss = 5.5252e-01, PNorm = 35.0691, GNorm = 1.2557, lr_0 = 8.1495e-04
Loss = 5.7678e-01, PNorm = 35.1330, GNorm = 1.0516, lr_0 = 7.9951e-04
Loss = 6.0527e-01, PNorm = 35.1989, GNorm = 0.3959, lr_0 = 7.8437e-04
Validation prc-auc = 0.700498
Validation auc = 0.722921
Validation accuracy = 0.595041
Validation f1 = 0.554545
Epoch 5
Loss = 5.8461e-01, PNorm = 35.2548, GNorm = 0.6980, lr_0 = 7.6804e-04
Loss = 5.8208e-01, PNorm = 35.3236, GNorm = 0.3544, lr_0 = 7.5349e-04
Loss = 5.6739e-01, PNorm = 35.3879, GNorm = 0.6632, lr_0 = 7.3921e-04
Loss = 5.6058e-01, PNorm = 35.4434, GNorm = 0.3754, lr_0 = 7.2521e-04
Loss = 5.5369e-01, PNorm = 35.4951, GNorm = 0.3652, lr_0 = 7.1147e-04
Validation prc-auc = 0.719175
Validation auc = 0.733512
Validation accuracy = 0.698347
Validation f1 = 0.706827
Epoch 6
Loss = 5.6724e-01, PNorm = 35.5673, GNorm = 0.3482, lr_0 = 6.9800e-04
Loss = 5.3822e-01, PNorm = 35.6230, GNorm = 0.6913, lr_0 = 6.8478e-04
Loss = 5.4687e-01, PNorm = 35.6773, GNorm = 0.5169, lr_0 = 6.7180e-04
Loss = 5.6494e-01, PNorm = 35.7337, GNorm = 0.3714, lr_0 = 6.5908e-04
Validation prc-auc = 0.714052
Validation auc = 0.735438
Validation accuracy = 0.706612
Validation f1 = 0.743682
Epoch 7
Loss = 5.7543e-01, PNorm = 35.7935, GNorm = 0.5390, lr_0 = 6.4536e-04
Loss = 5.3546e-01, PNorm = 35.8499, GNorm = 0.3062, lr_0 = 6.3313e-04
Loss = 5.3834e-01, PNorm = 35.9074, GNorm = 0.3664, lr_0 = 6.2114e-04
Loss = 5.5802e-01, PNorm = 35.9667, GNorm = 1.1568, lr_0 = 6.0937e-04
Validation prc-auc = 0.735049
Validation auc = 0.745891
Validation accuracy = 0.640496
Validation f1 = 0.626609
Epoch 8
Loss = 6.0953e-01, PNorm = 36.0318, GNorm = 1.1909, lr_0 = 5.9783e-04
Loss = 5.2302e-01, PNorm = 36.0962, GNorm = 1.0643, lr_0 = 5.8651e-04
Loss = 5.2277e-01, PNorm = 36.1579, GNorm = 0.3639, lr_0 = 5.7540e-04
Loss = 5.2328e-01, PNorm = 36.2092, GNorm = 0.7201, lr_0 = 5.6450e-04
Loss = 5.2306e-01, PNorm = 36.2535, GNorm = 1.3992, lr_0 = 5.5380e-04
Validation prc-auc = 0.727228
Validation auc = 0.748917
Validation accuracy = 0.706612
Validation f1 = 0.749117
Epoch 9
Loss = 5.5890e-01, PNorm = 36.2903, GNorm = 0.8456, lr_0 = 5.4227e-04
Loss = 5.1545e-01, PNorm = 36.3419, GNorm = 0.4553, lr_0 = 5.3200e-04
Loss = 4.8845e-01, PNorm = 36.4104, GNorm = 1.5565, lr_0 = 5.2192e-04
Loss = 5.5224e-01, PNorm = 36.4392, GNorm = 0.8462, lr_0 = 5.1204e-04
Validation prc-auc = 0.732997
Validation auc = 0.749192
Validation accuracy = 0.694215
Validation f1 = 0.739437
Epoch 10
Loss = 5.6581e-01, PNorm = 36.4801, GNorm = 0.4542, lr_0 = 5.0234e-04
Loss = 5.0338e-01, PNorm = 36.5374, GNorm = 0.6174, lr_0 = 4.9282e-04
Loss = 4.8128e-01, PNorm = 36.5997, GNorm = 0.9392, lr_0 = 4.8349e-04
Loss = 5.5137e-01, PNorm = 36.6264, GNorm = 0.4938, lr_0 = 4.7433e-04
Validation prc-auc = 0.733689
Validation auc = 0.754590
Validation accuracy = 0.665289
Validation f1 = 0.669388
Epoch 11
Loss = 5.0482e-01, PNorm = 36.6582, GNorm = 0.7751, lr_0 = 4.6445e-04
Loss = 5.1092e-01, PNorm = 36.7129, GNorm = 0.4889, lr_0 = 4.5566e-04
Loss = 5.1574e-01, PNorm = 36.7607, GNorm = 0.8134, lr_0 = 4.4703e-04
Loss = 5.0702e-01, PNorm = 36.7880, GNorm = 0.3908, lr_0 = 4.3856e-04
Loss = 5.0540e-01, PNorm = 36.8226, GNorm = 0.8906, lr_0 = 4.3025e-04
Validation prc-auc = 0.738864
Validation auc = 0.751461
Validation accuracy = 0.719008
Validation f1 = 0.744361
Epoch 12
Loss = 5.1101e-01, PNorm = 36.8586, GNorm = 0.5569, lr_0 = 4.2210e-04
Loss = 4.5859e-01, PNorm = 36.9082, GNorm = 0.9618, lr_0 = 4.1410e-04
Loss = 5.0351e-01, PNorm = 36.9546, GNorm = 0.6695, lr_0 = 4.0626e-04
Loss = 5.0903e-01, PNorm = 36.9829, GNorm = 0.5534, lr_0 = 3.9856e-04
Validation prc-auc = 0.748846
Validation auc = 0.761915
Validation accuracy = 0.714876
Validation f1 = 0.743494
Epoch 13
Loss = 4.8769e-01, PNorm = 37.0147, GNorm = 1.0172, lr_0 = 3.9101e-04
Loss = 4.7537e-01, PNorm = 37.0548, GNorm = 1.5454, lr_0 = 3.8361e-04
Loss = 4.8817e-01, PNorm = 37.0916, GNorm = 0.5166, lr_0 = 3.7634e-04
Loss = 4.8456e-01, PNorm = 37.1300, GNorm = 0.4823, lr_0 = 3.6921e-04
Validation prc-auc = 0.760590
Validation auc = 0.770477
Validation accuracy = 0.690083
Validation f1 = 0.703557
Epoch 14
Loss = 5.0926e-01, PNorm = 37.1563, GNorm = 0.5586, lr_0 = 3.6153e-04
Loss = 4.6787e-01, PNorm = 37.1948, GNorm = 0.4941, lr_0 = 3.5468e-04
Loss = 5.2200e-01, PNorm = 37.2272, GNorm = 0.4209, lr_0 = 3.4796e-04
Loss = 4.5428e-01, PNorm = 37.2552, GNorm = 0.9950, lr_0 = 3.4137e-04
Loss = 5.0422e-01, PNorm = 37.2780, GNorm = 0.7169, lr_0 = 3.3490e-04
Validation prc-auc = 0.752311
Validation auc = 0.768620
Validation accuracy = 0.714876
Validation f1 = 0.739623
Epoch 15
Loss = 4.3802e-01, PNorm = 37.3095, GNorm = 1.2525, lr_0 = 3.2856e-04
Loss = 4.8951e-01, PNorm = 37.3475, GNorm = 0.7459, lr_0 = 3.2233e-04
Loss = 4.9615e-01, PNorm = 37.3780, GNorm = 0.6598, lr_0 = 3.1623e-04
Loss = 5.2867e-01, PNorm = 37.4053, GNorm = 0.7189, lr_0 = 3.1024e-04
Validation prc-auc = 0.765317
Validation auc = 0.774809
Validation accuracy = 0.731405
Validation f1 = 0.763636
Epoch 16
Loss = 4.2921e-01, PNorm = 37.4338, GNorm = 0.9145, lr_0 = 3.0378e-04
Loss = 4.5355e-01, PNorm = 37.4697, GNorm = 0.7183, lr_0 = 2.9802e-04
Loss = 4.7801e-01, PNorm = 37.5008, GNorm = 1.1642, lr_0 = 2.9238e-04
Loss = 4.9674e-01, PNorm = 37.5217, GNorm = 0.6263, lr_0 = 2.8684e-04
Loss = 5.0054e-01, PNorm = 37.5415, GNorm = 0.7810, lr_0 = 2.8141e-04
Validation prc-auc = 0.781880
Validation auc = 0.781583
Validation accuracy = 0.702479
Validation f1 = 0.704918
Epoch 17
Loss = 4.6889e-01, PNorm = 37.5613, GNorm = 0.9500, lr_0 = 2.7608e-04
Loss = 4.6723e-01, PNorm = 37.5906, GNorm = 0.5270, lr_0 = 2.7085e-04
Loss = 4.8525e-01, PNorm = 37.6175, GNorm = 0.7349, lr_0 = 2.6572e-04
Loss = 4.6978e-01, PNorm = 37.6409, GNorm = 0.9665, lr_0 = 2.6068e-04
Validation prc-auc = 0.778944
Validation auc = 0.779554
Validation accuracy = 0.719008
Validation f1 = 0.750000
Epoch 18
Loss = 4.5152e-01, PNorm = 37.6645, GNorm = 0.9600, lr_0 = 2.5526e-04
Loss = 4.6955e-01, PNorm = 37.6885, GNorm = 1.5637, lr_0 = 2.5042e-04
Loss = 4.5449e-01, PNorm = 37.7123, GNorm = 2.1501, lr_0 = 2.4568e-04
Loss = 4.8486e-01, PNorm = 37.7378, GNorm = 0.8459, lr_0 = 2.4102e-04
Validation prc-auc = 0.779156
Validation auc = 0.782340
Validation accuracy = 0.719008
Validation f1 = 0.746269
Epoch 19
Loss = 4.0343e-01, PNorm = 37.7596, GNorm = 0.6299, lr_0 = 2.3646e-04
Loss = 4.5229e-01, PNorm = 37.7834, GNorm = 1.2967, lr_0 = 2.3198e-04
Loss = 5.2186e-01, PNorm = 37.8029, GNorm = 0.5945, lr_0 = 2.2758e-04
Loss = 4.3182e-01, PNorm = 37.8185, GNorm = 0.5750, lr_0 = 2.2327e-04
Loss = 4.5951e-01, PNorm = 37.8382, GNorm = 1.0409, lr_0 = 2.1904e-04
Loss = 5.2013e-01, PNorm = 37.8401, GNorm = 1.3865, lr_0 = 2.1863e-04
Validation prc-auc = 0.778934
Validation auc = 0.781789
Validation accuracy = 0.702479
Validation f1 = 0.725191
Epoch 20
Loss = 4.6083e-01, PNorm = 37.8658, GNorm = 0.9566, lr_0 = 2.1448e-04
Loss = 4.3951e-01, PNorm = 37.8866, GNorm = 0.5584, lr_0 = 2.1042e-04
Loss = 4.5771e-01, PNorm = 37.9038, GNorm = 0.6250, lr_0 = 2.0644e-04
Loss = 4.5332e-01, PNorm = 37.9191, GNorm = 0.9188, lr_0 = 2.0252e-04
Validation prc-auc = 0.784107
Validation auc = 0.788770
Validation accuracy = 0.723140
Validation f1 = 0.754579
Epoch 21
Loss = 4.5553e-01, PNorm = 37.9390, GNorm = 1.2258, lr_0 = 1.9869e-04
Loss = 4.2094e-01, PNorm = 37.9595, GNorm = 0.6426, lr_0 = 1.9492e-04
Loss = 4.5182e-01, PNorm = 37.9812, GNorm = 0.8150, lr_0 = 1.9123e-04
Loss = 4.8357e-01, PNorm = 37.9977, GNorm = 1.2782, lr_0 = 1.8761e-04
Validation prc-auc = 0.787915
Validation auc = 0.784987
Validation accuracy = 0.698347
Validation f1 = 0.711462
Epoch 22
Loss = 4.1093e-01, PNorm = 38.0156, GNorm = 0.8626, lr_0 = 1.8370e-04
Loss = 4.4885e-01, PNorm = 38.0342, GNorm = 0.7606, lr_0 = 1.8022e-04
Loss = 4.5258e-01, PNorm = 38.0528, GNorm = 0.6967, lr_0 = 1.7681e-04
Loss = 4.6963e-01, PNorm = 38.0659, GNorm = 0.9504, lr_0 = 1.7346e-04
Loss = 4.5384e-01, PNorm = 38.0762, GNorm = 0.9724, lr_0 = 1.7018e-04
Validation prc-auc = 0.785031
Validation auc = 0.788151
Validation accuracy = 0.685950
Validation f1 = 0.677966
Epoch 23
Loss = 4.5359e-01, PNorm = 38.0889, GNorm = 0.7545, lr_0 = 1.6695e-04
Loss = 4.2875e-01, PNorm = 38.1061, GNorm = 0.8444, lr_0 = 1.6379e-04
Loss = 4.5642e-01, PNorm = 38.1255, GNorm = 1.1835, lr_0 = 1.6069e-04
Loss = 4.6315e-01, PNorm = 38.1375, GNorm = 0.9504, lr_0 = 1.5764e-04
Validation prc-auc = 0.800210
Validation auc = 0.796231
Validation accuracy = 0.694215
Validation f1 = 0.696721
Epoch 24
Loss = 4.3045e-01, PNorm = 38.1487, GNorm = 1.3317, lr_0 = 1.5436e-04
Loss = 4.3950e-01, PNorm = 38.1629, GNorm = 1.2377, lr_0 = 1.5144e-04
Loss = 4.2336e-01, PNorm = 38.1766, GNorm = 0.9654, lr_0 = 1.4857e-04
Loss = 4.8501e-01, PNorm = 38.1881, GNorm = 1.2464, lr_0 = 1.4575e-04
Validation prc-auc = 0.795366
Validation auc = 0.794925
Validation accuracy = 0.702479
Validation f1 = 0.720930
Epoch 25
Loss = 4.6143e-01, PNorm = 38.2016, GNorm = 1.1269, lr_0 = 1.4299e-04
Loss = 4.2865e-01, PNorm = 38.2136, GNorm = 0.9404, lr_0 = 1.4028e-04
Loss = 4.4201e-01, PNorm = 38.2265, GNorm = 0.7692, lr_0 = 1.3763e-04
Loss = 4.2968e-01, PNorm = 38.2388, GNorm = 1.3931, lr_0 = 1.3502e-04
Loss = 4.3414e-01, PNorm = 38.2512, GNorm = 0.8351, lr_0 = 1.3246e-04
Validation prc-auc = 0.787401
Validation auc = 0.788942
Validation accuracy = 0.706612
Validation f1 = 0.727969
Epoch 26
Loss = 4.4348e-01, PNorm = 38.2633, GNorm = 1.0384, lr_0 = 1.2995e-04
Loss = 4.4854e-01, PNorm = 38.2770, GNorm = 0.6180, lr_0 = 1.2749e-04
Loss = 4.1465e-01, PNorm = 38.2891, GNorm = 0.9219, lr_0 = 1.2508e-04
Loss = 4.2618e-01, PNorm = 38.3013, GNorm = 1.0706, lr_0 = 1.2271e-04
Validation prc-auc = 0.797890
Validation auc = 0.795406
Validation accuracy = 0.714876
Validation f1 = 0.739623
Epoch 27
Loss = 4.0697e-01, PNorm = 38.3123, GNorm = 1.1720, lr_0 = 1.2015e-04
Loss = 4.4883e-01, PNorm = 38.3233, GNorm = 1.6577, lr_0 = 1.1788e-04
Loss = 4.4225e-01, PNorm = 38.3326, GNorm = 0.8232, lr_0 = 1.1564e-04
Loss = 4.1765e-01, PNorm = 38.3434, GNorm = 0.8596, lr_0 = 1.1345e-04
Validation prc-auc = 0.802907
Validation auc = 0.799292
Validation accuracy = 0.714876
Validation f1 = 0.729412
Epoch 28
Loss = 3.0056e-01, PNorm = 38.3540, GNorm = 0.8051, lr_0 = 1.1130e-04
Loss = 4.1764e-01, PNorm = 38.3645, GNorm = 1.2667, lr_0 = 1.0920e-04
Loss = 4.3502e-01, PNorm = 38.3746, GNorm = 1.1526, lr_0 = 1.0713e-04
Loss = 4.3389e-01, PNorm = 38.3825, GNorm = 1.2178, lr_0 = 1.0510e-04
Loss = 4.4654e-01, PNorm = 38.3907, GNorm = 0.8687, lr_0 = 1.0311e-04
Validation prc-auc = 0.799444
Validation auc = 0.798466
Validation accuracy = 0.710744
Validation f1 = 0.728682
Epoch 29
Loss = 4.0902e-01, PNorm = 38.4012, GNorm = 1.1210, lr_0 = 1.0096e-04
Loss = 4.4377e-01, PNorm = 38.4097, GNorm = 1.3148, lr_0 = 1.0000e-04
Loss = 4.0491e-01, PNorm = 38.4193, GNorm = 1.0205, lr_0 = 1.0000e-04
Loss = 4.1562e-01, PNorm = 38.4294, GNorm = 1.0561, lr_0 = 1.0000e-04
Validation prc-auc = 0.796873
Validation auc = 0.796438
Validation accuracy = 0.727273
Validation f1 = 0.759124
Model 0 best validation prc-auc = 0.802907 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.692152
Model 0 test auc = 0.814679
Model 0 test accuracy = 0.763278
Model 0 test f1 = 0.712177
Ensemble test prc-auc = 0.692152
Ensemble test auc = 0.814679
Ensemble test accuracy = 0.763278
Ensemble test f1 = 0.712177
Fold 4
Splitting data with seed 4
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 6.8882e-01, PNorm = 34.0119, GNorm = 0.4646, lr_0 = 2.1512e-04
Loss = 6.8345e-01, PNorm = 34.0178, GNorm = 1.9589, lr_0 = 3.1977e-04
Loss = 6.8308e-01, PNorm = 34.0267, GNorm = 0.9709, lr_0 = 4.2442e-04
Loss = 6.5140e-01, PNorm = 34.0479, GNorm = 0.5330, lr_0 = 5.2907e-04
Validation prc-auc = 0.602712
Validation auc = 0.637556
Validation accuracy = 0.574380
Validation f1 = 0.404624
Epoch 1
Loss = 6.4129e-01, PNorm = 34.0821, GNorm = 0.4008, lr_0 = 6.4419e-04
Loss = 7.0428e-01, PNorm = 34.1135, GNorm = 0.2660, lr_0 = 7.4884e-04
Loss = 6.8261e-01, PNorm = 34.1573, GNorm = 0.1333, lr_0 = 8.5349e-04
Loss = 6.5900e-01, PNorm = 34.2233, GNorm = 0.8036, lr_0 = 9.5814e-04
Validation prc-auc = 0.605182
Validation auc = 0.651318
Validation accuracy = 0.607438
Validation f1 = 0.644195
Epoch 2
Loss = 6.4925e-01, PNorm = 34.3123, GNorm = 0.7038, lr_0 = 9.8859e-04
Loss = 6.1019e-01, PNorm = 34.4178, GNorm = 1.3374, lr_0 = 9.6986e-04
Loss = 6.4162e-01, PNorm = 34.4844, GNorm = 0.7308, lr_0 = 9.5149e-04
Loss = 6.2193e-01, PNorm = 34.5622, GNorm = 0.6807, lr_0 = 9.3347e-04
Loss = 6.5242e-01, PNorm = 34.6372, GNorm = 0.4987, lr_0 = 9.1579e-04
Loss = 6.6525e-01, PNorm = 34.6447, GNorm = 0.9952, lr_0 = 9.1404e-04
Validation prc-auc = 0.644731
Validation auc = 0.697090
Validation accuracy = 0.590909
Validation f1 = 0.681672
Epoch 3
Loss = 5.9850e-01, PNorm = 34.7387, GNorm = 0.5631, lr_0 = 8.9672e-04
Loss = 6.1865e-01, PNorm = 34.8181, GNorm = 0.9053, lr_0 = 8.7974e-04
Loss = 6.2842e-01, PNorm = 34.8740, GNorm = 0.2668, lr_0 = 8.6307e-04
Loss = 5.8637e-01, PNorm = 34.9348, GNorm = 0.3730, lr_0 = 8.4672e-04
Validation prc-auc = 0.682038
Validation auc = 0.728073
Validation accuracy = 0.657025
Validation f1 = 0.640693
Epoch 4
Loss = 6.0387e-01, PNorm = 34.9920, GNorm = 0.1807, lr_0 = 8.3068e-04
Loss = 5.7788e-01, PNorm = 35.0598, GNorm = 0.3439, lr_0 = 8.1495e-04
Loss = 5.7373e-01, PNorm = 35.1333, GNorm = 0.6728, lr_0 = 7.9951e-04
Loss = 5.8839e-01, PNorm = 35.1846, GNorm = 0.3946, lr_0 = 7.8437e-04
Validation prc-auc = 0.686407
Validation auc = 0.729921
Validation accuracy = 0.652893
Validation f1 = 0.664000
Epoch 5
Loss = 5.2708e-01, PNorm = 35.2547, GNorm = 0.4165, lr_0 = 7.6804e-04
Loss = 5.8754e-01, PNorm = 35.3181, GNorm = 0.8259, lr_0 = 7.5349e-04
Loss = 5.7473e-01, PNorm = 35.3942, GNorm = 0.5245, lr_0 = 7.3921e-04
Loss = 5.5350e-01, PNorm = 35.4651, GNorm = 0.5415, lr_0 = 7.2521e-04
Loss = 5.6404e-01, PNorm = 35.5233, GNorm = 0.4311, lr_0 = 7.1147e-04
Validation prc-auc = 0.718828
Validation auc = 0.740260
Validation accuracy = 0.661157
Validation f1 = 0.643478
Epoch 6
Loss = 5.5842e-01, PNorm = 35.5890, GNorm = 0.5228, lr_0 = 6.9800e-04
Loss = 5.4733e-01, PNorm = 35.6666, GNorm = 0.7852, lr_0 = 6.8478e-04
Loss = 5.6366e-01, PNorm = 35.7227, GNorm = 1.4730, lr_0 = 6.7180e-04
Loss = 5.7004e-01, PNorm = 35.7734, GNorm = 0.6380, lr_0 = 6.5908e-04
Validation prc-auc = 0.735576
Validation auc = 0.758542
Validation accuracy = 0.673554
Validation f1 = 0.672199
Epoch 7
Loss = 5.4363e-01, PNorm = 35.8387, GNorm = 0.7184, lr_0 = 6.4536e-04
Loss = 5.5813e-01, PNorm = 35.8907, GNorm = 0.7748, lr_0 = 6.3313e-04
Loss = 5.1543e-01, PNorm = 35.9574, GNorm = 0.4485, lr_0 = 6.2114e-04
Loss = 5.6472e-01, PNorm = 36.0190, GNorm = 0.3336, lr_0 = 6.0937e-04
Validation prc-auc = 0.706202
Validation auc = 0.747929
Validation accuracy = 0.690083
Validation f1 = 0.691358
Epoch 8
Loss = 5.0844e-01, PNorm = 36.0670, GNorm = 0.4648, lr_0 = 5.9783e-04
Loss = 5.2135e-01, PNorm = 36.1290, GNorm = 0.6785, lr_0 = 5.8651e-04
Loss = 5.4356e-01, PNorm = 36.1886, GNorm = 0.4855, lr_0 = 5.7540e-04
Loss = 5.5398e-01, PNorm = 36.2431, GNorm = 0.6976, lr_0 = 5.6450e-04
Loss = 5.1509e-01, PNorm = 36.2965, GNorm = 1.4689, lr_0 = 5.5380e-04
Validation prc-auc = 0.707562
Validation auc = 0.763643
Validation accuracy = 0.706612
Validation f1 = 0.730038
Epoch 9
Loss = 5.5773e-01, PNorm = 36.3380, GNorm = 1.5054, lr_0 = 5.4227e-04
Loss = 5.2158e-01, PNorm = 36.3810, GNorm = 1.1604, lr_0 = 5.3200e-04
Loss = 5.3831e-01, PNorm = 36.4342, GNorm = 0.6890, lr_0 = 5.2192e-04
Loss = 5.2955e-01, PNorm = 36.4852, GNorm = 1.3791, lr_0 = 5.1204e-04
Validation prc-auc = 0.728197
Validation auc = 0.768264
Validation accuracy = 0.727273
Validation f1 = 0.738095
Epoch 10
Loss = 4.8770e-01, PNorm = 36.5390, GNorm = 3.1617, lr_0 = 5.0234e-04
Loss = 5.1143e-01, PNorm = 36.5945, GNorm = 0.5479, lr_0 = 4.9282e-04
Loss = 5.2365e-01, PNorm = 36.6525, GNorm = 0.5749, lr_0 = 4.8349e-04
Loss = 5.4394e-01, PNorm = 36.7037, GNorm = 0.4030, lr_0 = 4.7433e-04
Validation prc-auc = 0.728588
Validation auc = 0.764738
Validation accuracy = 0.698347
Validation f1 = 0.691983
Epoch 11
Loss = 4.9534e-01, PNorm = 36.7495, GNorm = 0.3804, lr_0 = 4.6445e-04
Loss = 5.3243e-01, PNorm = 36.7844, GNorm = 0.7752, lr_0 = 4.5566e-04
Loss = 4.9429e-01, PNorm = 36.8393, GNorm = 0.6769, lr_0 = 4.4703e-04
Loss = 5.1467e-01, PNorm = 36.8733, GNorm = 0.5589, lr_0 = 4.3856e-04
Loss = 5.0736e-01, PNorm = 36.9090, GNorm = 0.7835, lr_0 = 4.3025e-04
Validation prc-auc = 0.724511
Validation auc = 0.766005
Validation accuracy = 0.702479
Validation f1 = 0.697479
Epoch 12
Loss = 5.0623e-01, PNorm = 36.9442, GNorm = 0.3788, lr_0 = 4.2210e-04
Loss = 5.0544e-01, PNorm = 36.9796, GNorm = 0.6598, lr_0 = 4.1410e-04
Loss = 5.1290e-01, PNorm = 37.0091, GNorm = 0.5631, lr_0 = 4.0626e-04
Loss = 4.8432e-01, PNorm = 37.0434, GNorm = 0.4708, lr_0 = 3.9856e-04
Validation prc-auc = 0.733224
Validation auc = 0.771962
Validation accuracy = 0.706612
Validation f1 = 0.710204
Epoch 13
Loss = 4.9919e-01, PNorm = 37.0853, GNorm = 1.1487, lr_0 = 3.9101e-04
Loss = 4.8484e-01, PNorm = 37.1280, GNorm = 1.0107, lr_0 = 3.8361e-04
Loss = 5.0247e-01, PNorm = 37.1638, GNorm = 0.4158, lr_0 = 3.7634e-04
Loss = 5.1336e-01, PNorm = 37.1922, GNorm = 0.7398, lr_0 = 3.6921e-04
Validation prc-auc = 0.732108
Validation auc = 0.777337
Validation accuracy = 0.719008
Validation f1 = 0.714286
Epoch 14
Loss = 4.4787e-01, PNorm = 37.2182, GNorm = 0.8480, lr_0 = 3.6153e-04
Loss = 4.7409e-01, PNorm = 37.2508, GNorm = 0.7968, lr_0 = 3.5468e-04
Loss = 4.8861e-01, PNorm = 37.2832, GNorm = 0.4437, lr_0 = 3.4796e-04
Loss = 5.0103e-01, PNorm = 37.3171, GNorm = 1.7822, lr_0 = 3.4137e-04
Loss = 4.9710e-01, PNorm = 37.3465, GNorm = 0.6768, lr_0 = 3.3490e-04
Validation prc-auc = 0.736531
Validation auc = 0.778809
Validation accuracy = 0.706612
Validation f1 = 0.689956
Epoch 15
Loss = 4.8595e-01, PNorm = 37.3707, GNorm = 0.6431, lr_0 = 3.2856e-04
Loss = 4.9134e-01, PNorm = 37.3985, GNorm = 1.2301, lr_0 = 3.2233e-04
Loss = 4.8317e-01, PNorm = 37.4285, GNorm = 0.5709, lr_0 = 3.1623e-04
Loss = 4.8398e-01, PNorm = 37.4578, GNorm = 0.6247, lr_0 = 3.1024e-04
Validation prc-auc = 0.737361
Validation auc = 0.780383
Validation accuracy = 0.710744
Validation f1 = 0.695652
Epoch 16
Loss = 4.6964e-01, PNorm = 37.4827, GNorm = 0.6509, lr_0 = 3.0378e-04
Loss = 4.8941e-01, PNorm = 37.5083, GNorm = 0.8911, lr_0 = 2.9802e-04
Loss = 4.4995e-01, PNorm = 37.5410, GNorm = 0.4812, lr_0 = 2.9238e-04
Loss = 4.9393e-01, PNorm = 37.5740, GNorm = 0.6208, lr_0 = 2.8684e-04
Loss = 4.9027e-01, PNorm = 37.5946, GNorm = 0.7515, lr_0 = 2.8141e-04
Validation prc-auc = 0.727961
Validation auc = 0.787573
Validation accuracy = 0.706612
Validation f1 = 0.695279
Epoch 17
Loss = 4.9408e-01, PNorm = 37.6165, GNorm = 0.6785, lr_0 = 2.7608e-04
Loss = 4.8735e-01, PNorm = 37.6404, GNorm = 0.8598, lr_0 = 2.7085e-04
Loss = 4.4109e-01, PNorm = 37.6628, GNorm = 1.4039, lr_0 = 2.6572e-04
Loss = 4.8629e-01, PNorm = 37.6832, GNorm = 0.8074, lr_0 = 2.6068e-04
Validation prc-auc = 0.741495
Validation auc = 0.788326
Validation accuracy = 0.723140
Validation f1 = 0.719665
Epoch 18
Loss = 4.9682e-01, PNorm = 37.7144, GNorm = 0.6843, lr_0 = 2.5526e-04
Loss = 4.7139e-01, PNorm = 37.7415, GNorm = 1.4368, lr_0 = 2.5042e-04
Loss = 4.5599e-01, PNorm = 37.7608, GNorm = 0.6576, lr_0 = 2.4568e-04
Loss = 4.5431e-01, PNorm = 37.7813, GNorm = 0.8831, lr_0 = 2.4102e-04
Validation prc-auc = 0.740384
Validation auc = 0.784320
Validation accuracy = 0.719008
Validation f1 = 0.709402
Epoch 19
Loss = 4.6001e-01, PNorm = 37.8052, GNorm = 0.6835, lr_0 = 2.3646e-04
Loss = 4.3396e-01, PNorm = 37.8319, GNorm = 0.9386, lr_0 = 2.3198e-04
Loss = 4.6819e-01, PNorm = 37.8540, GNorm = 1.0261, lr_0 = 2.2758e-04
Loss = 4.5821e-01, PNorm = 37.8747, GNorm = 1.5332, lr_0 = 2.2327e-04
Loss = 4.8896e-01, PNorm = 37.8942, GNorm = 0.9746, lr_0 = 2.1904e-04
Loss = 5.2796e-01, PNorm = 37.8948, GNorm = 0.9318, lr_0 = 2.1863e-04
Validation prc-auc = 0.755559
Validation auc = 0.791441
Validation accuracy = 0.723140
Validation f1 = 0.714894
Epoch 20
Loss = 4.6930e-01, PNorm = 37.9121, GNorm = 1.4110, lr_0 = 2.1448e-04
Loss = 4.7346e-01, PNorm = 37.9302, GNorm = 1.6909, lr_0 = 2.1042e-04
Loss = 4.5222e-01, PNorm = 37.9468, GNorm = 0.8109, lr_0 = 2.0644e-04
Loss = 4.4238e-01, PNorm = 37.9666, GNorm = 0.7935, lr_0 = 2.0252e-04
Validation prc-auc = 0.759354
Validation auc = 0.790140
Validation accuracy = 0.714876
Validation f1 = 0.713693
Epoch 21
Loss = 4.6385e-01, PNorm = 37.9860, GNorm = 0.8268, lr_0 = 1.9869e-04
Loss = 4.6448e-01, PNorm = 38.0041, GNorm = 0.8874, lr_0 = 1.9492e-04
Loss = 4.5016e-01, PNorm = 38.0263, GNorm = 0.5209, lr_0 = 1.9123e-04
Loss = 4.7471e-01, PNorm = 38.0436, GNorm = 1.2300, lr_0 = 1.8761e-04
Validation prc-auc = 0.737481
Validation auc = 0.787675
Validation accuracy = 0.735537
Validation f1 = 0.746032
Epoch 22
Loss = 4.4706e-01, PNorm = 38.0584, GNorm = 1.4003, lr_0 = 1.8370e-04
Loss = 4.2794e-01, PNorm = 38.0755, GNorm = 0.9688, lr_0 = 1.8022e-04
Loss = 4.7932e-01, PNorm = 38.0879, GNorm = 1.0679, lr_0 = 1.7681e-04
Loss = 4.3410e-01, PNorm = 38.1036, GNorm = 0.8910, lr_0 = 1.7346e-04
Loss = 4.6517e-01, PNorm = 38.1176, GNorm = 1.1151, lr_0 = 1.7018e-04
Validation prc-auc = 0.752685
Validation auc = 0.794591
Validation accuracy = 0.747934
Validation f1 = 0.755020
Epoch 23
Loss = 4.1309e-01, PNorm = 38.1344, GNorm = 0.8004, lr_0 = 1.6695e-04
Loss = 4.1953e-01, PNorm = 38.1529, GNorm = 1.0839, lr_0 = 1.6379e-04
Loss = 4.6252e-01, PNorm = 38.1651, GNorm = 1.2406, lr_0 = 1.6069e-04
Loss = 4.4547e-01, PNorm = 38.1776, GNorm = 0.9545, lr_0 = 1.5764e-04
Validation prc-auc = 0.766398
Validation auc = 0.801951
Validation accuracy = 0.727273
Validation f1 = 0.722689
Epoch 24
Loss = 4.1775e-01, PNorm = 38.1939, GNorm = 1.0478, lr_0 = 1.5436e-04
Loss = 4.7687e-01, PNorm = 38.2062, GNorm = 1.0597, lr_0 = 1.5144e-04
Loss = 4.2615e-01, PNorm = 38.2190, GNorm = 1.0065, lr_0 = 1.4857e-04
Loss = 4.4996e-01, PNorm = 38.2333, GNorm = 1.3292, lr_0 = 1.4575e-04
Validation prc-auc = 0.760208
Validation auc = 0.797398
Validation accuracy = 0.735537
Validation f1 = 0.744000
Epoch 25
Loss = 4.2348e-01, PNorm = 38.2461, GNorm = 0.8584, lr_0 = 1.4299e-04
Loss = 4.5714e-01, PNorm = 38.2597, GNorm = 1.2917, lr_0 = 1.4028e-04
Loss = 4.3347e-01, PNorm = 38.2728, GNorm = 0.8154, lr_0 = 1.3763e-04
Loss = 4.2032e-01, PNorm = 38.2858, GNorm = 1.1708, lr_0 = 1.3502e-04
Loss = 4.2838e-01, PNorm = 38.3003, GNorm = 1.3270, lr_0 = 1.3246e-04
Validation prc-auc = 0.760624
Validation auc = 0.803218
Validation accuracy = 0.739669
Validation f1 = 0.740741
Epoch 26
Loss = 4.3962e-01, PNorm = 38.3103, GNorm = 1.4320, lr_0 = 1.2995e-04
Loss = 4.4921e-01, PNorm = 38.3207, GNorm = 0.7957, lr_0 = 1.2749e-04
Loss = 4.5336e-01, PNorm = 38.3313, GNorm = 1.1014, lr_0 = 1.2508e-04
Loss = 4.1648e-01, PNorm = 38.3430, GNorm = 0.6797, lr_0 = 1.2271e-04
Validation prc-auc = 0.761651
Validation auc = 0.799110
Validation accuracy = 0.735537
Validation f1 = 0.746032
Epoch 27
Loss = 4.3540e-01, PNorm = 38.3573, GNorm = 1.7777, lr_0 = 1.2015e-04
Loss = 4.0762e-01, PNorm = 38.3704, GNorm = 1.2438, lr_0 = 1.1788e-04
Loss = 4.3359e-01, PNorm = 38.3805, GNorm = 0.6442, lr_0 = 1.1564e-04
Loss = 4.4867e-01, PNorm = 38.3903, GNorm = 0.7877, lr_0 = 1.1345e-04
Validation prc-auc = 0.770342
Validation auc = 0.803766
Validation accuracy = 0.719008
Validation f1 = 0.714286
Epoch 28
Loss = 3.6695e-01, PNorm = 38.3984, GNorm = 0.8098, lr_0 = 1.1130e-04
Loss = 4.2988e-01, PNorm = 38.4061, GNorm = 0.9152, lr_0 = 1.0920e-04
Loss = 4.5118e-01, PNorm = 38.4154, GNorm = 0.8600, lr_0 = 1.0713e-04
Loss = 4.1016e-01, PNorm = 38.4248, GNorm = 0.9723, lr_0 = 1.0510e-04
Loss = 4.1591e-01, PNorm = 38.4354, GNorm = 1.0486, lr_0 = 1.0311e-04
Validation prc-auc = 0.763046
Validation auc = 0.801301
Validation accuracy = 0.727273
Validation f1 = 0.736000
Epoch 29
Loss = 4.0050e-01, PNorm = 38.4446, GNorm = 1.3343, lr_0 = 1.0096e-04
Loss = 4.2903e-01, PNorm = 38.4536, GNorm = 1.6617, lr_0 = 1.0000e-04
Loss = 4.4195e-01, PNorm = 38.4619, GNorm = 1.0455, lr_0 = 1.0000e-04
Loss = 4.3145e-01, PNorm = 38.4689, GNorm = 1.2239, lr_0 = 1.0000e-04
Validation prc-auc = 0.771863
Validation auc = 0.801027
Validation accuracy = 0.735537
Validation f1 = 0.731092
Model 0 best validation prc-auc = 0.771863 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.689703
Model 0 test auc = 0.822462
Model 0 test accuracy = 0.760243
Model 0 test f1 = 0.732203
Ensemble test prc-auc = 0.689703
Ensemble test auc = 0.822462
Ensemble test accuracy = 0.760243
Ensemble test f1 = 0.732203
5-fold cross validation
	Seed 0 ==> test prc-auc = 0.706763
	Seed 0 ==> test auc = 0.817911
	Seed 0 ==> test accuracy = 0.745068
	Seed 0 ==> test f1 = 0.715254
	Seed 1 ==> test prc-auc = 0.711636
	Seed 1 ==> test auc = 0.830626
	Seed 1 ==> test accuracy = 0.749621
	Seed 1 ==> test f1 = 0.727273
	Seed 2 ==> test prc-auc = 0.704526
	Seed 2 ==> test auc = 0.822381
	Seed 2 ==> test accuracy = 0.757208
	Seed 2 ==> test f1 = 0.712230
	Seed 3 ==> test prc-auc = 0.692152
	Seed 3 ==> test auc = 0.814679
	Seed 3 ==> test accuracy = 0.763278
	Seed 3 ==> test f1 = 0.712177
	Seed 4 ==> test prc-auc = 0.689703
	Seed 4 ==> test auc = 0.822462
	Seed 4 ==> test accuracy = 0.760243
	Seed 4 ==> test f1 = 0.732203
Overall test prc-auc = 0.700956 +/- 0.008540
Overall test auc = 0.821612 +/- 0.005373
Overall test accuracy = 0.755083 +/- 0.006759
Overall test f1 = 0.719828 +/- 0.008316
Elapsed time = 0:13:29
Command line
python /usr/local/lib/python3.10/dist-packages/ipykernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-0831b817-b956-44b6-9ad1-5b41ca65693c.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/data/binarized_chemprop_trainset.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc', 'accuracy', 'f1'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc', 'accuracy', 'f1'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/models/antibiotic_chemprop_rdkit',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': '/content/data/binarized_chemprop_testset.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['fluor'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Epoch 0
Loss = 7.1041e-01, PNorm = 35.0666, GNorm = 0.5789, lr_0 = 2.1512e-04
Loss = 6.6703e-01, PNorm = 35.0721, GNorm = 1.1461, lr_0 = 3.1977e-04
Loss = 6.4504e-01, PNorm = 35.0848, GNorm = 0.6454, lr_0 = 4.2442e-04
Loss = 6.7214e-01, PNorm = 35.0984, GNorm = 1.3203, lr_0 = 5.2907e-04
Validation prc-auc = 0.715216
Validation auc = 0.734817
Validation accuracy = 0.607438
Validation f1 = 0.326241
Epoch 1
Loss = 6.3531e-01, PNorm = 35.1218, GNorm = 1.0878, lr_0 = 6.4419e-04
Loss = 6.1377e-01, PNorm = 35.1615, GNorm = 2.3248, lr_0 = 7.4884e-04
Loss = 6.1058e-01, PNorm = 35.1993, GNorm = 1.9071, lr_0 = 8.5349e-04
Loss = 6.5200e-01, PNorm = 35.2520, GNorm = 2.1051, lr_0 = 9.5814e-04
Validation prc-auc = 0.728746
Validation auc = 0.749401
Validation accuracy = 0.669421
Validation f1 = 0.629630
Epoch 2
Loss = 5.6065e-01, PNorm = 35.3097, GNorm = 0.3440, lr_0 = 9.8859e-04
Loss = 5.9901e-01, PNorm = 35.3806, GNorm = 1.1867, lr_0 = 9.6986e-04
Loss = 5.5910e-01, PNorm = 35.4531, GNorm = 1.2528, lr_0 = 9.5149e-04
Loss = 6.0598e-01, PNorm = 35.5095, GNorm = 1.2891, lr_0 = 9.3347e-04
Loss = 5.6730e-01, PNorm = 35.5592, GNorm = 0.6330, lr_0 = 9.1579e-04
Loss = 5.7481e-01, PNorm = 35.5635, GNorm = 0.8583, lr_0 = 9.1404e-04
Validation prc-auc = 0.740851
Validation auc = 0.768299
Validation accuracy = 0.698347
Validation f1 = 0.678414
Epoch 3
Loss = 5.5431e-01, PNorm = 35.6161, GNorm = 1.2084, lr_0 = 8.9672e-04
Loss = 5.5995e-01, PNorm = 35.6629, GNorm = 1.1439, lr_0 = 8.7974e-04
Loss = 5.6632e-01, PNorm = 35.7193, GNorm = 0.7000, lr_0 = 8.6307e-04
Loss = 5.2802e-01, PNorm = 35.7799, GNorm = 1.0832, lr_0 = 8.4672e-04
Validation prc-auc = 0.747731
Validation auc = 0.789866
Validation accuracy = 0.731405
Validation f1 = 0.768683
Epoch 4
Loss = 5.6970e-01, PNorm = 35.8326, GNorm = 1.1319, lr_0 = 8.3068e-04
Loss = 5.4101e-01, PNorm = 35.8878, GNorm = 0.3249, lr_0 = 8.1495e-04
Loss = 5.0807e-01, PNorm = 35.9463, GNorm = 0.5190, lr_0 = 7.9951e-04
Loss = 5.3559e-01, PNorm = 35.9889, GNorm = 1.1384, lr_0 = 7.8437e-04
Validation prc-auc = 0.791335
Validation auc = 0.822013
Validation accuracy = 0.719008
Validation f1 = 0.742424
Epoch 5
Loss = 5.1780e-01, PNorm = 36.0432, GNorm = 0.4636, lr_0 = 7.6804e-04
Loss = 5.1659e-01, PNorm = 36.1054, GNorm = 0.6981, lr_0 = 7.5349e-04
Loss = 5.3047e-01, PNorm = 36.1448, GNorm = 0.4692, lr_0 = 7.3921e-04
Loss = 4.9932e-01, PNorm = 36.1894, GNorm = 0.6605, lr_0 = 7.2521e-04
Loss = 5.4093e-01, PNorm = 36.2470, GNorm = 1.4737, lr_0 = 7.1147e-04
Validation prc-auc = 0.757984
Validation auc = 0.814995
Validation accuracy = 0.723140
Validation f1 = 0.714894
Epoch 6
Loss = 4.8753e-01, PNorm = 36.3106, GNorm = 0.4929, lr_0 = 6.9800e-04
Loss = 5.1669e-01, PNorm = 36.3590, GNorm = 0.4174, lr_0 = 6.8478e-04
Loss = 5.2182e-01, PNorm = 36.3939, GNorm = 1.2292, lr_0 = 6.7180e-04
Loss = 5.2018e-01, PNorm = 36.4212, GNorm = 0.7027, lr_0 = 6.5908e-04
Validation prc-auc = 0.809711
Validation auc = 0.839199
Validation accuracy = 0.760331
Validation f1 = 0.745614
Epoch 7
Loss = 5.1902e-01, PNorm = 36.4786, GNorm = 0.4192, lr_0 = 6.4536e-04
Loss = 4.8231e-01, PNorm = 36.5313, GNorm = 0.5262, lr_0 = 6.3313e-04
Loss = 4.9612e-01, PNorm = 36.5722, GNorm = 1.6319, lr_0 = 6.2114e-04
Loss = 4.9131e-01, PNorm = 36.6179, GNorm = 0.5257, lr_0 = 6.0937e-04
Validation prc-auc = 0.786812
Validation auc = 0.833790
Validation accuracy = 0.752066
Validation f1 = 0.736842
Epoch 8
Loss = 5.5895e-01, PNorm = 36.6619, GNorm = 0.5479, lr_0 = 5.9783e-04
Loss = 4.8005e-01, PNorm = 36.7015, GNorm = 0.5705, lr_0 = 5.8651e-04
Loss = 4.8748e-01, PNorm = 36.7451, GNorm = 0.7282, lr_0 = 5.7540e-04
Loss = 5.0252e-01, PNorm = 36.7926, GNorm = 0.6724, lr_0 = 5.6450e-04
Loss = 4.3590e-01, PNorm = 36.8554, GNorm = 0.5798, lr_0 = 5.5380e-04
Validation prc-auc = 0.792463
Validation auc = 0.832420
Validation accuracy = 0.714876
Validation f1 = 0.642487
Epoch 9
Loss = 4.7218e-01, PNorm = 36.8924, GNorm = 0.6747, lr_0 = 5.4227e-04
Loss = 4.9216e-01, PNorm = 36.9375, GNorm = 0.6840, lr_0 = 5.3200e-04
Loss = 4.6089e-01, PNorm = 36.9724, GNorm = 0.5291, lr_0 = 5.2192e-04
Loss = 4.7556e-01, PNorm = 37.0082, GNorm = 0.5501, lr_0 = 5.1204e-04
Validation prc-auc = 0.809744
Validation auc = 0.836700
Validation accuracy = 0.776860
Validation f1 = 0.765217
Epoch 10
Loss = 4.9419e-01, PNorm = 37.0462, GNorm = 1.1855, lr_0 = 5.0234e-04
Loss = 4.9562e-01, PNorm = 37.0929, GNorm = 1.9995, lr_0 = 4.9282e-04
Loss = 4.7389e-01, PNorm = 37.1353, GNorm = 0.4735, lr_0 = 4.8349e-04
Loss = 4.6365e-01, PNorm = 37.1729, GNorm = 0.9509, lr_0 = 4.7433e-04
Validation prc-auc = 0.766749
Validation auc = 0.826737
Validation accuracy = 0.752066
Validation f1 = 0.754098
Epoch 11
Loss = 4.2364e-01, PNorm = 37.2106, GNorm = 0.6603, lr_0 = 4.6445e-04
Loss = 4.4467e-01, PNorm = 37.2345, GNorm = 1.0439, lr_0 = 4.5566e-04
Loss = 4.6357e-01, PNorm = 37.2652, GNorm = 0.7244, lr_0 = 4.4703e-04
Loss = 4.6396e-01, PNorm = 37.3003, GNorm = 0.6595, lr_0 = 4.3856e-04
Loss = 4.8762e-01, PNorm = 37.3179, GNorm = 0.9427, lr_0 = 4.3025e-04
Validation prc-auc = 0.787766
Validation auc = 0.834817
Validation accuracy = 0.752066
Validation f1 = 0.736842
Epoch 12
Loss = 4.5550e-01, PNorm = 37.3438, GNorm = 0.8508, lr_0 = 4.2210e-04
Loss = 4.4749e-01, PNorm = 37.3850, GNorm = 0.4900, lr_0 = 4.1410e-04
Loss = 4.4034e-01, PNorm = 37.4252, GNorm = 0.6069, lr_0 = 4.0626e-04
Loss = 4.7856e-01, PNorm = 37.4517, GNorm = 0.4234, lr_0 = 3.9856e-04
Validation prc-auc = 0.800304
Validation auc = 0.846388
Validation accuracy = 0.772727
Validation f1 = 0.779116
Epoch 13
Loss = 4.4528e-01, PNorm = 37.4741, GNorm = 0.7558, lr_0 = 3.9101e-04
Loss = 4.3731e-01, PNorm = 37.5064, GNorm = 0.4144, lr_0 = 3.8361e-04
Loss = 4.6348e-01, PNorm = 37.5361, GNorm = 0.4982, lr_0 = 3.7634e-04
Loss = 4.3015e-01, PNorm = 37.5578, GNorm = 0.4499, lr_0 = 3.6921e-04
Validation prc-auc = 0.786264
Validation auc = 0.843273
Validation accuracy = 0.776860
Validation f1 = 0.773109
Epoch 14
Loss = 4.5346e-01, PNorm = 37.5889, GNorm = 0.8766, lr_0 = 3.6153e-04
Loss = 4.4621e-01, PNorm = 37.6184, GNorm = 0.4303, lr_0 = 3.5468e-04
Loss = 4.3437e-01, PNorm = 37.6461, GNorm = 0.5256, lr_0 = 3.4796e-04
Loss = 4.0699e-01, PNorm = 37.6807, GNorm = 0.5512, lr_0 = 3.4137e-04
Loss = 4.6013e-01, PNorm = 37.7045, GNorm = 0.6382, lr_0 = 3.3490e-04
Validation prc-auc = 0.824386
Validation auc = 0.855597
Validation accuracy = 0.797521
Validation f1 = 0.796680
Epoch 15
Loss = 4.1999e-01, PNorm = 37.7236, GNorm = 0.8831, lr_0 = 3.2856e-04
Loss = 4.3983e-01, PNorm = 37.7456, GNorm = 0.5881, lr_0 = 3.2233e-04
Loss = 4.1695e-01, PNorm = 37.7722, GNorm = 0.6065, lr_0 = 3.1623e-04
Loss = 4.3328e-01, PNorm = 37.7970, GNorm = 0.5842, lr_0 = 3.1024e-04
Validation prc-auc = 0.811589
Validation auc = 0.855734
Validation accuracy = 0.793388
Validation f1 = 0.800000
Epoch 16
Loss = 4.2460e-01, PNorm = 37.8209, GNorm = 0.5087, lr_0 = 3.0378e-04
Loss = 4.1387e-01, PNorm = 37.8429, GNorm = 0.5411, lr_0 = 2.9802e-04
Loss = 4.2708e-01, PNorm = 37.8650, GNorm = 1.2332, lr_0 = 2.9238e-04
Loss = 4.2858e-01, PNorm = 37.8869, GNorm = 0.7563, lr_0 = 2.8684e-04
Loss = 4.1919e-01, PNorm = 37.9120, GNorm = 0.7470, lr_0 = 2.8141e-04
Validation prc-auc = 0.832410
Validation auc = 0.862924
Validation accuracy = 0.797521
Validation f1 = 0.796680
Epoch 17
Loss = 4.3949e-01, PNorm = 37.9345, GNorm = 0.5575, lr_0 = 2.7608e-04
Loss = 4.2128e-01, PNorm = 37.9548, GNorm = 1.2268, lr_0 = 2.7085e-04
Loss = 4.2019e-01, PNorm = 37.9780, GNorm = 1.3327, lr_0 = 2.6572e-04
Loss = 4.1776e-01, PNorm = 38.0034, GNorm = 0.6124, lr_0 = 2.6068e-04
Validation prc-auc = 0.823887
Validation auc = 0.860253
Validation accuracy = 0.814050
Validation f1 = 0.813278
Epoch 18
Loss = 3.7661e-01, PNorm = 38.0382, GNorm = 0.5884, lr_0 = 2.5526e-04
Loss = 4.3862e-01, PNorm = 38.0607, GNorm = 0.8622, lr_0 = 2.5042e-04
Loss = 4.0782e-01, PNorm = 38.0790, GNorm = 0.6203, lr_0 = 2.4568e-04
Loss = 4.5419e-01, PNorm = 38.0944, GNorm = 1.1100, lr_0 = 2.4102e-04
Validation prc-auc = 0.815705
Validation auc = 0.860253
Validation accuracy = 0.785124
Validation f1 = 0.775862
Epoch 19
Loss = 4.4789e-01, PNorm = 38.1153, GNorm = 1.4813, lr_0 = 2.3646e-04
Loss = 4.0077e-01, PNorm = 38.1381, GNorm = 0.4283, lr_0 = 2.3198e-04
Loss = 4.1751e-01, PNorm = 38.1589, GNorm = 1.0675, lr_0 = 2.2758e-04
Loss = 4.1992e-01, PNorm = 38.1757, GNorm = 1.2190, lr_0 = 2.2327e-04
Loss = 3.8823e-01, PNorm = 38.1926, GNorm = 0.6549, lr_0 = 2.1904e-04
Loss = 4.0035e-01, PNorm = 38.1944, GNorm = 1.1528, lr_0 = 2.1863e-04
Validation prc-auc = 0.832668
Validation auc = 0.864601
Validation accuracy = 0.805785
Validation f1 = 0.806584
Epoch 20
Loss = 4.0624e-01, PNorm = 38.2128, GNorm = 0.5256, lr_0 = 2.1448e-04
Loss = 4.0101e-01, PNorm = 38.2331, GNorm = 0.6202, lr_0 = 2.1042e-04
Loss = 4.1484e-01, PNorm = 38.2534, GNorm = 0.5939, lr_0 = 2.0644e-04
Loss = 3.7834e-01, PNorm = 38.2739, GNorm = 0.8998, lr_0 = 2.0252e-04
Validation prc-auc = 0.828507
Validation auc = 0.865423
Validation accuracy = 0.772727
Validation f1 = 0.759825
Epoch 21
Loss = 4.0106e-01, PNorm = 38.2851, GNorm = 0.5418, lr_0 = 1.9869e-04
Loss = 4.0188e-01, PNorm = 38.2991, GNorm = 0.6575, lr_0 = 1.9492e-04
Loss = 4.0118e-01, PNorm = 38.3157, GNorm = 1.1698, lr_0 = 1.9123e-04
Loss = 4.2227e-01, PNorm = 38.3323, GNorm = 0.4901, lr_0 = 1.8761e-04
Validation prc-auc = 0.834166
Validation auc = 0.866039
Validation accuracy = 0.818182
Validation f1 = 0.821138
Epoch 22
Loss = 3.9680e-01, PNorm = 38.3496, GNorm = 0.4881, lr_0 = 1.8370e-04
Loss = 3.6703e-01, PNorm = 38.3682, GNorm = 0.7901, lr_0 = 1.8022e-04
Loss = 4.0601e-01, PNorm = 38.3837, GNorm = 0.5102, lr_0 = 1.7681e-04
Loss = 4.0354e-01, PNorm = 38.4014, GNorm = 1.7598, lr_0 = 1.7346e-04
Loss = 4.2444e-01, PNorm = 38.4135, GNorm = 0.4839, lr_0 = 1.7018e-04
Validation prc-auc = 0.834933
Validation auc = 0.867580
Validation accuracy = 0.818182
Validation f1 = 0.818182
Epoch 23
Loss = 4.3771e-01, PNorm = 38.4249, GNorm = 1.4226, lr_0 = 1.6695e-04
Loss = 3.8203e-01, PNorm = 38.4383, GNorm = 0.6859, lr_0 = 1.6379e-04
Loss = 3.7499e-01, PNorm = 38.4528, GNorm = 0.8356, lr_0 = 1.6069e-04
Loss = 4.0801e-01, PNorm = 38.4705, GNorm = 0.7250, lr_0 = 1.5764e-04
Validation prc-auc = 0.834169
Validation auc = 0.866963
Validation accuracy = 0.818182
Validation f1 = 0.822581
Epoch 24
Loss = 4.1139e-01, PNorm = 38.4859, GNorm = 1.2674, lr_0 = 1.5436e-04
Loss = 4.0621e-01, PNorm = 38.4991, GNorm = 0.7558, lr_0 = 1.5144e-04
Loss = 3.6932e-01, PNorm = 38.5126, GNorm = 1.2763, lr_0 = 1.4857e-04
Loss = 3.9844e-01, PNorm = 38.5261, GNorm = 0.5501, lr_0 = 1.4575e-04
Validation prc-auc = 0.826842
Validation auc = 0.865560
Validation accuracy = 0.809917
Validation f1 = 0.816000
Epoch 25
Loss = 4.5359e-01, PNorm = 38.5380, GNorm = 0.8599, lr_0 = 1.4299e-04
Loss = 3.7010e-01, PNorm = 38.5532, GNorm = 0.6693, lr_0 = 1.4028e-04
Loss = 3.7605e-01, PNorm = 38.5666, GNorm = 0.8642, lr_0 = 1.3763e-04
Loss = 4.2067e-01, PNorm = 38.5756, GNorm = 0.5777, lr_0 = 1.3502e-04
Loss = 3.7053e-01, PNorm = 38.5859, GNorm = 0.6240, lr_0 = 1.3246e-04
Validation prc-auc = 0.823446
Validation auc = 0.865354
Validation accuracy = 0.789256
Validation f1 = 0.782979
Epoch 26
Loss = 3.4410e-01, PNorm = 38.6000, GNorm = 1.2076, lr_0 = 1.2995e-04
Loss = 4.4162e-01, PNorm = 38.6105, GNorm = 0.6031, lr_0 = 1.2749e-04
Loss = 3.7527e-01, PNorm = 38.6207, GNorm = 0.6648, lr_0 = 1.2508e-04
Loss = 3.6616e-01, PNorm = 38.6324, GNorm = 0.5425, lr_0 = 1.2271e-04
Validation prc-auc = 0.838517
Validation auc = 0.866826
Validation accuracy = 0.805785
Validation f1 = 0.806584
Epoch 27
Loss = 3.5799e-01, PNorm = 38.6446, GNorm = 0.8018, lr_0 = 1.2015e-04
Loss = 3.7385e-01, PNorm = 38.6571, GNorm = 0.6916, lr_0 = 1.1788e-04
Loss = 3.9586e-01, PNorm = 38.6678, GNorm = 0.8251, lr_0 = 1.1564e-04
Loss = 3.9995e-01, PNorm = 38.6766, GNorm = 0.9914, lr_0 = 1.1345e-04
Validation prc-auc = 0.846756
Validation auc = 0.869565
Validation accuracy = 0.801653
Validation f1 = 0.798319
Epoch 28
Loss = 4.2873e-01, PNorm = 38.6846, GNorm = 0.6315, lr_0 = 1.1130e-04
Loss = 4.1372e-01, PNorm = 38.6936, GNorm = 1.7238, lr_0 = 1.0920e-04
Loss = 3.7803e-01, PNorm = 38.7040, GNorm = 0.5103, lr_0 = 1.0713e-04
Loss = 3.6710e-01, PNorm = 38.7146, GNorm = 0.4837, lr_0 = 1.0510e-04
Loss = 3.6945e-01, PNorm = 38.7237, GNorm = 0.8419, lr_0 = 1.0311e-04
Validation prc-auc = 0.827666
Validation auc = 0.869189
Validation accuracy = 0.801653
Validation f1 = 0.809524
Epoch 29
Loss = 3.9900e-01, PNorm = 38.7328, GNorm = 0.7395, lr_0 = 1.0096e-04
Loss = 4.0273e-01, PNorm = 38.7412, GNorm = 0.8414, lr_0 = 1.0000e-04
Loss = 3.9838e-01, PNorm = 38.7495, GNorm = 0.8067, lr_0 = 1.0000e-04
Loss = 3.4762e-01, PNorm = 38.7596, GNorm = 0.7055, lr_0 = 1.0000e-04
Validation prc-auc = 0.839766
Validation auc = 0.871414
Validation accuracy = 0.809917
Validation f1 = 0.809917
Model 0 best validation prc-auc = 0.846756 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.749410
Model 0 test auc = 0.837790
Model 0 test accuracy = 0.752656
Model 0 test f1 = 0.699816
Ensemble test prc-auc = 0.749410
Ensemble test auc = 0.837790
Ensemble test accuracy = 0.752656
Ensemble test f1 = 0.699816
Fold 1
Splitting data with seed 1
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Epoch 0
Loss = 7.0143e-01, PNorm = 35.0670, GNorm = 0.7288, lr_0 = 2.1512e-04
Loss = 7.0138e-01, PNorm = 35.0711, GNorm = 2.4280, lr_0 = 3.1977e-04
Loss = 6.7845e-01, PNorm = 35.0792, GNorm = 0.7987, lr_0 = 4.2442e-04
Loss = 6.6701e-01, PNorm = 35.0930, GNorm = 0.5211, lr_0 = 5.2907e-04
Validation prc-auc = 0.654261
Validation auc = 0.704844
Validation accuracy = 0.636364
Validation f1 = 0.648000
Epoch 1
Loss = 6.6720e-01, PNorm = 35.1152, GNorm = 0.4463, lr_0 = 6.4419e-04
Loss = 6.3770e-01, PNorm = 35.1447, GNorm = 1.9666, lr_0 = 7.4884e-04
Loss = 6.3220e-01, PNorm = 35.1851, GNorm = 0.5262, lr_0 = 8.5349e-04
Loss = 5.9307e-01, PNorm = 35.2384, GNorm = 0.5007, lr_0 = 9.5814e-04
Validation prc-auc = 0.682964
Validation auc = 0.740292
Validation accuracy = 0.677686
Validation f1 = 0.680328
Epoch 2
Loss = 5.9469e-01, PNorm = 35.3076, GNorm = 0.8836, lr_0 = 9.8859e-04
Loss = 5.8415e-01, PNorm = 35.3744, GNorm = 0.7738, lr_0 = 9.6986e-04
Loss = 5.9037e-01, PNorm = 35.4416, GNorm = 0.4179, lr_0 = 9.5149e-04
Loss = 5.8598e-01, PNorm = 35.5185, GNorm = 1.5731, lr_0 = 9.3347e-04
Loss = 5.5685e-01, PNorm = 35.5975, GNorm = 0.7267, lr_0 = 9.1579e-04
Loss = 7.5379e-01, PNorm = 35.6050, GNorm = 1.0902, lr_0 = 9.1404e-04
Validation prc-auc = 0.680702
Validation auc = 0.758465
Validation accuracy = 0.661157
Validation f1 = 0.694030
Epoch 3
Loss = 5.8716e-01, PNorm = 35.6485, GNorm = 0.4437, lr_0 = 8.9672e-04
Loss = 5.7691e-01, PNorm = 35.7026, GNorm = 0.5068, lr_0 = 8.7974e-04
Loss = 5.5026e-01, PNorm = 35.7785, GNorm = 0.6449, lr_0 = 8.6307e-04
Loss = 5.6219e-01, PNorm = 35.8362, GNorm = 0.5931, lr_0 = 8.4672e-04
Validation prc-auc = 0.713660
Validation auc = 0.778020
Validation accuracy = 0.727273
Validation f1 = 0.694444
Epoch 4
Loss = 5.4924e-01, PNorm = 35.8959, GNorm = 0.5976, lr_0 = 8.3068e-04
Loss = 5.5521e-01, PNorm = 35.9435, GNorm = 0.3122, lr_0 = 8.1495e-04
Loss = 5.1836e-01, PNorm = 35.9811, GNorm = 0.9091, lr_0 = 7.9951e-04
Loss = 5.0220e-01, PNorm = 36.0453, GNorm = 0.4183, lr_0 = 7.8437e-04
Validation prc-auc = 0.713293
Validation auc = 0.793636
Validation accuracy = 0.685950
Validation f1 = 0.568182
Epoch 5
Loss = 5.1273e-01, PNorm = 36.1031, GNorm = 0.4135, lr_0 = 7.6804e-04
Loss = 5.0648e-01, PNorm = 36.1627, GNorm = 0.7153, lr_0 = 7.5349e-04
Loss = 5.4082e-01, PNorm = 36.2200, GNorm = 1.2733, lr_0 = 7.3921e-04
Loss = 5.1248e-01, PNorm = 36.2740, GNorm = 1.3319, lr_0 = 7.2521e-04
Loss = 5.1018e-01, PNorm = 36.3243, GNorm = 0.3793, lr_0 = 7.1147e-04
Validation prc-auc = 0.706661
Validation auc = 0.795156
Validation accuracy = 0.702479
Validation f1 = 0.604396
Epoch 6
Loss = 5.0998e-01, PNorm = 36.3796, GNorm = 0.4207, lr_0 = 6.9800e-04
Loss = 5.1133e-01, PNorm = 36.4324, GNorm = 1.0810, lr_0 = 6.8478e-04
Loss = 5.1853e-01, PNorm = 36.4675, GNorm = 0.3766, lr_0 = 6.7180e-04
Loss = 4.9328e-01, PNorm = 36.5167, GNorm = 0.6046, lr_0 = 6.5908e-04
Validation prc-auc = 0.726245
Validation auc = 0.800339
Validation accuracy = 0.714876
Validation f1 = 0.631016
Epoch 7
Loss = 4.2435e-01, PNorm = 36.5857, GNorm = 0.5566, lr_0 = 6.4536e-04
Loss = 4.7992e-01, PNorm = 36.6427, GNorm = 0.9346, lr_0 = 6.3313e-04
Loss = 5.1223e-01, PNorm = 36.6739, GNorm = 0.7461, lr_0 = 6.2114e-04
Loss = 5.1952e-01, PNorm = 36.7129, GNorm = 0.3839, lr_0 = 6.0937e-04
Validation prc-auc = 0.718045
Validation auc = 0.805141
Validation accuracy = 0.752066
Validation f1 = 0.743590
Epoch 8
Loss = 5.7336e-01, PNorm = 36.7608, GNorm = 0.5668, lr_0 = 5.9783e-04
Loss = 4.5563e-01, PNorm = 36.8077, GNorm = 0.5560, lr_0 = 5.8651e-04
Loss = 4.4385e-01, PNorm = 36.8546, GNorm = 1.0567, lr_0 = 5.7540e-04
Loss = 5.1277e-01, PNorm = 36.9033, GNorm = 0.7921, lr_0 = 5.6450e-04
Loss = 4.7145e-01, PNorm = 36.9325, GNorm = 0.5797, lr_0 = 5.5380e-04
Validation prc-auc = 0.752546
Validation auc = 0.811878
Validation accuracy = 0.752066
Validation f1 = 0.739130
Epoch 9
Loss = 4.6757e-01, PNorm = 36.9787, GNorm = 0.9027, lr_0 = 5.4227e-04
Loss = 4.4662e-01, PNorm = 37.0267, GNorm = 1.7106, lr_0 = 5.3200e-04
Loss = 4.6313e-01, PNorm = 37.0635, GNorm = 0.5203, lr_0 = 5.2192e-04
Loss = 4.9188e-01, PNorm = 37.1028, GNorm = 0.4680, lr_0 = 5.1204e-04
Validation prc-auc = 0.734447
Validation auc = 0.811291
Validation accuracy = 0.739669
Validation f1 = 0.729614
Epoch 10
Loss = 4.5843e-01, PNorm = 37.1311, GNorm = 0.7156, lr_0 = 5.0234e-04
Loss = 4.5752e-01, PNorm = 37.1707, GNorm = 0.6952, lr_0 = 4.9282e-04
Loss = 4.4253e-01, PNorm = 37.2141, GNorm = 0.8185, lr_0 = 4.8349e-04
Loss = 4.3669e-01, PNorm = 37.2540, GNorm = 0.4863, lr_0 = 4.7433e-04
Validation prc-auc = 0.749944
Validation auc = 0.815644
Validation accuracy = 0.760331
Validation f1 = 0.715686
Epoch 11
Loss = 4.7619e-01, PNorm = 37.2854, GNorm = 0.5532, lr_0 = 4.6445e-04
Loss = 4.3111e-01, PNorm = 37.3184, GNorm = 0.4019, lr_0 = 4.5566e-04
Loss = 4.4401e-01, PNorm = 37.3520, GNorm = 0.6802, lr_0 = 4.4703e-04
Loss = 4.5306e-01, PNorm = 37.3888, GNorm = 0.4701, lr_0 = 4.3856e-04
Loss = 4.6098e-01, PNorm = 37.4229, GNorm = 1.3000, lr_0 = 4.3025e-04
Validation prc-auc = 0.746690
Validation auc = 0.819583
Validation accuracy = 0.776860
Validation f1 = 0.761062
Epoch 12
Loss = 4.3830e-01, PNorm = 37.4483, GNorm = 0.4076, lr_0 = 4.2210e-04
Loss = 4.3967e-01, PNorm = 37.4925, GNorm = 1.3460, lr_0 = 4.1410e-04
Loss = 4.7068e-01, PNorm = 37.5267, GNorm = 1.2126, lr_0 = 4.0626e-04
Loss = 4.5804e-01, PNorm = 37.5420, GNorm = 0.4944, lr_0 = 3.9856e-04
Validation prc-auc = 0.740222
Validation auc = 0.818339
Validation accuracy = 0.739669
Validation f1 = 0.692683
Epoch 13
Loss = 4.8033e-01, PNorm = 37.5757, GNorm = 0.5952, lr_0 = 3.9101e-04
Loss = 4.3562e-01, PNorm = 37.6185, GNorm = 0.5890, lr_0 = 3.8361e-04
Loss = 4.4729e-01, PNorm = 37.6481, GNorm = 0.7344, lr_0 = 3.7634e-04
Loss = 4.3267e-01, PNorm = 37.6652, GNorm = 0.4024, lr_0 = 3.6921e-04
Validation prc-auc = 0.753138
Validation auc = 0.823279
Validation accuracy = 0.768595
Validation f1 = 0.743119
Epoch 14
Loss = 3.7218e-01, PNorm = 37.6946, GNorm = 0.4394, lr_0 = 3.6153e-04
Loss = 4.2717e-01, PNorm = 37.7294, GNorm = 0.8561, lr_0 = 3.5468e-04
Loss = 4.0090e-01, PNorm = 37.7632, GNorm = 0.4794, lr_0 = 3.4796e-04
Loss = 4.2420e-01, PNorm = 37.7943, GNorm = 0.7868, lr_0 = 3.4137e-04
Loss = 4.3039e-01, PNorm = 37.8196, GNorm = 0.6681, lr_0 = 3.3490e-04
Validation prc-auc = 0.742084
Validation auc = 0.824040
Validation accuracy = 0.780992
Validation f1 = 0.755760
Epoch 15
Loss = 4.1706e-01, PNorm = 37.8430, GNorm = 0.4690, lr_0 = 3.2856e-04
Loss = 4.2385e-01, PNorm = 37.8742, GNorm = 0.5761, lr_0 = 3.2233e-04
Loss = 4.3666e-01, PNorm = 37.8983, GNorm = 0.7428, lr_0 = 3.1623e-04
Loss = 4.1432e-01, PNorm = 37.9252, GNorm = 0.6740, lr_0 = 3.1024e-04
Validation prc-auc = 0.761645
Validation auc = 0.826320
Validation accuracy = 0.760331
Validation f1 = 0.718447
Epoch 16
Loss = 4.0774e-01, PNorm = 37.9512, GNorm = 0.9806, lr_0 = 3.0378e-04
Loss = 4.2836e-01, PNorm = 37.9761, GNorm = 0.5329, lr_0 = 2.9802e-04
Loss = 4.3386e-01, PNorm = 37.9965, GNorm = 0.5311, lr_0 = 2.9238e-04
Loss = 3.9807e-01, PNorm = 38.0232, GNorm = 0.5673, lr_0 = 2.8684e-04
Loss = 4.0190e-01, PNorm = 38.0442, GNorm = 0.6319, lr_0 = 2.8141e-04
Validation prc-auc = 0.757468
Validation auc = 0.829015
Validation accuracy = 0.772727
Validation f1 = 0.744186
Epoch 17
Loss = 4.2078e-01, PNorm = 38.0650, GNorm = 0.5947, lr_0 = 2.7608e-04
Loss = 3.8597e-01, PNorm = 38.0896, GNorm = 0.8610, lr_0 = 2.7085e-04
Loss = 4.3635e-01, PNorm = 38.1110, GNorm = 0.7195, lr_0 = 2.6572e-04
Loss = 3.9980e-01, PNorm = 38.1329, GNorm = 0.6394, lr_0 = 2.6068e-04
Validation prc-auc = 0.774215
Validation auc = 0.833644
Validation accuracy = 0.760331
Validation f1 = 0.754237
Epoch 18
Loss = 4.1586e-01, PNorm = 38.1615, GNorm = 0.8975, lr_0 = 2.5526e-04
Loss = 3.9898e-01, PNorm = 38.1884, GNorm = 0.5639, lr_0 = 2.5042e-04
Loss = 4.1525e-01, PNorm = 38.2084, GNorm = 0.6306, lr_0 = 2.4568e-04
Loss = 3.9241e-01, PNorm = 38.2294, GNorm = 0.7566, lr_0 = 2.4102e-04
Validation prc-auc = 0.751486
Validation auc = 0.827978
Validation accuracy = 0.768595
Validation f1 = 0.743119
Epoch 19
Loss = 4.3266e-01, PNorm = 38.2507, GNorm = 0.5484, lr_0 = 2.3646e-04
Loss = 3.8895e-01, PNorm = 38.2711, GNorm = 1.0835, lr_0 = 2.3198e-04
Loss = 4.2061e-01, PNorm = 38.2937, GNorm = 0.7385, lr_0 = 2.2758e-04
Loss = 3.9201e-01, PNorm = 38.3118, GNorm = 0.8141, lr_0 = 2.2327e-04
Loss = 4.0660e-01, PNorm = 38.3313, GNorm = 1.0988, lr_0 = 2.1904e-04
Loss = 3.0089e-01, PNorm = 38.3332, GNorm = 0.8849, lr_0 = 2.1863e-04
Validation prc-auc = 0.760019
Validation auc = 0.828600
Validation accuracy = 0.768595
Validation f1 = 0.750000
Epoch 20
Loss = 3.7428e-01, PNorm = 38.3512, GNorm = 0.7163, lr_0 = 2.1448e-04
Loss = 4.1388e-01, PNorm = 38.3683, GNorm = 0.6515, lr_0 = 2.1042e-04
Loss = 3.8887e-01, PNorm = 38.3884, GNorm = 0.9128, lr_0 = 2.0644e-04
Loss = 4.1819e-01, PNorm = 38.4037, GNorm = 0.3982, lr_0 = 2.0252e-04
Validation prc-auc = 0.761384
Validation auc = 0.832297
Validation accuracy = 0.772727
Validation f1 = 0.746544
Epoch 21
Loss = 3.9265e-01, PNorm = 38.4199, GNorm = 0.6045, lr_0 = 1.9869e-04
Loss = 3.8477e-01, PNorm = 38.4363, GNorm = 0.6233, lr_0 = 1.9492e-04
Loss = 4.0956e-01, PNorm = 38.4520, GNorm = 0.6424, lr_0 = 1.9123e-04
Loss = 3.9729e-01, PNorm = 38.4684, GNorm = 0.4633, lr_0 = 1.8761e-04
Validation prc-auc = 0.763342
Validation auc = 0.832193
Validation accuracy = 0.772727
Validation f1 = 0.736842
Epoch 22
Loss = 3.7481e-01, PNorm = 38.4882, GNorm = 0.5605, lr_0 = 1.8370e-04
Loss = 3.9979e-01, PNorm = 38.5030, GNorm = 0.5859, lr_0 = 1.8022e-04
Loss = 4.2017e-01, PNorm = 38.5151, GNorm = 1.4090, lr_0 = 1.7681e-04
Loss = 3.5565e-01, PNorm = 38.5302, GNorm = 0.7310, lr_0 = 1.7346e-04
Loss = 3.8433e-01, PNorm = 38.5469, GNorm = 0.6854, lr_0 = 1.7018e-04
Validation prc-auc = 0.770150
Validation auc = 0.836685
Validation accuracy = 0.776860
Validation f1 = 0.763158
Epoch 23
Loss = 3.8924e-01, PNorm = 38.5647, GNorm = 0.9507, lr_0 = 1.6695e-04
Loss = 4.0826e-01, PNorm = 38.5761, GNorm = 0.5575, lr_0 = 1.6379e-04
Loss = 3.5768e-01, PNorm = 38.5902, GNorm = 0.6858, lr_0 = 1.6069e-04
Loss = 3.9735e-01, PNorm = 38.6031, GNorm = 0.5379, lr_0 = 1.5764e-04
Validation prc-auc = 0.766339
Validation auc = 0.838619
Validation accuracy = 0.768595
Validation f1 = 0.733333
Epoch 24
Loss = 3.4753e-01, PNorm = 38.6162, GNorm = 0.7778, lr_0 = 1.5436e-04
Loss = 3.9706e-01, PNorm = 38.6293, GNorm = 0.6148, lr_0 = 1.5144e-04
Loss = 4.0580e-01, PNorm = 38.6391, GNorm = 0.9230, lr_0 = 1.4857e-04
Loss = 3.6868e-01, PNorm = 38.6483, GNorm = 1.2085, lr_0 = 1.4575e-04
Validation prc-auc = 0.775163
Validation auc = 0.838516
Validation accuracy = 0.764463
Validation f1 = 0.732394
Epoch 25
Loss = 3.6842e-01, PNorm = 38.6619, GNorm = 1.2373, lr_0 = 1.4299e-04
Loss = 3.9188e-01, PNorm = 38.6753, GNorm = 0.4219, lr_0 = 1.4028e-04
Loss = 3.6521e-01, PNorm = 38.6880, GNorm = 0.5942, lr_0 = 1.3763e-04
Loss = 3.8214e-01, PNorm = 38.6997, GNorm = 0.5810, lr_0 = 1.3502e-04
Loss = 3.6809e-01, PNorm = 38.7111, GNorm = 0.7986, lr_0 = 1.3246e-04
Validation prc-auc = 0.771517
Validation auc = 0.839449
Validation accuracy = 0.780992
Validation f1 = 0.764444
Epoch 26
Loss = 3.5947e-01, PNorm = 38.7229, GNorm = 0.6657, lr_0 = 1.2995e-04
Loss = 3.3550e-01, PNorm = 38.7345, GNorm = 1.1864, lr_0 = 1.2749e-04
Loss = 3.6391e-01, PNorm = 38.7478, GNorm = 0.5625, lr_0 = 1.2508e-04
Loss = 4.1680e-01, PNorm = 38.7578, GNorm = 0.8815, lr_0 = 1.2271e-04
Validation prc-auc = 0.775215
Validation auc = 0.840347
Validation accuracy = 0.776860
Validation f1 = 0.740385
Epoch 27
Loss = 3.8673e-01, PNorm = 38.7658, GNorm = 0.5978, lr_0 = 1.2015e-04
Loss = 3.5599e-01, PNorm = 38.7766, GNorm = 0.6359, lr_0 = 1.1788e-04
Loss = 3.8420e-01, PNorm = 38.7853, GNorm = 1.2095, lr_0 = 1.1564e-04
Loss = 3.9281e-01, PNorm = 38.7939, GNorm = 0.3844, lr_0 = 1.1345e-04
Validation prc-auc = 0.775281
Validation auc = 0.840969
Validation accuracy = 0.785124
Validation f1 = 0.763636
Epoch 28
Loss = 4.7328e-01, PNorm = 38.8041, GNorm = 0.7678, lr_0 = 1.1130e-04
Loss = 3.3525e-01, PNorm = 38.8145, GNorm = 0.7117, lr_0 = 1.0920e-04
Loss = 3.9289e-01, PNorm = 38.8251, GNorm = 0.7758, lr_0 = 1.0713e-04
Loss = 3.6022e-01, PNorm = 38.8348, GNorm = 0.6557, lr_0 = 1.0510e-04
Loss = 3.6969e-01, PNorm = 38.8437, GNorm = 0.6019, lr_0 = 1.0311e-04
Validation prc-auc = 0.772575
Validation auc = 0.841003
Validation accuracy = 0.793388
Validation f1 = 0.754902
Epoch 29
Loss = 3.4865e-01, PNorm = 38.8520, GNorm = 0.7928, lr_0 = 1.0096e-04
Loss = 3.7587e-01, PNorm = 38.8605, GNorm = 0.8486, lr_0 = 1.0000e-04
Loss = 3.7795e-01, PNorm = 38.8694, GNorm = 0.5249, lr_0 = 1.0000e-04
Loss = 3.6872e-01, PNorm = 38.8795, GNorm = 0.6576, lr_0 = 1.0000e-04
Validation prc-auc = 0.775161
Validation auc = 0.841971
Validation accuracy = 0.785124
Validation f1 = 0.767857
Model 0 best validation prc-auc = 0.775281 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.721974
Model 0 test auc = 0.830002
Model 0 test accuracy = 0.743551
Model 0 test f1 = 0.712095
Ensemble test prc-auc = 0.721974
Ensemble test auc = 0.830002
Ensemble test accuracy = 0.743551
Ensemble test f1 = 0.712095
Fold 2
Splitting data with seed 2
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Epoch 0
Loss = 7.0676e-01, PNorm = 35.0666, GNorm = 1.2764, lr_0 = 2.1512e-04
Loss = 7.1231e-01, PNorm = 35.0704, GNorm = 1.5905, lr_0 = 3.1977e-04
Loss = 6.6399e-01, PNorm = 35.0789, GNorm = 1.2802, lr_0 = 4.2442e-04
Loss = 6.4024e-01, PNorm = 35.0950, GNorm = 0.6154, lr_0 = 5.2907e-04
Validation prc-auc = 0.687818
Validation auc = 0.744039
Validation accuracy = 0.632231
Validation f1 = 0.669145
Epoch 1
Loss = 6.6290e-01, PNorm = 35.1150, GNorm = 1.2538, lr_0 = 6.4419e-04
Loss = 6.2881e-01, PNorm = 35.1431, GNorm = 1.2239, lr_0 = 7.4884e-04
Loss = 6.1697e-01, PNorm = 35.1859, GNorm = 0.6381, lr_0 = 8.5349e-04
Loss = 6.1145e-01, PNorm = 35.2347, GNorm = 1.5825, lr_0 = 9.5814e-04
Validation prc-auc = 0.699395
Validation auc = 0.754154
Validation accuracy = 0.665289
Validation f1 = 0.612440
Epoch 2
Loss = 6.1835e-01, PNorm = 35.2898, GNorm = 0.4144, lr_0 = 9.8859e-04
Loss = 5.8149e-01, PNorm = 35.3550, GNorm = 0.4925, lr_0 = 9.6986e-04
Loss = 5.8119e-01, PNorm = 35.4181, GNorm = 1.8933, lr_0 = 9.5149e-04
Loss = 5.8130e-01, PNorm = 35.4739, GNorm = 1.1083, lr_0 = 9.3347e-04
Loss = 5.8721e-01, PNorm = 35.5319, GNorm = 0.7363, lr_0 = 9.1579e-04
Loss = 5.3794e-01, PNorm = 35.5389, GNorm = 0.6006, lr_0 = 9.1404e-04
Validation prc-auc = 0.718934
Validation auc = 0.772228
Validation accuracy = 0.681818
Validation f1 = 0.588235
Epoch 3
Loss = 5.6821e-01, PNorm = 35.6064, GNorm = 0.9720, lr_0 = 8.9672e-04
Loss = 5.5196e-01, PNorm = 35.6862, GNorm = 1.0867, lr_0 = 8.7974e-04
Loss = 5.7529e-01, PNorm = 35.7301, GNorm = 0.7481, lr_0 = 8.6307e-04
Loss = 5.6630e-01, PNorm = 35.7647, GNorm = 1.2787, lr_0 = 8.4672e-04
Validation prc-auc = 0.732309
Validation auc = 0.785123
Validation accuracy = 0.685950
Validation f1 = 0.568182
Epoch 4
Loss = 5.7516e-01, PNorm = 35.8156, GNorm = 0.6812, lr_0 = 8.3068e-04
Loss = 5.2995e-01, PNorm = 35.8719, GNorm = 0.3464, lr_0 = 8.1495e-04
Loss = 5.2916e-01, PNorm = 35.9217, GNorm = 0.4409, lr_0 = 7.9951e-04
Loss = 5.1442e-01, PNorm = 35.9716, GNorm = 0.6147, lr_0 = 7.8437e-04
Validation prc-auc = 0.750181
Validation auc = 0.802190
Validation accuracy = 0.727273
Validation f1 = 0.702703
Epoch 5
Loss = 5.1686e-01, PNorm = 36.0258, GNorm = 1.0202, lr_0 = 7.6804e-04
Loss = 5.1338e-01, PNorm = 36.0699, GNorm = 0.4902, lr_0 = 7.5349e-04
Loss = 5.3329e-01, PNorm = 36.1217, GNorm = 2.0180, lr_0 = 7.3921e-04
Loss = 5.1022e-01, PNorm = 36.1639, GNorm = 0.5174, lr_0 = 7.2521e-04
Loss = 5.2098e-01, PNorm = 36.2206, GNorm = 0.8797, lr_0 = 7.1147e-04
Validation prc-auc = 0.760465
Validation auc = 0.806639
Validation accuracy = 0.752066
Validation f1 = 0.732143
Epoch 6
Loss = 5.3775e-01, PNorm = 36.2868, GNorm = 0.8683, lr_0 = 6.9800e-04
Loss = 5.1166e-01, PNorm = 36.3378, GNorm = 0.8725, lr_0 = 6.8478e-04
Loss = 4.7129e-01, PNorm = 36.3873, GNorm = 0.4620, lr_0 = 6.7180e-04
Loss = 5.0636e-01, PNorm = 36.4362, GNorm = 0.6030, lr_0 = 6.5908e-04
Validation prc-auc = 0.774099
Validation auc = 0.816163
Validation accuracy = 0.760331
Validation f1 = 0.718447
Epoch 7
Loss = 5.0378e-01, PNorm = 36.4861, GNorm = 0.4353, lr_0 = 6.4536e-04
Loss = 4.6342e-01, PNorm = 36.5523, GNorm = 0.4055, lr_0 = 6.3313e-04
Loss = 5.1053e-01, PNorm = 36.6036, GNorm = 0.4495, lr_0 = 6.2114e-04
Loss = 5.0702e-01, PNorm = 36.6402, GNorm = 0.5003, lr_0 = 6.0937e-04
Validation prc-auc = 0.779575
Validation auc = 0.820716
Validation accuracy = 0.772727
Validation f1 = 0.748858
Epoch 8
Loss = 5.6863e-01, PNorm = 36.6986, GNorm = 0.9102, lr_0 = 5.9783e-04
Loss = 4.8900e-01, PNorm = 36.7478, GNorm = 0.4583, lr_0 = 5.8651e-04
Loss = 4.7583e-01, PNorm = 36.7873, GNorm = 0.3532, lr_0 = 5.7540e-04
Loss = 4.5242e-01, PNorm = 36.8295, GNorm = 0.5609, lr_0 = 5.6450e-04
Loss = 4.9309e-01, PNorm = 36.8773, GNorm = 0.5663, lr_0 = 5.5380e-04
Validation prc-auc = 0.793135
Validation auc = 0.830761
Validation accuracy = 0.768595
Validation f1 = 0.728155
Epoch 9
Loss = 4.6850e-01, PNorm = 36.9409, GNorm = 0.6238, lr_0 = 5.4227e-04
Loss = 4.6784e-01, PNorm = 36.9849, GNorm = 0.4328, lr_0 = 5.3200e-04
Loss = 4.5578e-01, PNorm = 37.0289, GNorm = 0.5106, lr_0 = 5.2192e-04
Loss = 4.6749e-01, PNorm = 37.0658, GNorm = 1.0869, lr_0 = 5.1204e-04
Validation prc-auc = 0.794321
Validation auc = 0.830309
Validation accuracy = 0.752066
Validation f1 = 0.693878
Epoch 10
Loss = 4.5376e-01, PNorm = 37.1034, GNorm = 0.9004, lr_0 = 5.0234e-04
Loss = 4.5347e-01, PNorm = 37.1445, GNorm = 1.3654, lr_0 = 4.9282e-04
Loss = 4.7939e-01, PNorm = 37.1868, GNorm = 0.4079, lr_0 = 4.8349e-04
Loss = 4.7414e-01, PNorm = 37.2194, GNorm = 0.3592, lr_0 = 4.7433e-04
Validation prc-auc = 0.788003
Validation auc = 0.824957
Validation accuracy = 0.760331
Validation f1 = 0.731481
Epoch 11
Loss = 4.0131e-01, PNorm = 37.2617, GNorm = 0.4839, lr_0 = 4.6445e-04
Loss = 4.3411e-01, PNorm = 37.3165, GNorm = 0.4835, lr_0 = 4.5566e-04
Loss = 4.4759e-01, PNorm = 37.3571, GNorm = 0.9144, lr_0 = 4.4703e-04
Loss = 4.5451e-01, PNorm = 37.3865, GNorm = 0.3934, lr_0 = 4.3856e-04
Loss = 4.5491e-01, PNorm = 37.4156, GNorm = 0.4205, lr_0 = 4.3025e-04
Validation prc-auc = 0.790338
Validation auc = 0.836149
Validation accuracy = 0.760331
Validation f1 = 0.715686
Epoch 12
Loss = 4.5213e-01, PNorm = 37.4479, GNorm = 0.7454, lr_0 = 4.2210e-04
Loss = 4.5746e-01, PNorm = 37.4867, GNorm = 1.4425, lr_0 = 4.1410e-04
Loss = 4.0702e-01, PNorm = 37.5274, GNorm = 1.0103, lr_0 = 4.0626e-04
Loss = 4.6928e-01, PNorm = 37.5674, GNorm = 0.5229, lr_0 = 3.9856e-04
Validation prc-auc = 0.791680
Validation auc = 0.830379
Validation accuracy = 0.760331
Validation f1 = 0.710000
Epoch 13
Loss = 4.4547e-01, PNorm = 37.5967, GNorm = 0.7674, lr_0 = 3.9101e-04
Loss = 4.2615e-01, PNorm = 37.6336, GNorm = 0.4734, lr_0 = 3.8361e-04
Loss = 4.5035e-01, PNorm = 37.6692, GNorm = 0.5572, lr_0 = 3.7634e-04
Loss = 4.2654e-01, PNorm = 37.7007, GNorm = 1.3505, lr_0 = 3.6921e-04
Validation prc-auc = 0.804592
Validation auc = 0.844491
Validation accuracy = 0.768595
Validation f1 = 0.720000
Epoch 14
Loss = 4.7677e-01, PNorm = 37.7317, GNorm = 1.4528, lr_0 = 3.6153e-04
Loss = 4.2427e-01, PNorm = 37.7636, GNorm = 0.4866, lr_0 = 3.5468e-04
Loss = 4.1482e-01, PNorm = 37.7971, GNorm = 0.5115, lr_0 = 3.4796e-04
Loss = 4.3318e-01, PNorm = 37.8292, GNorm = 0.5224, lr_0 = 3.4137e-04
Loss = 4.5396e-01, PNorm = 37.8510, GNorm = 0.4396, lr_0 = 3.3490e-04
Validation prc-auc = 0.794224
Validation auc = 0.835419
Validation accuracy = 0.760331
Validation f1 = 0.697917
Epoch 15
Loss = 4.4709e-01, PNorm = 37.8761, GNorm = 0.8786, lr_0 = 3.2856e-04
Loss = 4.1135e-01, PNorm = 37.9025, GNorm = 1.6394, lr_0 = 3.2233e-04
Loss = 4.5496e-01, PNorm = 37.9220, GNorm = 0.3893, lr_0 = 3.1623e-04
Loss = 4.1621e-01, PNorm = 37.9513, GNorm = 0.5605, lr_0 = 3.1024e-04
Validation prc-auc = 0.802560
Validation auc = 0.840876
Validation accuracy = 0.747934
Validation f1 = 0.677249
Epoch 16
Loss = 4.6601e-01, PNorm = 37.9901, GNorm = 0.7132, lr_0 = 3.0378e-04
Loss = 4.1549e-01, PNorm = 38.0173, GNorm = 0.5162, lr_0 = 2.9802e-04
Loss = 4.1099e-01, PNorm = 38.0515, GNorm = 0.7056, lr_0 = 2.9238e-04
Loss = 4.0395e-01, PNorm = 38.0797, GNorm = 0.7265, lr_0 = 2.8684e-04
Loss = 4.3100e-01, PNorm = 38.1015, GNorm = 0.7789, lr_0 = 2.8141e-04
Validation prc-auc = 0.804875
Validation auc = 0.843969
Validation accuracy = 0.764463
Validation f1 = 0.721951
Epoch 17
Loss = 3.8359e-01, PNorm = 38.1272, GNorm = 1.1586, lr_0 = 2.7608e-04
Loss = 4.0939e-01, PNorm = 38.1549, GNorm = 0.8843, lr_0 = 2.7085e-04
Loss = 4.0829e-01, PNorm = 38.1755, GNorm = 0.7849, lr_0 = 2.6572e-04
Loss = 4.5435e-01, PNorm = 38.1937, GNorm = 0.8846, lr_0 = 2.6068e-04
Validation prc-auc = 0.809752
Validation auc = 0.845951
Validation accuracy = 0.772727
Validation f1 = 0.734300
Epoch 18
Loss = 3.8511e-01, PNorm = 38.2181, GNorm = 0.9717, lr_0 = 2.5526e-04
Loss = 4.1657e-01, PNorm = 38.2385, GNorm = 1.2894, lr_0 = 2.5042e-04
Loss = 4.3973e-01, PNorm = 38.2576, GNorm = 0.7034, lr_0 = 2.4568e-04
Loss = 4.0181e-01, PNorm = 38.2822, GNorm = 0.4587, lr_0 = 2.4102e-04
Validation prc-auc = 0.811892
Validation auc = 0.847167
Validation accuracy = 0.760331
Validation f1 = 0.715686
Epoch 19
Loss = 3.8429e-01, PNorm = 38.3067, GNorm = 0.5057, lr_0 = 2.3646e-04
Loss = 4.0490e-01, PNorm = 38.3292, GNorm = 1.0165, lr_0 = 2.3198e-04
Loss = 4.0360e-01, PNorm = 38.3497, GNorm = 0.5542, lr_0 = 2.2758e-04
Loss = 4.0007e-01, PNorm = 38.3709, GNorm = 0.4186, lr_0 = 2.2327e-04
Loss = 3.9019e-01, PNorm = 38.3904, GNorm = 0.7712, lr_0 = 2.1904e-04
Loss = 3.5131e-01, PNorm = 38.3927, GNorm = 0.8273, lr_0 = 2.1863e-04
Validation prc-auc = 0.812393
Validation auc = 0.849739
Validation accuracy = 0.760331
Validation f1 = 0.743363
Epoch 20
Loss = 4.2484e-01, PNorm = 38.4128, GNorm = 0.6749, lr_0 = 2.1448e-04
Loss = 3.7542e-01, PNorm = 38.4350, GNorm = 0.7211, lr_0 = 2.1042e-04
Loss = 3.7771e-01, PNorm = 38.4578, GNorm = 0.7250, lr_0 = 2.0644e-04
Loss = 3.8770e-01, PNorm = 38.4770, GNorm = 0.8472, lr_0 = 2.0252e-04
Validation prc-auc = 0.812976
Validation auc = 0.849809
Validation accuracy = 0.764463
Validation f1 = 0.742081
Epoch 21
Loss = 3.6467e-01, PNorm = 38.4915, GNorm = 0.7234, lr_0 = 1.9869e-04
Loss = 3.8275e-01, PNorm = 38.5084, GNorm = 0.9035, lr_0 = 1.9492e-04
Loss = 4.2790e-01, PNorm = 38.5295, GNorm = 0.4804, lr_0 = 1.9123e-04
Loss = 4.1300e-01, PNorm = 38.5472, GNorm = 0.8494, lr_0 = 1.8761e-04
Validation prc-auc = 0.815845
Validation auc = 0.851164
Validation accuracy = 0.776860
Validation f1 = 0.742857
Epoch 22
Loss = 3.4047e-01, PNorm = 38.5649, GNorm = 0.5907, lr_0 = 1.8370e-04
Loss = 3.6663e-01, PNorm = 38.5788, GNorm = 0.4395, lr_0 = 1.8022e-04
Loss = 3.8430e-01, PNorm = 38.5937, GNorm = 0.6031, lr_0 = 1.7681e-04
Loss = 4.0831e-01, PNorm = 38.6113, GNorm = 0.6978, lr_0 = 1.7346e-04
Loss = 4.1151e-01, PNorm = 38.6282, GNorm = 0.9931, lr_0 = 1.7018e-04
Validation prc-auc = 0.807589
Validation auc = 0.842405
Validation accuracy = 0.760331
Validation f1 = 0.745614
Epoch 23
Loss = 3.8777e-01, PNorm = 38.6443, GNorm = 0.4480, lr_0 = 1.6695e-04
Loss = 4.0965e-01, PNorm = 38.6587, GNorm = 0.8345, lr_0 = 1.6379e-04
Loss = 3.9286e-01, PNorm = 38.6730, GNorm = 0.6508, lr_0 = 1.6069e-04
Loss = 3.9941e-01, PNorm = 38.6897, GNorm = 0.8183, lr_0 = 1.5764e-04
Validation prc-auc = 0.811210
Validation auc = 0.846333
Validation accuracy = 0.756198
Validation f1 = 0.725581
Epoch 24
Loss = 3.7577e-01, PNorm = 38.7095, GNorm = 0.7295, lr_0 = 1.5436e-04
Loss = 3.9759e-01, PNorm = 38.7258, GNorm = 0.7825, lr_0 = 1.5144e-04
Loss = 3.8079e-01, PNorm = 38.7385, GNorm = 2.2156, lr_0 = 1.4857e-04
Loss = 3.7299e-01, PNorm = 38.7484, GNorm = 1.1223, lr_0 = 1.4575e-04
Validation prc-auc = 0.816993
Validation auc = 0.852729
Validation accuracy = 0.768595
Validation f1 = 0.752212
Epoch 25
Loss = 3.8590e-01, PNorm = 38.7595, GNorm = 0.5602, lr_0 = 1.4299e-04
Loss = 3.7405e-01, PNorm = 38.7704, GNorm = 0.7054, lr_0 = 1.4028e-04
Loss = 3.7404e-01, PNorm = 38.7834, GNorm = 0.6987, lr_0 = 1.3763e-04
Loss = 3.4712e-01, PNorm = 38.7966, GNorm = 1.7385, lr_0 = 1.3502e-04
Loss = 4.3829e-01, PNorm = 38.8077, GNorm = 0.5643, lr_0 = 1.3246e-04
Validation prc-auc = 0.814776
Validation auc = 0.851095
Validation accuracy = 0.772727
Validation f1 = 0.748858
Epoch 26
Loss = 3.7436e-01, PNorm = 38.8210, GNorm = 0.6895, lr_0 = 1.2995e-04
Loss = 3.7420e-01, PNorm = 38.8330, GNorm = 0.6738, lr_0 = 1.2749e-04
Loss = 3.9791e-01, PNorm = 38.8441, GNorm = 0.7766, lr_0 = 1.2508e-04
Loss = 3.6173e-01, PNorm = 38.8561, GNorm = 0.6540, lr_0 = 1.2271e-04
Validation prc-auc = 0.816045
Validation auc = 0.848175
Validation accuracy = 0.760331
Validation f1 = 0.718447
Epoch 27
Loss = 3.4852e-01, PNorm = 38.8691, GNorm = 0.5120, lr_0 = 1.2015e-04
Loss = 3.5585e-01, PNorm = 38.8786, GNorm = 1.1700, lr_0 = 1.1788e-04
Loss = 3.9958e-01, PNorm = 38.8884, GNorm = 0.7771, lr_0 = 1.1564e-04
Loss = 3.6870e-01, PNorm = 38.8965, GNorm = 0.6870, lr_0 = 1.1345e-04
Validation prc-auc = 0.816634
Validation auc = 0.851269
Validation accuracy = 0.768595
Validation f1 = 0.722772
Epoch 28
Loss = 3.9097e-01, PNorm = 38.9076, GNorm = 0.9890, lr_0 = 1.1130e-04
Loss = 3.5947e-01, PNorm = 38.9195, GNorm = 0.7436, lr_0 = 1.0920e-04
Loss = 3.6378e-01, PNorm = 38.9300, GNorm = 0.5643, lr_0 = 1.0713e-04
Loss = 3.6506e-01, PNorm = 38.9400, GNorm = 0.4053, lr_0 = 1.0510e-04
Loss = 4.0129e-01, PNorm = 38.9479, GNorm = 0.8069, lr_0 = 1.0311e-04
Validation prc-auc = 0.819354
Validation auc = 0.853076
Validation accuracy = 0.764463
Validation f1 = 0.739726
Epoch 29
Loss = 3.5668e-01, PNorm = 38.9578, GNorm = 0.4575, lr_0 = 1.0096e-04
Loss = 3.9541e-01, PNorm = 38.9668, GNorm = 0.4992, lr_0 = 1.0000e-04
Loss = 3.5346e-01, PNorm = 38.9747, GNorm = 0.9239, lr_0 = 1.0000e-04
Loss = 3.7151e-01, PNorm = 38.9848, GNorm = 0.9607, lr_0 = 1.0000e-04
Validation prc-auc = 0.821478
Validation auc = 0.854640
Validation accuracy = 0.772727
Validation f1 = 0.734300
Model 0 best validation prc-auc = 0.821478 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.749780
Model 0 test auc = 0.841340
Model 0 test accuracy = 0.758725
Model 0 test f1 = 0.706100
Ensemble test prc-auc = 0.749780
Ensemble test auc = 0.841340
Ensemble test accuracy = 0.758725
Ensemble test f1 = 0.706100
Fold 3
Splitting data with seed 3
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Epoch 0
Loss = 7.0470e-01, PNorm = 35.0669, GNorm = 0.9241, lr_0 = 2.1512e-04
Loss = 6.6118e-01, PNorm = 35.0738, GNorm = 1.0764, lr_0 = 3.1977e-04
Loss = 6.5351e-01, PNorm = 35.0851, GNorm = 1.6821, lr_0 = 4.2442e-04
Loss = 6.6003e-01, PNorm = 35.0957, GNorm = 1.0000, lr_0 = 5.2907e-04
Validation prc-auc = 0.640567
Validation auc = 0.625851
Validation accuracy = 0.512397
Validation f1 = 0.404040
Epoch 1
Loss = 6.2578e-01, PNorm = 35.1168, GNorm = 0.9688, lr_0 = 6.4419e-04
Loss = 6.0119e-01, PNorm = 35.1497, GNorm = 0.4233, lr_0 = 7.4884e-04
Loss = 6.1878e-01, PNorm = 35.1877, GNorm = 1.4627, lr_0 = 8.5349e-04
Loss = 6.1019e-01, PNorm = 35.2330, GNorm = 0.8563, lr_0 = 9.5814e-04
Validation prc-auc = 0.667171
Validation auc = 0.670071
Validation accuracy = 0.557851
Validation f1 = 0.515837
Epoch 2
Loss = 5.6806e-01, PNorm = 35.2915, GNorm = 0.8074, lr_0 = 9.8859e-04
Loss = 5.7824e-01, PNorm = 35.3519, GNorm = 0.9925, lr_0 = 9.6986e-04
Loss = 6.0178e-01, PNorm = 35.4007, GNorm = 1.2073, lr_0 = 9.5149e-04
Loss = 5.6967e-01, PNorm = 35.4618, GNorm = 0.8025, lr_0 = 9.3347e-04
Loss = 5.7065e-01, PNorm = 35.5240, GNorm = 0.7126, lr_0 = 9.1579e-04
Loss = 4.9436e-01, PNorm = 35.5320, GNorm = 0.5286, lr_0 = 9.1404e-04
Validation prc-auc = 0.697872
Validation auc = 0.708273
Validation accuracy = 0.665289
Validation f1 = 0.727273
Epoch 3
Loss = 5.3549e-01, PNorm = 35.6104, GNorm = 0.9391, lr_0 = 8.9672e-04
Loss = 5.6460e-01, PNorm = 35.6626, GNorm = 0.5944, lr_0 = 8.7974e-04
Loss = 5.3894e-01, PNorm = 35.7123, GNorm = 0.4097, lr_0 = 8.6307e-04
Loss = 5.5485e-01, PNorm = 35.7662, GNorm = 0.4611, lr_0 = 8.4672e-04
Validation prc-auc = 0.714344
Validation auc = 0.719001
Validation accuracy = 0.623967
Validation f1 = 0.580645
Epoch 4
Loss = 5.4892e-01, PNorm = 35.7957, GNorm = 0.9081, lr_0 = 8.3068e-04
Loss = 5.1902e-01, PNorm = 35.8445, GNorm = 1.3024, lr_0 = 8.1495e-04
Loss = 5.1736e-01, PNorm = 35.8963, GNorm = 0.3882, lr_0 = 7.9951e-04
Loss = 5.4544e-01, PNorm = 35.9494, GNorm = 0.3545, lr_0 = 7.8437e-04
Validation prc-auc = 0.735634
Validation auc = 0.737191
Validation accuracy = 0.615702
Validation f1 = 0.571429
Epoch 5
Loss = 5.1352e-01, PNorm = 35.9873, GNorm = 0.4603, lr_0 = 7.6804e-04
Loss = 5.2265e-01, PNorm = 36.0338, GNorm = 0.3584, lr_0 = 7.5349e-04
Loss = 5.2390e-01, PNorm = 36.0822, GNorm = 0.3856, lr_0 = 7.3921e-04
Loss = 5.0078e-01, PNorm = 36.1327, GNorm = 0.5506, lr_0 = 7.2521e-04
Loss = 5.1238e-01, PNorm = 36.1661, GNorm = 0.8275, lr_0 = 7.1147e-04
Validation prc-auc = 0.741724
Validation auc = 0.753834
Validation accuracy = 0.665289
Validation f1 = 0.666667
Epoch 6
Loss = 4.9672e-01, PNorm = 36.2167, GNorm = 0.4137, lr_0 = 6.9800e-04
Loss = 4.7589e-01, PNorm = 36.2678, GNorm = 0.5973, lr_0 = 6.8478e-04
Loss = 4.9200e-01, PNorm = 36.3204, GNorm = 0.6972, lr_0 = 6.7180e-04
Loss = 5.3886e-01, PNorm = 36.3612, GNorm = 0.5664, lr_0 = 6.5908e-04
Validation prc-auc = 0.741828
Validation auc = 0.761021
Validation accuracy = 0.719008
Validation f1 = 0.762238
Epoch 7
Loss = 5.1167e-01, PNorm = 36.4282, GNorm = 0.5506, lr_0 = 6.4536e-04
Loss = 4.7145e-01, PNorm = 36.4625, GNorm = 0.4784, lr_0 = 6.3313e-04
Loss = 4.6454e-01, PNorm = 36.5160, GNorm = 0.5462, lr_0 = 6.2114e-04
Loss = 5.0676e-01, PNorm = 36.5629, GNorm = 1.1523, lr_0 = 6.0937e-04
Validation prc-auc = 0.746669
Validation auc = 0.762052
Validation accuracy = 0.636364
Validation f1 = 0.596330
Epoch 8
Loss = 5.4385e-01, PNorm = 36.6013, GNorm = 1.0000, lr_0 = 5.9783e-04
Loss = 4.8023e-01, PNorm = 36.6630, GNorm = 1.0230, lr_0 = 5.8651e-04
Loss = 4.6925e-01, PNorm = 36.7153, GNorm = 0.3606, lr_0 = 5.7540e-04
Loss = 4.6532e-01, PNorm = 36.7674, GNorm = 0.6723, lr_0 = 5.6450e-04
Loss = 4.7554e-01, PNorm = 36.8025, GNorm = 0.8953, lr_0 = 5.5380e-04
Validation prc-auc = 0.750783
Validation auc = 0.772505
Validation accuracy = 0.714876
Validation f1 = 0.757895
Epoch 9
Loss = 4.8197e-01, PNorm = 36.8346, GNorm = 0.7097, lr_0 = 5.4227e-04
Loss = 4.5324e-01, PNorm = 36.8751, GNorm = 0.5218, lr_0 = 5.3200e-04
Loss = 4.4709e-01, PNorm = 36.9231, GNorm = 0.6357, lr_0 = 5.2192e-04
Loss = 4.9407e-01, PNorm = 36.9617, GNorm = 1.0078, lr_0 = 5.1204e-04
Validation prc-auc = 0.756286
Validation auc = 0.782305
Validation accuracy = 0.731405
Validation f1 = 0.773519
Epoch 10
Loss = 4.7170e-01, PNorm = 36.9974, GNorm = 0.7961, lr_0 = 5.0234e-04
Loss = 4.2789e-01, PNorm = 37.0407, GNorm = 0.9028, lr_0 = 4.9282e-04
Loss = 4.5658e-01, PNorm = 37.0870, GNorm = 0.6260, lr_0 = 4.8349e-04
Loss = 4.8106e-01, PNorm = 37.1255, GNorm = 0.7356, lr_0 = 4.7433e-04
Validation prc-auc = 0.763422
Validation auc = 0.784506
Validation accuracy = 0.731405
Validation f1 = 0.758364
Epoch 11
Loss = 4.0037e-01, PNorm = 37.1491, GNorm = 0.8028, lr_0 = 4.6445e-04
Loss = 4.2728e-01, PNorm = 37.1818, GNorm = 0.5050, lr_0 = 4.5566e-04
Loss = 4.6242e-01, PNorm = 37.2209, GNorm = 0.5579, lr_0 = 4.4703e-04
Loss = 4.6797e-01, PNorm = 37.2547, GNorm = 0.6257, lr_0 = 4.3856e-04
Loss = 4.3915e-01, PNorm = 37.2802, GNorm = 0.5613, lr_0 = 4.3025e-04
Validation prc-auc = 0.766655
Validation auc = 0.784747
Validation accuracy = 0.727273
Validation f1 = 0.753731
Epoch 12
Loss = 4.4297e-01, PNorm = 37.3094, GNorm = 0.3470, lr_0 = 4.2210e-04
Loss = 4.1233e-01, PNorm = 37.3486, GNorm = 0.8798, lr_0 = 4.1410e-04
Loss = 4.5130e-01, PNorm = 37.3922, GNorm = 0.9907, lr_0 = 4.0626e-04
Loss = 4.3092e-01, PNorm = 37.4260, GNorm = 0.4238, lr_0 = 3.9856e-04
Validation prc-auc = 0.768541
Validation auc = 0.790111
Validation accuracy = 0.752066
Validation f1 = 0.779412
Epoch 13
Loss = 4.3794e-01, PNorm = 37.4509, GNorm = 1.0298, lr_0 = 3.9101e-04
Loss = 4.0910e-01, PNorm = 37.4820, GNorm = 1.3487, lr_0 = 3.8361e-04
Loss = 4.1689e-01, PNorm = 37.5148, GNorm = 0.5829, lr_0 = 3.7634e-04
Loss = 4.3618e-01, PNorm = 37.5498, GNorm = 0.6052, lr_0 = 3.6921e-04
Validation prc-auc = 0.776460
Validation auc = 0.799842
Validation accuracy = 0.735537
Validation f1 = 0.750000
Epoch 14
Loss = 4.1614e-01, PNorm = 37.5788, GNorm = 0.5687, lr_0 = 3.6153e-04
Loss = 4.0391e-01, PNorm = 37.6076, GNorm = 0.5179, lr_0 = 3.5468e-04
Loss = 4.4592e-01, PNorm = 37.6366, GNorm = 0.4992, lr_0 = 3.4796e-04
Loss = 4.1231e-01, PNorm = 37.6615, GNorm = 0.7831, lr_0 = 3.4137e-04
Loss = 4.4824e-01, PNorm = 37.6891, GNorm = 0.5910, lr_0 = 3.3490e-04
Validation prc-auc = 0.777261
Validation auc = 0.795337
Validation accuracy = 0.739669
Validation f1 = 0.762264
Epoch 15
Loss = 4.0173e-01, PNorm = 37.7187, GNorm = 0.9312, lr_0 = 3.2856e-04
Loss = 4.1606e-01, PNorm = 37.7547, GNorm = 0.6510, lr_0 = 3.2233e-04
Loss = 4.4070e-01, PNorm = 37.7820, GNorm = 0.8750, lr_0 = 3.1623e-04
Loss = 4.6252e-01, PNorm = 37.8055, GNorm = 0.6350, lr_0 = 3.1024e-04
Validation prc-auc = 0.781073
Validation auc = 0.798810
Validation accuracy = 0.764463
Validation f1 = 0.795699
Epoch 16
Loss = 3.5022e-01, PNorm = 37.8344, GNorm = 0.8567, lr_0 = 3.0378e-04
Loss = 4.0432e-01, PNorm = 37.8674, GNorm = 0.6419, lr_0 = 2.9802e-04
Loss = 4.1100e-01, PNorm = 37.8997, GNorm = 1.0282, lr_0 = 2.9238e-04
Loss = 4.3280e-01, PNorm = 37.9201, GNorm = 0.8567, lr_0 = 2.8684e-04
Loss = 4.5405e-01, PNorm = 37.9361, GNorm = 0.8605, lr_0 = 2.8141e-04
Validation prc-auc = 0.785082
Validation auc = 0.796128
Validation accuracy = 0.719008
Validation f1 = 0.728000
Epoch 17
Loss = 4.2629e-01, PNorm = 37.9558, GNorm = 0.5704, lr_0 = 2.7608e-04
Loss = 4.1488e-01, PNorm = 37.9844, GNorm = 0.6569, lr_0 = 2.7085e-04
Loss = 4.1408e-01, PNorm = 38.0056, GNorm = 0.4294, lr_0 = 2.6572e-04
Loss = 3.9893e-01, PNorm = 38.0280, GNorm = 0.7002, lr_0 = 2.6068e-04
Validation prc-auc = 0.792189
Validation auc = 0.802696
Validation accuracy = 0.743802
Validation f1 = 0.755906
Epoch 18
Loss = 4.0829e-01, PNorm = 38.0520, GNorm = 0.4766, lr_0 = 2.5526e-04
Loss = 4.0838e-01, PNorm = 38.0743, GNorm = 1.0024, lr_0 = 2.5042e-04
Loss = 3.9797e-01, PNorm = 38.0943, GNorm = 1.7819, lr_0 = 2.4568e-04
Loss = 4.0794e-01, PNorm = 38.1197, GNorm = 0.5323, lr_0 = 2.4102e-04
Validation prc-auc = 0.793905
Validation auc = 0.809882
Validation accuracy = 0.739669
Validation f1 = 0.764045
Epoch 19
Loss = 3.5907e-01, PNorm = 38.1390, GNorm = 0.9405, lr_0 = 2.3646e-04
Loss = 4.0757e-01, PNorm = 38.1587, GNorm = 1.0786, lr_0 = 2.3198e-04
Loss = 4.3846e-01, PNorm = 38.1765, GNorm = 0.6201, lr_0 = 2.2758e-04
Loss = 3.6864e-01, PNorm = 38.1974, GNorm = 0.5184, lr_0 = 2.2327e-04
Loss = 3.9272e-01, PNorm = 38.2210, GNorm = 0.8143, lr_0 = 2.1904e-04
Loss = 5.3645e-01, PNorm = 38.2228, GNorm = 1.0919, lr_0 = 2.1863e-04
Validation prc-auc = 0.786395
Validation auc = 0.811327
Validation accuracy = 0.743802
Validation f1 = 0.755906
Epoch 20
Loss = 3.9490e-01, PNorm = 38.2415, GNorm = 0.7679, lr_0 = 2.1448e-04
Loss = 3.9141e-01, PNorm = 38.2597, GNorm = 0.4554, lr_0 = 2.1042e-04
Loss = 4.0097e-01, PNorm = 38.2772, GNorm = 0.5105, lr_0 = 2.0644e-04
Loss = 3.8967e-01, PNorm = 38.2943, GNorm = 0.7777, lr_0 = 2.0252e-04
Validation prc-auc = 0.796995
Validation auc = 0.815212
Validation accuracy = 0.735537
Validation f1 = 0.761194
Epoch 21
Loss = 3.8727e-01, PNorm = 38.3147, GNorm = 0.6301, lr_0 = 1.9869e-04
Loss = 3.7511e-01, PNorm = 38.3337, GNorm = 0.7011, lr_0 = 1.9492e-04
Loss = 3.9997e-01, PNorm = 38.3487, GNorm = 0.4203, lr_0 = 1.9123e-04
Loss = 3.8551e-01, PNorm = 38.3622, GNorm = 0.5260, lr_0 = 1.8761e-04
Validation prc-auc = 0.793414
Validation auc = 0.807166
Validation accuracy = 0.752066
Validation f1 = 0.774436
Epoch 22
Loss = 3.4886e-01, PNorm = 38.3786, GNorm = 0.4853, lr_0 = 1.8370e-04
Loss = 3.8555e-01, PNorm = 38.3960, GNorm = 0.6229, lr_0 = 1.8022e-04
Loss = 3.8641e-01, PNorm = 38.4126, GNorm = 0.6444, lr_0 = 1.7681e-04
Loss = 4.1150e-01, PNorm = 38.4264, GNorm = 0.6190, lr_0 = 1.7346e-04
Loss = 3.9187e-01, PNorm = 38.4414, GNorm = 0.8714, lr_0 = 1.7018e-04
Validation prc-auc = 0.795131
Validation auc = 0.810364
Validation accuracy = 0.735537
Validation f1 = 0.739837
Epoch 23
Loss = 3.8196e-01, PNorm = 38.4565, GNorm = 0.7071, lr_0 = 1.6695e-04
Loss = 3.6567e-01, PNorm = 38.4715, GNorm = 0.4888, lr_0 = 1.6379e-04
Loss = 3.9710e-01, PNorm = 38.4874, GNorm = 0.8014, lr_0 = 1.6069e-04
Loss = 4.0306e-01, PNorm = 38.5004, GNorm = 0.9226, lr_0 = 1.5764e-04
Validation prc-auc = 0.797309
Validation auc = 0.814318
Validation accuracy = 0.752066
Validation f1 = 0.763780
Epoch 24
Loss = 3.6329e-01, PNorm = 38.5131, GNorm = 0.9653, lr_0 = 1.5436e-04
Loss = 3.7943e-01, PNorm = 38.5275, GNorm = 0.8717, lr_0 = 1.5144e-04
Loss = 3.8541e-01, PNorm = 38.5407, GNorm = 0.9249, lr_0 = 1.4857e-04
Loss = 4.0603e-01, PNorm = 38.5550, GNorm = 0.7264, lr_0 = 1.4575e-04
Validation prc-auc = 0.804355
Validation auc = 0.821677
Validation accuracy = 0.747934
Validation f1 = 0.762646
Epoch 25
Loss = 4.0912e-01, PNorm = 38.5653, GNorm = 0.8771, lr_0 = 1.4299e-04
Loss = 3.6820e-01, PNorm = 38.5776, GNorm = 0.4764, lr_0 = 1.4028e-04
Loss = 3.8581e-01, PNorm = 38.5903, GNorm = 0.6302, lr_0 = 1.3763e-04
Loss = 3.7571e-01, PNorm = 38.6044, GNorm = 0.8035, lr_0 = 1.3502e-04
Loss = 3.6948e-01, PNorm = 38.6146, GNorm = 0.7612, lr_0 = 1.3246e-04
Validation prc-auc = 0.801080
Validation auc = 0.812771
Validation accuracy = 0.743802
Validation f1 = 0.757813
Epoch 26
Loss = 3.6644e-01, PNorm = 38.6248, GNorm = 0.6358, lr_0 = 1.2995e-04
Loss = 3.7976e-01, PNorm = 38.6372, GNorm = 0.5851, lr_0 = 1.2749e-04
Loss = 3.7659e-01, PNorm = 38.6480, GNorm = 0.6052, lr_0 = 1.2508e-04
Loss = 3.6861e-01, PNorm = 38.6588, GNorm = 0.8073, lr_0 = 1.2271e-04
Validation prc-auc = 0.804201
Validation auc = 0.814937
Validation accuracy = 0.743802
Validation f1 = 0.757813
Epoch 27
Loss = 3.4613e-01, PNorm = 38.6689, GNorm = 0.5487, lr_0 = 1.2015e-04
Loss = 3.8129e-01, PNorm = 38.6794, GNorm = 0.9367, lr_0 = 1.1788e-04
Loss = 3.7616e-01, PNorm = 38.6887, GNorm = 0.8248, lr_0 = 1.1564e-04
Loss = 3.6518e-01, PNorm = 38.7001, GNorm = 0.5735, lr_0 = 1.1345e-04
Validation prc-auc = 0.806305
Validation auc = 0.816106
Validation accuracy = 0.739669
Validation f1 = 0.746988
Epoch 28
Loss = 2.5372e-01, PNorm = 38.7108, GNorm = 0.5277, lr_0 = 1.1130e-04
Loss = 3.5088e-01, PNorm = 38.7206, GNorm = 0.8434, lr_0 = 1.0920e-04
Loss = 3.8353e-01, PNorm = 38.7302, GNorm = 0.9743, lr_0 = 1.0713e-04
Loss = 3.7649e-01, PNorm = 38.7383, GNorm = 0.7358, lr_0 = 1.0510e-04
Loss = 3.8902e-01, PNorm = 38.7462, GNorm = 0.8136, lr_0 = 1.0311e-04
Validation prc-auc = 0.808954
Validation auc = 0.818719
Validation accuracy = 0.743802
Validation f1 = 0.755906
Epoch 29
Loss = 3.5107e-01, PNorm = 38.7564, GNorm = 0.7499, lr_0 = 1.0096e-04
Loss = 3.7929e-01, PNorm = 38.7652, GNorm = 0.9006, lr_0 = 1.0000e-04
Loss = 3.4864e-01, PNorm = 38.7754, GNorm = 0.6544, lr_0 = 1.0000e-04
Loss = 3.6842e-01, PNorm = 38.7851, GNorm = 0.8695, lr_0 = 1.0000e-04
Validation prc-auc = 0.807595
Validation auc = 0.824393
Validation accuracy = 0.747934
Validation f1 = 0.776557
Model 0 best validation prc-auc = 0.808954 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.745357
Model 0 test auc = 0.836269
Model 0 test accuracy = 0.758725
Model 0 test f1 = 0.708257
Ensemble test prc-auc = 0.745357
Ensemble test auc = 0.836269
Ensemble test accuracy = 0.758725
Ensemble test f1 = 0.708257
Fold 4
Splitting data with seed 4
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Epoch 0
Loss = 6.9796e-01, PNorm = 35.0673, GNorm = 0.5984, lr_0 = 2.1512e-04
Loss = 6.6300e-01, PNorm = 35.0745, GNorm = 1.4180, lr_0 = 3.1977e-04
Loss = 6.7299e-01, PNorm = 35.0851, GNorm = 0.8760, lr_0 = 4.2442e-04
Loss = 6.2638e-01, PNorm = 35.1048, GNorm = 1.1153, lr_0 = 5.2907e-04
Validation prc-auc = 0.652723
Validation auc = 0.690106
Validation accuracy = 0.595041
Validation f1 = 0.484211
Epoch 1
Loss = 6.0264e-01, PNorm = 35.1304, GNorm = 0.7007, lr_0 = 6.4419e-04
Loss = 6.3472e-01, PNorm = 35.1633, GNorm = 0.5071, lr_0 = 7.4884e-04
Loss = 6.4300e-01, PNorm = 35.2020, GNorm = 0.7515, lr_0 = 8.5349e-04
Loss = 5.7829e-01, PNorm = 35.2544, GNorm = 1.1137, lr_0 = 9.5814e-04
Validation prc-auc = 0.689145
Validation auc = 0.740397
Validation accuracy = 0.636364
Validation f1 = 0.572816
Epoch 2
Loss = 6.0558e-01, PNorm = 35.3145, GNorm = 1.1321, lr_0 = 9.8859e-04
Loss = 5.6935e-01, PNorm = 35.3821, GNorm = 0.5198, lr_0 = 9.6986e-04
Loss = 5.6751e-01, PNorm = 35.4503, GNorm = 0.6700, lr_0 = 9.5149e-04
Loss = 5.3852e-01, PNorm = 35.5162, GNorm = 0.6555, lr_0 = 9.3347e-04
Loss = 5.8557e-01, PNorm = 35.5753, GNorm = 1.1446, lr_0 = 9.1579e-04
Loss = 5.0501e-01, PNorm = 35.5803, GNorm = 0.6834, lr_0 = 9.1404e-04
Validation prc-auc = 0.715659
Validation auc = 0.769463
Validation accuracy = 0.681818
Validation f1 = 0.641860
Epoch 3
Loss = 5.2994e-01, PNorm = 35.6522, GNorm = 0.7455, lr_0 = 8.9672e-04
Loss = 5.5069e-01, PNorm = 35.7243, GNorm = 0.6566, lr_0 = 8.7974e-04
Loss = 5.6079e-01, PNorm = 35.7710, GNorm = 1.0357, lr_0 = 8.6307e-04
Loss = 5.4825e-01, PNorm = 35.8068, GNorm = 0.5748, lr_0 = 8.4672e-04
Validation prc-auc = 0.744538
Validation auc = 0.775419
Validation accuracy = 0.661157
Validation f1 = 0.577320
Epoch 4
Loss = 5.6062e-01, PNorm = 35.8423, GNorm = 0.3478, lr_0 = 8.3068e-04
Loss = 5.4870e-01, PNorm = 35.8878, GNorm = 0.6710, lr_0 = 8.1495e-04
Loss = 5.2878e-01, PNorm = 35.9426, GNorm = 0.6157, lr_0 = 7.9951e-04
Loss = 5.5181e-01, PNorm = 35.9928, GNorm = 0.3410, lr_0 = 7.8437e-04
Validation prc-auc = 0.736864
Validation auc = 0.773160
Validation accuracy = 0.685950
Validation f1 = 0.654545
Epoch 5
Loss = 4.8933e-01, PNorm = 36.0482, GNorm = 0.6866, lr_0 = 7.6804e-04
Loss = 5.2836e-01, PNorm = 36.0933, GNorm = 0.4829, lr_0 = 7.5349e-04
Loss = 5.0781e-01, PNorm = 36.1426, GNorm = 0.8701, lr_0 = 7.3921e-04
Loss = 4.9640e-01, PNorm = 36.1968, GNorm = 0.3705, lr_0 = 7.2521e-04
Loss = 5.2381e-01, PNorm = 36.2357, GNorm = 0.3731, lr_0 = 7.1147e-04
Validation prc-auc = 0.747251
Validation auc = 0.780589
Validation accuracy = 0.702479
Validation f1 = 0.709677
Epoch 6
Loss = 5.0661e-01, PNorm = 36.2945, GNorm = 0.5263, lr_0 = 6.9800e-04
Loss = 4.6650e-01, PNorm = 36.3541, GNorm = 0.8267, lr_0 = 6.8478e-04
Loss = 5.2511e-01, PNorm = 36.3887, GNorm = 2.1287, lr_0 = 6.7180e-04
Loss = 5.2895e-01, PNorm = 36.4133, GNorm = 0.8566, lr_0 = 6.5908e-04
Validation prc-auc = 0.761325
Validation auc = 0.791510
Validation accuracy = 0.723140
Validation f1 = 0.721992
Epoch 7
Loss = 5.0948e-01, PNorm = 36.4561, GNorm = 0.5415, lr_0 = 6.4536e-04
Loss = 5.1764e-01, PNorm = 36.5106, GNorm = 0.6173, lr_0 = 6.3313e-04
Loss = 4.7721e-01, PNorm = 36.5620, GNorm = 0.5672, lr_0 = 6.2114e-04
Loss = 4.9785e-01, PNorm = 36.5899, GNorm = 0.7106, lr_0 = 6.0937e-04
Validation prc-auc = 0.757297
Validation auc = 0.787504
Validation accuracy = 0.706612
Validation f1 = 0.710204
Epoch 8
Loss = 4.8893e-01, PNorm = 36.6282, GNorm = 0.4896, lr_0 = 5.9783e-04
Loss = 4.6587e-01, PNorm = 36.6808, GNorm = 0.4847, lr_0 = 5.8651e-04
Loss = 4.8101e-01, PNorm = 36.7160, GNorm = 0.7128, lr_0 = 5.7540e-04
Loss = 4.9402e-01, PNorm = 36.7427, GNorm = 0.5356, lr_0 = 5.6450e-04
Loss = 4.6474e-01, PNorm = 36.7812, GNorm = 0.9841, lr_0 = 5.5380e-04
Validation prc-auc = 0.768019
Validation auc = 0.801609
Validation accuracy = 0.735537
Validation f1 = 0.751938
Epoch 9
Loss = 4.9054e-01, PNorm = 36.8234, GNorm = 0.9939, lr_0 = 5.4227e-04
Loss = 4.7742e-01, PNorm = 36.8627, GNorm = 1.5211, lr_0 = 5.3200e-04
Loss = 4.7933e-01, PNorm = 36.9074, GNorm = 0.7561, lr_0 = 5.2192e-04
Loss = 4.7479e-01, PNorm = 36.9405, GNorm = 0.5618, lr_0 = 5.1204e-04
Validation prc-auc = 0.777903
Validation auc = 0.800103
Validation accuracy = 0.698347
Validation f1 = 0.686695
Epoch 10
Loss = 4.3209e-01, PNorm = 36.9808, GNorm = 2.4859, lr_0 = 5.0234e-04
Loss = 4.7533e-01, PNorm = 37.0222, GNorm = 0.3927, lr_0 = 4.9282e-04
Loss = 4.4813e-01, PNorm = 37.0600, GNorm = 0.4328, lr_0 = 4.8349e-04
Loss = 4.8111e-01, PNorm = 37.1023, GNorm = 0.5051, lr_0 = 4.7433e-04
Validation prc-auc = 0.782359
Validation auc = 0.805751
Validation accuracy = 0.719008
Validation f1 = 0.693694
Epoch 11
Loss = 4.2936e-01, PNorm = 37.1307, GNorm = 0.4559, lr_0 = 4.6445e-04
Loss = 4.7799e-01, PNorm = 37.1662, GNorm = 1.2723, lr_0 = 4.5566e-04
Loss = 4.4403e-01, PNorm = 37.2090, GNorm = 0.7409, lr_0 = 4.4703e-04
Loss = 4.3599e-01, PNorm = 37.2445, GNorm = 0.5494, lr_0 = 4.3856e-04
Loss = 4.5150e-01, PNorm = 37.2713, GNorm = 0.6630, lr_0 = 4.3025e-04
Validation prc-auc = 0.767055
Validation auc = 0.796166
Validation accuracy = 0.719008
Validation f1 = 0.721311
Epoch 12
Loss = 4.8048e-01, PNorm = 37.2989, GNorm = 0.6948, lr_0 = 4.2210e-04
Loss = 4.5532e-01, PNorm = 37.3353, GNorm = 0.5172, lr_0 = 4.1410e-04
Loss = 4.4412e-01, PNorm = 37.3621, GNorm = 0.5459, lr_0 = 4.0626e-04
Loss = 4.2550e-01, PNorm = 37.3904, GNorm = 0.4116, lr_0 = 3.9856e-04
Validation prc-auc = 0.788143
Validation auc = 0.810236
Validation accuracy = 0.731405
Validation f1 = 0.730290
Epoch 13
Loss = 4.3390e-01, PNorm = 37.4235, GNorm = 1.1992, lr_0 = 3.9101e-04
Loss = 4.1950e-01, PNorm = 37.4578, GNorm = 1.0355, lr_0 = 3.8361e-04
Loss = 4.5062e-01, PNorm = 37.4797, GNorm = 0.5710, lr_0 = 3.7634e-04
Loss = 4.6523e-01, PNorm = 37.5079, GNorm = 0.5690, lr_0 = 3.6921e-04
Validation prc-auc = 0.795531
Validation auc = 0.815577
Validation accuracy = 0.735537
Validation f1 = 0.728814
Epoch 14
Loss = 4.1193e-01, PNorm = 37.5403, GNorm = 0.5211, lr_0 = 3.6153e-04
Loss = 4.2809e-01, PNorm = 37.5678, GNorm = 0.5262, lr_0 = 3.5468e-04
Loss = 4.2884e-01, PNorm = 37.5902, GNorm = 0.6368, lr_0 = 3.4796e-04
Loss = 4.3207e-01, PNorm = 37.6191, GNorm = 1.3725, lr_0 = 3.4137e-04
Loss = 4.2456e-01, PNorm = 37.6489, GNorm = 0.5035, lr_0 = 3.3490e-04
Validation prc-auc = 0.808863
Validation auc = 0.821910
Validation accuracy = 0.719008
Validation f1 = 0.701754
Epoch 15
Loss = 4.3349e-01, PNorm = 37.6686, GNorm = 0.7874, lr_0 = 3.2856e-04
Loss = 4.3937e-01, PNorm = 37.6894, GNorm = 0.9464, lr_0 = 3.2233e-04
Loss = 4.2162e-01, PNorm = 37.7168, GNorm = 0.6299, lr_0 = 3.1623e-04
Loss = 4.1410e-01, PNorm = 37.7413, GNorm = 0.4380, lr_0 = 3.1024e-04
Validation prc-auc = 0.808703
Validation auc = 0.827525
Validation accuracy = 0.743802
Validation f1 = 0.735043
Epoch 16
Loss = 4.2566e-01, PNorm = 37.7663, GNorm = 0.7111, lr_0 = 3.0378e-04
Loss = 4.2508e-01, PNorm = 37.7873, GNorm = 0.5451, lr_0 = 2.9802e-04
Loss = 3.9821e-01, PNorm = 37.8132, GNorm = 0.5063, lr_0 = 2.9238e-04
Loss = 4.3721e-01, PNorm = 37.8418, GNorm = 0.6700, lr_0 = 2.8684e-04
Loss = 4.1164e-01, PNorm = 37.8672, GNorm = 0.7360, lr_0 = 2.8141e-04
Validation prc-auc = 0.799092
Validation auc = 0.826464
Validation accuracy = 0.743802
Validation f1 = 0.718182
Epoch 17
Loss = 4.3085e-01, PNorm = 37.8922, GNorm = 0.8650, lr_0 = 2.7608e-04
Loss = 4.2140e-01, PNorm = 37.9116, GNorm = 0.5655, lr_0 = 2.7085e-04
Loss = 3.9148e-01, PNorm = 37.9366, GNorm = 1.2913, lr_0 = 2.6572e-04
Loss = 4.1912e-01, PNorm = 37.9559, GNorm = 0.8681, lr_0 = 2.6068e-04
Validation prc-auc = 0.807336
Validation auc = 0.823964
Validation accuracy = 0.731405
Validation f1 = 0.730290
Epoch 18
Loss = 4.4000e-01, PNorm = 37.9767, GNorm = 0.5536, lr_0 = 2.5526e-04
Loss = 4.0663e-01, PNorm = 37.9958, GNorm = 1.2309, lr_0 = 2.5042e-04
Loss = 3.8223e-01, PNorm = 38.0122, GNorm = 0.5382, lr_0 = 2.4568e-04
Loss = 4.0356e-01, PNorm = 38.0293, GNorm = 0.8010, lr_0 = 2.4102e-04
Validation prc-auc = 0.791780
Validation auc = 0.813797
Validation accuracy = 0.714876
Validation f1 = 0.698690
Epoch 19
Loss = 3.9343e-01, PNorm = 38.0498, GNorm = 0.6484, lr_0 = 2.3646e-04
Loss = 3.7934e-01, PNorm = 38.0724, GNorm = 0.8866, lr_0 = 2.3198e-04
Loss = 4.1538e-01, PNorm = 38.0917, GNorm = 1.0170, lr_0 = 2.2758e-04
Loss = 3.9528e-01, PNorm = 38.1118, GNorm = 0.9325, lr_0 = 2.2327e-04
Loss = 4.3348e-01, PNorm = 38.1298, GNorm = 0.8272, lr_0 = 2.1904e-04
Loss = 4.3305e-01, PNorm = 38.1312, GNorm = 0.7266, lr_0 = 2.1863e-04
Validation prc-auc = 0.808931
Validation auc = 0.824820
Validation accuracy = 0.727273
Validation f1 = 0.717949
Epoch 20
Loss = 3.9808e-01, PNorm = 38.1470, GNorm = 1.3803, lr_0 = 2.1448e-04
Loss = 4.1591e-01, PNorm = 38.1628, GNorm = 1.1385, lr_0 = 2.1042e-04
Loss = 3.9244e-01, PNorm = 38.1791, GNorm = 0.8401, lr_0 = 2.0644e-04
Loss = 3.9808e-01, PNorm = 38.1935, GNorm = 0.4525, lr_0 = 2.0252e-04
Validation prc-auc = 0.806654
Validation auc = 0.824855
Validation accuracy = 0.735537
Validation f1 = 0.731092
Epoch 21
Loss = 4.0621e-01, PNorm = 38.2108, GNorm = 0.5414, lr_0 = 1.9869e-04
Loss = 3.9704e-01, PNorm = 38.2322, GNorm = 0.9047, lr_0 = 1.9492e-04
Loss = 3.8949e-01, PNorm = 38.2495, GNorm = 0.6106, lr_0 = 1.9123e-04
Loss = 4.3162e-01, PNorm = 38.2623, GNorm = 0.8086, lr_0 = 1.8761e-04
Validation prc-auc = 0.807020
Validation auc = 0.831565
Validation accuracy = 0.747934
Validation f1 = 0.758893
Epoch 22
Loss = 3.7620e-01, PNorm = 38.2753, GNorm = 0.8333, lr_0 = 1.8370e-04
Loss = 3.8706e-01, PNorm = 38.2898, GNorm = 0.7180, lr_0 = 1.8022e-04
Loss = 4.0676e-01, PNorm = 38.3043, GNorm = 0.8298, lr_0 = 1.7681e-04
Loss = 3.6984e-01, PNorm = 38.3195, GNorm = 0.7396, lr_0 = 1.7346e-04
Loss = 4.0290e-01, PNorm = 38.3317, GNorm = 0.7092, lr_0 = 1.7018e-04
Validation prc-auc = 0.811972
Validation auc = 0.828757
Validation accuracy = 0.739669
Validation f1 = 0.740741
Epoch 23
Loss = 3.6356e-01, PNorm = 38.3447, GNorm = 0.6271, lr_0 = 1.6695e-04
Loss = 3.6972e-01, PNorm = 38.3619, GNorm = 0.7258, lr_0 = 1.6379e-04
Loss = 4.0390e-01, PNorm = 38.3737, GNorm = 0.5885, lr_0 = 1.6069e-04
Loss = 3.8763e-01, PNorm = 38.3843, GNorm = 0.7543, lr_0 = 1.5764e-04
Validation prc-auc = 0.822793
Validation auc = 0.836426
Validation accuracy = 0.747934
Validation f1 = 0.748971
Epoch 24
Loss = 3.6675e-01, PNorm = 38.3964, GNorm = 0.8915, lr_0 = 1.5436e-04
Loss = 4.1485e-01, PNorm = 38.4087, GNorm = 0.5923, lr_0 = 1.5144e-04
Loss = 3.7643e-01, PNorm = 38.4216, GNorm = 0.9704, lr_0 = 1.4857e-04
Loss = 3.8746e-01, PNorm = 38.4330, GNorm = 1.0823, lr_0 = 1.4575e-04
Validation prc-auc = 0.815875
Validation auc = 0.832968
Validation accuracy = 0.739669
Validation f1 = 0.744939
Epoch 25
Loss = 3.4561e-01, PNorm = 38.4447, GNorm = 0.6630, lr_0 = 1.4299e-04
Loss = 4.0707e-01, PNorm = 38.4569, GNorm = 0.6906, lr_0 = 1.4028e-04
Loss = 3.7566e-01, PNorm = 38.4696, GNorm = 0.6714, lr_0 = 1.3763e-04
Loss = 3.7950e-01, PNorm = 38.4802, GNorm = 0.6822, lr_0 = 1.3502e-04
Loss = 3.6991e-01, PNorm = 38.4915, GNorm = 1.0798, lr_0 = 1.3246e-04
Validation prc-auc = 0.821023
Validation auc = 0.837693
Validation accuracy = 0.747934
Validation f1 = 0.746888
Epoch 26
Loss = 3.8591e-01, PNorm = 38.5002, GNorm = 1.1460, lr_0 = 1.2995e-04
Loss = 3.9164e-01, PNorm = 38.5119, GNorm = 0.5503, lr_0 = 1.2749e-04
Loss = 3.9764e-01, PNorm = 38.5209, GNorm = 0.9156, lr_0 = 1.2508e-04
Loss = 3.6887e-01, PNorm = 38.5313, GNorm = 0.5397, lr_0 = 1.2271e-04
Validation prc-auc = 0.811129
Validation auc = 0.834783
Validation accuracy = 0.747934
Validation f1 = 0.753036
Epoch 27
Loss = 3.7269e-01, PNorm = 38.5424, GNorm = 1.4098, lr_0 = 1.2015e-04
Loss = 3.5185e-01, PNorm = 38.5536, GNorm = 0.7905, lr_0 = 1.1788e-04
Loss = 3.8134e-01, PNorm = 38.5633, GNorm = 0.4762, lr_0 = 1.1564e-04
Loss = 3.8865e-01, PNorm = 38.5739, GNorm = 0.7943, lr_0 = 1.1345e-04
Validation prc-auc = 0.825739
Validation auc = 0.838309
Validation accuracy = 0.752066
Validation f1 = 0.747899
Epoch 28
Loss = 3.4464e-01, PNorm = 38.5826, GNorm = 0.8352, lr_0 = 1.1130e-04
Loss = 3.7992e-01, PNorm = 38.5899, GNorm = 0.6525, lr_0 = 1.0920e-04
Loss = 3.9973e-01, PNorm = 38.5973, GNorm = 0.6821, lr_0 = 1.0713e-04
Loss = 3.5486e-01, PNorm = 38.6076, GNorm = 0.9378, lr_0 = 1.0510e-04
Loss = 3.5781e-01, PNorm = 38.6180, GNorm = 0.6184, lr_0 = 1.0311e-04
Validation prc-auc = 0.820446
Validation auc = 0.838754
Validation accuracy = 0.743802
Validation f1 = 0.747967
Epoch 29
Loss = 3.3734e-01, PNorm = 38.6256, GNorm = 0.7049, lr_0 = 1.0096e-04
Loss = 3.7997e-01, PNorm = 38.6343, GNorm = 1.4814, lr_0 = 1.0000e-04
Loss = 3.9444e-01, PNorm = 38.6413, GNorm = 0.7080, lr_0 = 1.0000e-04
Loss = 3.8875e-01, PNorm = 38.6477, GNorm = 0.8129, lr_0 = 1.0000e-04
Validation prc-auc = 0.821297
Validation auc = 0.835193
Validation accuracy = 0.747934
Validation f1 = 0.748971
Model 0 best validation prc-auc = 0.825739 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.726803
Model 0 test auc = 0.831141
Model 0 test accuracy = 0.738998
Model 0 test f1 = 0.693950
Ensemble test prc-auc = 0.726803
Ensemble test auc = 0.831141
Ensemble test accuracy = 0.738998
Ensemble test f1 = 0.693950
5-fold cross validation
	Seed 0 ==> test prc-auc = 0.749410
	Seed 0 ==> test auc = 0.837790
	Seed 0 ==> test accuracy = 0.752656
	Seed 0 ==> test f1 = 0.699816
	Seed 1 ==> test prc-auc = 0.721974
	Seed 1 ==> test auc = 0.830002
	Seed 1 ==> test accuracy = 0.743551
	Seed 1 ==> test f1 = 0.712095
	Seed 2 ==> test prc-auc = 0.749780
	Seed 2 ==> test auc = 0.841340
	Seed 2 ==> test accuracy = 0.758725
	Seed 2 ==> test f1 = 0.706100
	Seed 3 ==> test prc-auc = 0.745357
	Seed 3 ==> test auc = 0.836269
	Seed 3 ==> test accuracy = 0.758725
	Seed 3 ==> test f1 = 0.708257
	Seed 4 ==> test prc-auc = 0.726803
	Seed 4 ==> test auc = 0.831141
	Seed 4 ==> test accuracy = 0.738998
	Seed 4 ==> test f1 = 0.693950
Overall test prc-auc = 0.738665 +/- 0.011858
Overall test auc = 0.835308 +/- 0.004219
Overall test accuracy = 0.750531 +/- 0.008007
Overall test f1 = 0.704044 +/- 0.006427
Elapsed time = 0:20:40
Command line
python /usr/local/lib/python3.10/dist-packages/ipykernel_launcher.py -f /root/.local/share/jupyter/runtime/kernel-0831b817-b956-44b6-9ad1-5b41ca65693c.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '/content/data/binarized_chemprop_trainset.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['auc', 'accuracy', 'f1'],
 'features_generator': ['morgan'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'prc-auc',
 'metrics': ['prc-auc', 'auc', 'accuracy', 'f1'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/content/models/antibiotic_chemprop_morgan',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': '/content/data/binarized_chemprop_testset.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['fluor'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Epoch 0
Loss = 6.9734e-01, PNorm = 37.2307, GNorm = 0.8060, lr_0 = 2.1512e-04
Loss = 6.4076e-01, PNorm = 37.2396, GNorm = 0.8534, lr_0 = 3.1977e-04
Loss = 5.9356e-01, PNorm = 37.2625, GNorm = 0.4728, lr_0 = 4.2442e-04
Loss = 5.8629e-01, PNorm = 37.2975, GNorm = 1.0944, lr_0 = 5.2907e-04
Validation prc-auc = 0.824165
Validation auc = 0.835056
Validation accuracy = 0.706612
Validation f1 = 0.624339
Epoch 1
Loss = 5.1422e-01, PNorm = 37.3536, GNorm = 0.6908, lr_0 = 6.4419e-04
Loss = 4.6639e-01, PNorm = 37.4320, GNorm = 0.8280, lr_0 = 7.4884e-04
Loss = 4.5148e-01, PNorm = 37.5249, GNorm = 0.7735, lr_0 = 8.5349e-04
Loss = 4.7507e-01, PNorm = 37.6331, GNorm = 1.0648, lr_0 = 9.5814e-04
Validation prc-auc = 0.831327
Validation auc = 0.848134
Validation accuracy = 0.768595
Validation f1 = 0.768595
Epoch 2
Loss = 3.5694e-01, PNorm = 37.7518, GNorm = 0.4405, lr_0 = 9.8859e-04
Loss = 3.9324e-01, PNorm = 37.9041, GNorm = 0.8647, lr_0 = 9.6986e-04
Loss = 4.0821e-01, PNorm = 38.0499, GNorm = 0.3493, lr_0 = 9.5149e-04
Loss = 4.4199e-01, PNorm = 38.1850, GNorm = 0.5580, lr_0 = 9.3347e-04
Loss = 4.0515e-01, PNorm = 38.3151, GNorm = 0.5494, lr_0 = 9.1579e-04
Loss = 4.1324e-01, PNorm = 38.3282, GNorm = 0.6594, lr_0 = 9.1404e-04
Validation prc-auc = 0.868839
Validation auc = 0.876207
Validation accuracy = 0.780992
Validation f1 = 0.787149
Epoch 3
Loss = 3.5798e-01, PNorm = 38.4678, GNorm = 0.5247, lr_0 = 8.9672e-04
Loss = 3.6142e-01, PNorm = 38.6107, GNorm = 0.3924, lr_0 = 8.7974e-04
Loss = 3.7791e-01, PNorm = 38.7381, GNorm = 0.6238, lr_0 = 8.6307e-04
Loss = 3.8444e-01, PNorm = 38.8531, GNorm = 0.7799, lr_0 = 8.4672e-04
Validation prc-auc = 0.858539
Validation auc = 0.871345
Validation accuracy = 0.780992
Validation f1 = 0.776371
Epoch 4
Loss = 3.3807e-01, PNorm = 38.9770, GNorm = 0.5229, lr_0 = 8.3068e-04
Loss = 3.3516e-01, PNorm = 39.1079, GNorm = 0.3043, lr_0 = 8.1495e-04
Loss = 3.4107e-01, PNorm = 39.2247, GNorm = 0.4294, lr_0 = 7.9951e-04
Loss = 3.2394e-01, PNorm = 39.3407, GNorm = 0.3868, lr_0 = 7.8437e-04
Validation prc-auc = 0.870854
Validation auc = 0.884526
Validation accuracy = 0.780992
Validation f1 = 0.780083
Epoch 5
Loss = 2.9508e-01, PNorm = 39.4593, GNorm = 0.4062, lr_0 = 7.6804e-04
Loss = 2.9750e-01, PNorm = 39.5658, GNorm = 0.3639, lr_0 = 7.5349e-04
Loss = 3.2240e-01, PNorm = 39.6634, GNorm = 0.4154, lr_0 = 7.3921e-04
Loss = 2.9841e-01, PNorm = 39.7696, GNorm = 0.4397, lr_0 = 7.2521e-04
Loss = 3.3197e-01, PNorm = 39.8724, GNorm = 0.3981, lr_0 = 7.1147e-04
Validation prc-auc = 0.868424
Validation auc = 0.887093
Validation accuracy = 0.797521
Validation f1 = 0.793249
Epoch 6
Loss = 2.6150e-01, PNorm = 39.9813, GNorm = 0.3929, lr_0 = 6.9800e-04
Loss = 2.8120e-01, PNorm = 40.0843, GNorm = 0.4647, lr_0 = 6.8478e-04
Loss = 3.2359e-01, PNorm = 40.1724, GNorm = 0.4879, lr_0 = 6.7180e-04
Loss = 3.1640e-01, PNorm = 40.2578, GNorm = 0.4326, lr_0 = 6.5908e-04
Validation prc-auc = 0.866534
Validation auc = 0.882814
Validation accuracy = 0.789256
Validation f1 = 0.777293
Epoch 7
Loss = 2.3243e-01, PNorm = 40.3641, GNorm = 0.3743, lr_0 = 6.4536e-04
Loss = 2.7555e-01, PNorm = 40.4590, GNorm = 0.3005, lr_0 = 6.3313e-04
Loss = 2.7353e-01, PNorm = 40.5449, GNorm = 0.6755, lr_0 = 6.2114e-04
Loss = 2.9707e-01, PNorm = 40.6197, GNorm = 0.5233, lr_0 = 6.0937e-04
Validation prc-auc = 0.863081
Validation auc = 0.881821
Validation accuracy = 0.789256
Validation f1 = 0.788382
Epoch 8
Loss = 3.4025e-01, PNorm = 40.6869, GNorm = 0.6200, lr_0 = 5.9783e-04
Loss = 2.5675e-01, PNorm = 40.7592, GNorm = 0.4145, lr_0 = 5.8651e-04
Loss = 2.4991e-01, PNorm = 40.8391, GNorm = 0.4483, lr_0 = 5.7540e-04
Loss = 2.8296e-01, PNorm = 40.9172, GNorm = 0.4175, lr_0 = 5.6450e-04
Loss = 2.6279e-01, PNorm = 40.9926, GNorm = 0.3493, lr_0 = 5.5380e-04
Validation prc-auc = 0.856730
Validation auc = 0.877576
Validation accuracy = 0.793388
Validation f1 = 0.784483
Epoch 9
Loss = 2.3228e-01, PNorm = 41.0669, GNorm = 0.4240, lr_0 = 5.4227e-04
Loss = 2.5238e-01, PNorm = 41.1379, GNorm = 0.4419, lr_0 = 5.3200e-04
Loss = 2.6204e-01, PNorm = 41.2018, GNorm = 0.3997, lr_0 = 5.2192e-04
Loss = 2.9678e-01, PNorm = 41.2613, GNorm = 0.3992, lr_0 = 5.1204e-04
Validation prc-auc = 0.860487
Validation auc = 0.877679
Validation accuracy = 0.801653
Validation f1 = 0.798319
Epoch 10
Loss = 2.3946e-01, PNorm = 41.3243, GNorm = 0.4266, lr_0 = 5.0234e-04
Loss = 2.2155e-01, PNorm = 41.3886, GNorm = 0.4281, lr_0 = 4.9282e-04
Loss = 2.5304e-01, PNorm = 41.4495, GNorm = 0.4603, lr_0 = 4.8349e-04
Loss = 2.4893e-01, PNorm = 41.5062, GNorm = 0.3404, lr_0 = 4.7433e-04
Validation prc-auc = 0.855934
Validation auc = 0.878261
Validation accuracy = 0.780992
Validation f1 = 0.762332
Epoch 11
Loss = 2.0001e-01, PNorm = 41.5661, GNorm = 0.5129, lr_0 = 4.6445e-04
Loss = 2.2365e-01, PNorm = 41.6230, GNorm = 0.5191, lr_0 = 4.5566e-04
Loss = 2.4084e-01, PNorm = 41.6765, GNorm = 0.4017, lr_0 = 4.4703e-04
Loss = 2.5993e-01, PNorm = 41.7283, GNorm = 0.5513, lr_0 = 4.3856e-04
Loss = 2.8872e-01, PNorm = 41.7759, GNorm = 0.5885, lr_0 = 4.3025e-04
Validation prc-auc = 0.857590
Validation auc = 0.878021
Validation accuracy = 0.793388
Validation f1 = 0.786325
Epoch 12
Loss = 2.1624e-01, PNorm = 41.8239, GNorm = 0.2128, lr_0 = 4.2210e-04
Loss = 2.3291e-01, PNorm = 41.8737, GNorm = 0.3568, lr_0 = 4.1410e-04
Loss = 2.4443e-01, PNorm = 41.9211, GNorm = 0.6291, lr_0 = 4.0626e-04
Loss = 2.6179e-01, PNorm = 41.9626, GNorm = 0.4075, lr_0 = 3.9856e-04
Validation prc-auc = 0.858745
Validation auc = 0.877713
Validation accuracy = 0.793388
Validation f1 = 0.782609
Epoch 13
Loss = 2.2401e-01, PNorm = 42.0052, GNorm = 0.3791, lr_0 = 3.9101e-04
Loss = 2.3796e-01, PNorm = 42.0480, GNorm = 0.3311, lr_0 = 3.8361e-04
Loss = 2.3767e-01, PNorm = 42.0877, GNorm = 0.4575, lr_0 = 3.7634e-04
Loss = 2.4662e-01, PNorm = 42.1245, GNorm = 0.4803, lr_0 = 3.6921e-04
Validation prc-auc = 0.853972
Validation auc = 0.875180
Validation accuracy = 0.785124
Validation f1 = 0.785124
Epoch 14
Loss = 2.0977e-01, PNorm = 42.1680, GNorm = 0.5601, lr_0 = 3.6153e-04
Loss = 2.2384e-01, PNorm = 42.2083, GNorm = 0.3657, lr_0 = 3.5468e-04
Loss = 2.1895e-01, PNorm = 42.2499, GNorm = 0.3656, lr_0 = 3.4796e-04
Loss = 2.2204e-01, PNorm = 42.2861, GNorm = 0.4838, lr_0 = 3.4137e-04
Loss = 2.5215e-01, PNorm = 42.3227, GNorm = 0.4136, lr_0 = 3.3490e-04
Validation prc-auc = 0.852984
Validation auc = 0.875625
Validation accuracy = 0.785124
Validation f1 = 0.777778
Epoch 15
Loss = 2.2058e-01, PNorm = 42.3561, GNorm = 0.3823, lr_0 = 3.2856e-04
Loss = 2.4142e-01, PNorm = 42.3871, GNorm = 0.3371, lr_0 = 3.2233e-04
Loss = 1.9074e-01, PNorm = 42.4200, GNorm = 0.4293, lr_0 = 3.1623e-04
Loss = 2.4360e-01, PNorm = 42.4507, GNorm = 0.4217, lr_0 = 3.1024e-04
Validation prc-auc = 0.850534
Validation auc = 0.874700
Validation accuracy = 0.785124
Validation f1 = 0.775862
Epoch 16
Loss = 2.3674e-01, PNorm = 42.4836, GNorm = 0.3659, lr_0 = 3.0378e-04
Loss = 2.2962e-01, PNorm = 42.5129, GNorm = 0.4295, lr_0 = 2.9802e-04
Loss = 2.3987e-01, PNorm = 42.5401, GNorm = 0.3596, lr_0 = 2.9238e-04
Loss = 2.2446e-01, PNorm = 42.5699, GNorm = 0.3353, lr_0 = 2.8684e-04
Loss = 1.9651e-01, PNorm = 42.6039, GNorm = 0.4575, lr_0 = 2.8141e-04
Validation prc-auc = 0.850574
Validation auc = 0.874803
Validation accuracy = 0.789256
Validation f1 = 0.786611
Epoch 17
Loss = 2.3321e-01, PNorm = 42.6347, GNorm = 0.4610, lr_0 = 2.7608e-04
Loss = 2.0567e-01, PNorm = 42.6653, GNorm = 0.4319, lr_0 = 2.7085e-04
Loss = 2.2254e-01, PNorm = 42.6934, GNorm = 0.3797, lr_0 = 2.6572e-04
Loss = 2.3255e-01, PNorm = 42.7189, GNorm = 0.3757, lr_0 = 2.6068e-04
Validation prc-auc = 0.849309
Validation auc = 0.875214
Validation accuracy = 0.801653
Validation f1 = 0.800000
Epoch 18
Loss = 1.9623e-01, PNorm = 42.7461, GNorm = 0.3375, lr_0 = 2.5526e-04
Loss = 2.3579e-01, PNorm = 42.7701, GNorm = 0.2975, lr_0 = 2.5042e-04
Loss = 2.0124e-01, PNorm = 42.7942, GNorm = 0.3803, lr_0 = 2.4568e-04
Loss = 2.5069e-01, PNorm = 42.8163, GNorm = 0.5149, lr_0 = 2.4102e-04
Validation prc-auc = 0.848123
Validation auc = 0.872509
Validation accuracy = 0.789256
Validation f1 = 0.775330
Epoch 19
Loss = 2.3295e-01, PNorm = 42.8382, GNorm = 0.4225, lr_0 = 2.3646e-04
Loss = 1.8603e-01, PNorm = 42.8617, GNorm = 0.2987, lr_0 = 2.3198e-04
Loss = 2.2485e-01, PNorm = 42.8840, GNorm = 0.3171, lr_0 = 2.2758e-04
Loss = 2.2618e-01, PNorm = 42.9048, GNorm = 0.6936, lr_0 = 2.2327e-04
Loss = 2.3385e-01, PNorm = 42.9256, GNorm = 0.5853, lr_0 = 2.1904e-04
Loss = 1.7040e-01, PNorm = 42.9277, GNorm = 0.3775, lr_0 = 2.1863e-04
Validation prc-auc = 0.847200
Validation auc = 0.872920
Validation accuracy = 0.789256
Validation f1 = 0.779221
Epoch 20
Loss = 2.1849e-01, PNorm = 42.9484, GNorm = 0.4646, lr_0 = 2.1448e-04
Loss = 2.0231e-01, PNorm = 42.9688, GNorm = 0.3701, lr_0 = 2.1042e-04
Loss = 2.3925e-01, PNorm = 42.9887, GNorm = 0.2674, lr_0 = 2.0644e-04
Loss = 1.8028e-01, PNorm = 43.0078, GNorm = 0.4744, lr_0 = 2.0252e-04
Validation prc-auc = 0.847138
Validation auc = 0.873263
Validation accuracy = 0.801653
Validation f1 = 0.793103
Epoch 21
Loss = 2.0871e-01, PNorm = 43.0269, GNorm = 0.3825, lr_0 = 1.9869e-04
Loss = 2.1761e-01, PNorm = 43.0458, GNorm = 0.3164, lr_0 = 1.9492e-04
Loss = 1.9743e-01, PNorm = 43.0646, GNorm = 0.3168, lr_0 = 1.9123e-04
Loss = 2.1706e-01, PNorm = 43.0828, GNorm = 0.3408, lr_0 = 1.8761e-04
Validation prc-auc = 0.848503
Validation auc = 0.874016
Validation accuracy = 0.797521
Validation f1 = 0.791489
Epoch 22
Loss = 1.8529e-01, PNorm = 43.1025, GNorm = 0.4265, lr_0 = 1.8370e-04
Loss = 1.9847e-01, PNorm = 43.1195, GNorm = 0.4646, lr_0 = 1.8022e-04
Loss = 2.1031e-01, PNorm = 43.1347, GNorm = 0.2883, lr_0 = 1.7681e-04
Loss = 2.0894e-01, PNorm = 43.1513, GNorm = 0.6009, lr_0 = 1.7346e-04
Loss = 2.3778e-01, PNorm = 43.1678, GNorm = 0.3378, lr_0 = 1.7018e-04
Validation prc-auc = 0.844706
Validation auc = 0.871996
Validation accuracy = 0.793388
Validation f1 = 0.788136
Epoch 23
Loss = 2.2369e-01, PNorm = 43.1831, GNorm = 0.2722, lr_0 = 1.6695e-04
Loss = 1.9857e-01, PNorm = 43.1988, GNorm = 0.4159, lr_0 = 1.6379e-04
Loss = 2.0622e-01, PNorm = 43.2144, GNorm = 0.3923, lr_0 = 1.6069e-04
Loss = 2.2410e-01, PNorm = 43.2284, GNorm = 0.4393, lr_0 = 1.5764e-04
Validation prc-auc = 0.847301
Validation auc = 0.872646
Validation accuracy = 0.801653
Validation f1 = 0.791304
Epoch 24
Loss = 2.2040e-01, PNorm = 43.2445, GNorm = 0.9263, lr_0 = 1.5436e-04
Loss = 2.0867e-01, PNorm = 43.2591, GNorm = 0.4279, lr_0 = 1.5144e-04
Loss = 1.9457e-01, PNorm = 43.2742, GNorm = 0.5835, lr_0 = 1.4857e-04
Loss = 2.3685e-01, PNorm = 43.2876, GNorm = 0.4650, lr_0 = 1.4575e-04
Validation prc-auc = 0.846446
Validation auc = 0.872886
Validation accuracy = 0.789256
Validation f1 = 0.784810
Epoch 25
Loss = 2.6226e-01, PNorm = 43.2995, GNorm = 0.5088, lr_0 = 1.4299e-04
Loss = 1.9872e-01, PNorm = 43.3118, GNorm = 0.4709, lr_0 = 1.4028e-04
Loss = 1.8640e-01, PNorm = 43.3243, GNorm = 0.3217, lr_0 = 1.3763e-04
Loss = 2.3278e-01, PNorm = 43.3369, GNorm = 0.5208, lr_0 = 1.3502e-04
Loss = 2.0500e-01, PNorm = 43.3488, GNorm = 0.3295, lr_0 = 1.3246e-04
Validation prc-auc = 0.845474
Validation auc = 0.872099
Validation accuracy = 0.785124
Validation f1 = 0.781513
Epoch 26
Loss = 1.8390e-01, PNorm = 43.3613, GNorm = 0.4414, lr_0 = 1.2995e-04
Loss = 2.3863e-01, PNorm = 43.3743, GNorm = 0.3558, lr_0 = 1.2749e-04
Loss = 1.9204e-01, PNorm = 43.3863, GNorm = 0.5239, lr_0 = 1.2508e-04
Loss = 1.8346e-01, PNorm = 43.3979, GNorm = 0.3886, lr_0 = 1.2271e-04
Validation prc-auc = 0.845290
Validation auc = 0.871619
Validation accuracy = 0.785124
Validation f1 = 0.779661
Epoch 27
Loss = 1.7563e-01, PNorm = 43.4095, GNorm = 0.2837, lr_0 = 1.2015e-04
Loss = 2.0646e-01, PNorm = 43.4208, GNorm = 0.4269, lr_0 = 1.1788e-04
Loss = 2.1692e-01, PNorm = 43.4316, GNorm = 0.4180, lr_0 = 1.1564e-04
Loss = 2.1549e-01, PNorm = 43.4419, GNorm = 0.3800, lr_0 = 1.1345e-04
Validation prc-auc = 0.845667
Validation auc = 0.871790
Validation accuracy = 0.789256
Validation f1 = 0.784810
Epoch 28
Loss = 2.2236e-01, PNorm = 43.4521, GNorm = 0.3575, lr_0 = 1.1130e-04
Loss = 2.2032e-01, PNorm = 43.4615, GNorm = 0.4570, lr_0 = 1.0920e-04
Loss = 1.9806e-01, PNorm = 43.4712, GNorm = 0.4650, lr_0 = 1.0713e-04
Loss = 2.0070e-01, PNorm = 43.4808, GNorm = 0.3331, lr_0 = 1.0510e-04
Loss = 1.8111e-01, PNorm = 43.4908, GNorm = 0.5563, lr_0 = 1.0311e-04
Validation prc-auc = 0.845771
Validation auc = 0.872475
Validation accuracy = 0.789256
Validation f1 = 0.781116
Epoch 29
Loss = 2.2385e-01, PNorm = 43.5015, GNorm = 0.4696, lr_0 = 1.0096e-04
Loss = 2.1326e-01, PNorm = 43.5109, GNorm = 0.5510, lr_0 = 1.0000e-04
Loss = 2.2685e-01, PNorm = 43.5193, GNorm = 0.4630, lr_0 = 1.0000e-04
Loss = 1.6445e-01, PNorm = 43.5284, GNorm = 0.5095, lr_0 = 1.0000e-04
Validation prc-auc = 0.847326
Validation auc = 0.872852
Validation accuracy = 0.801653
Validation f1 = 0.793103
Model 0 best validation prc-auc = 0.870854 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.795653
Model 0 test auc = 0.862091
Model 0 test accuracy = 0.779970
Model 0 test f1 = 0.738739
Ensemble test prc-auc = 0.795653
Ensemble test auc = 0.862091
Ensemble test accuracy = 0.779970
Ensemble test f1 = 0.738739
Fold 1
Splitting data with seed 1
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Epoch 0
Loss = 6.8469e-01, PNorm = 37.2319, GNorm = 0.8072, lr_0 = 2.1512e-04
Loss = 6.4818e-01, PNorm = 37.2412, GNorm = 1.4604, lr_0 = 3.1977e-04
Loss = 6.1036e-01, PNorm = 37.2610, GNorm = 0.5419, lr_0 = 4.2442e-04
Loss = 5.6948e-01, PNorm = 37.2963, GNorm = 0.4229, lr_0 = 5.2907e-04
Validation prc-auc = 0.707644
Validation auc = 0.789836
Validation accuracy = 0.735537
Validation f1 = 0.711712
Epoch 1
Loss = 5.1035e-01, PNorm = 37.3545, GNorm = 0.4639, lr_0 = 6.4419e-04
Loss = 5.0298e-01, PNorm = 37.4251, GNorm = 1.2847, lr_0 = 7.4884e-04
Loss = 4.6829e-01, PNorm = 37.5163, GNorm = 0.4086, lr_0 = 8.5349e-04
Loss = 4.4426e-01, PNorm = 37.6392, GNorm = 0.4382, lr_0 = 9.5814e-04
Validation prc-auc = 0.760802
Validation auc = 0.819306
Validation accuracy = 0.747934
Validation f1 = 0.705314
Epoch 2
Loss = 4.1131e-01, PNorm = 37.7864, GNorm = 0.5101, lr_0 = 9.8859e-04
Loss = 3.9754e-01, PNorm = 37.9407, GNorm = 0.4235, lr_0 = 9.6986e-04
Loss = 4.1176e-01, PNorm = 38.0866, GNorm = 0.4989, lr_0 = 9.5149e-04
Loss = 3.9389e-01, PNorm = 38.2314, GNorm = 0.7258, lr_0 = 9.3347e-04
Loss = 3.9270e-01, PNorm = 38.3646, GNorm = 0.3741, lr_0 = 9.1579e-04
Loss = 7.0937e-01, PNorm = 38.3760, GNorm = 0.9606, lr_0 = 9.1404e-04
Validation prc-auc = 0.779339
Validation auc = 0.833575
Validation accuracy = 0.764463
Validation f1 = 0.721951
Epoch 3
Loss = 3.5227e-01, PNorm = 38.5018, GNorm = 0.3671, lr_0 = 8.9672e-04
Loss = 3.6698e-01, PNorm = 38.6296, GNorm = 0.3512, lr_0 = 8.7974e-04
Loss = 3.1224e-01, PNorm = 38.7565, GNorm = 0.4730, lr_0 = 8.6307e-04
Loss = 3.7366e-01, PNorm = 38.8786, GNorm = 0.4126, lr_0 = 8.4672e-04
Validation prc-auc = 0.786779
Validation auc = 0.836892
Validation accuracy = 0.785124
Validation f1 = 0.754717
Epoch 4
Loss = 3.0148e-01, PNorm = 39.0032, GNorm = 0.3604, lr_0 = 8.3068e-04
Loss = 3.2824e-01, PNorm = 39.1269, GNorm = 0.3735, lr_0 = 8.1495e-04
Loss = 3.4094e-01, PNorm = 39.2371, GNorm = 0.4013, lr_0 = 7.9951e-04
Loss = 3.2007e-01, PNorm = 39.3424, GNorm = 0.5116, lr_0 = 7.8437e-04
Validation prc-auc = 0.783416
Validation auc = 0.835614
Validation accuracy = 0.760331
Validation f1 = 0.721154
Epoch 5
Loss = 2.4131e-01, PNorm = 39.4555, GNorm = 0.4724, lr_0 = 7.6804e-04
Loss = 2.6327e-01, PNorm = 39.5654, GNorm = 0.3761, lr_0 = 7.5349e-04
Loss = 3.1994e-01, PNorm = 39.6720, GNorm = 0.4574, lr_0 = 7.3921e-04
Loss = 3.1530e-01, PNorm = 39.7690, GNorm = 0.3148, lr_0 = 7.2521e-04
Loss = 3.1797e-01, PNorm = 39.8631, GNorm = 0.4971, lr_0 = 7.1147e-04
Validation prc-auc = 0.772531
Validation auc = 0.831640
Validation accuracy = 0.768595
Validation f1 = 0.735849
Epoch 6
Loss = 2.7711e-01, PNorm = 39.9587, GNorm = 0.4873, lr_0 = 6.9800e-04
Loss = 2.8882e-01, PNorm = 40.0518, GNorm = 0.4882, lr_0 = 6.8478e-04
Loss = 2.8793e-01, PNorm = 40.1419, GNorm = 0.4986, lr_0 = 6.7180e-04
Loss = 2.7924e-01, PNorm = 40.2258, GNorm = 0.3880, lr_0 = 6.5908e-04
Validation prc-auc = 0.792099
Validation auc = 0.842765
Validation accuracy = 0.776860
Validation f1 = 0.742857
Epoch 7
Loss = 2.2244e-01, PNorm = 40.3183, GNorm = 0.3015, lr_0 = 6.4536e-04
Loss = 2.4628e-01, PNorm = 40.3993, GNorm = 0.3152, lr_0 = 6.3313e-04
Loss = 3.1245e-01, PNorm = 40.4771, GNorm = 0.4410, lr_0 = 6.2114e-04
Loss = 2.8098e-01, PNorm = 40.5535, GNorm = 0.3666, lr_0 = 6.0937e-04
Validation prc-auc = 0.785154
Validation auc = 0.837099
Validation accuracy = 0.776860
Validation f1 = 0.742857
Epoch 8
Loss = 2.9770e-01, PNorm = 40.6287, GNorm = 0.4269, lr_0 = 5.9783e-04
Loss = 2.2791e-01, PNorm = 40.7016, GNorm = 0.4254, lr_0 = 5.8651e-04
Loss = 2.6432e-01, PNorm = 40.7713, GNorm = 0.4178, lr_0 = 5.7540e-04
Loss = 2.8169e-01, PNorm = 40.8402, GNorm = 0.3890, lr_0 = 5.6450e-04
Loss = 2.6415e-01, PNorm = 40.9060, GNorm = 0.3120, lr_0 = 5.5380e-04
Validation prc-auc = 0.785742
Validation auc = 0.842143
Validation accuracy = 0.772727
Validation f1 = 0.741784
Epoch 9
Loss = 2.5793e-01, PNorm = 40.9772, GNorm = 0.4028, lr_0 = 5.4227e-04
Loss = 2.3382e-01, PNorm = 41.0410, GNorm = 0.4830, lr_0 = 5.3200e-04
Loss = 2.3355e-01, PNorm = 41.1044, GNorm = 0.3392, lr_0 = 5.2192e-04
Loss = 2.8770e-01, PNorm = 41.1645, GNorm = 0.4174, lr_0 = 5.1204e-04
Validation prc-auc = 0.784663
Validation auc = 0.841556
Validation accuracy = 0.776860
Validation f1 = 0.742857
Epoch 10
Loss = 2.4193e-01, PNorm = 41.2278, GNorm = 0.4956, lr_0 = 5.0234e-04
Loss = 2.4969e-01, PNorm = 41.2881, GNorm = 0.3963, lr_0 = 4.9282e-04
Loss = 2.4423e-01, PNorm = 41.3418, GNorm = 0.4784, lr_0 = 4.8349e-04
Loss = 2.2759e-01, PNorm = 41.3972, GNorm = 0.5131, lr_0 = 4.7433e-04
Validation prc-auc = 0.779387
Validation auc = 0.838343
Validation accuracy = 0.789256
Validation f1 = 0.762791
Epoch 11
Loss = 2.6617e-01, PNorm = 41.4501, GNorm = 0.3970, lr_0 = 4.6445e-04
Loss = 2.0105e-01, PNorm = 41.5002, GNorm = 0.3687, lr_0 = 4.5566e-04
Loss = 2.5871e-01, PNorm = 41.5507, GNorm = 0.4497, lr_0 = 4.4703e-04
Loss = 2.2140e-01, PNorm = 41.6002, GNorm = 0.4015, lr_0 = 4.3856e-04
Loss = 2.7800e-01, PNorm = 41.6444, GNorm = 0.5000, lr_0 = 4.3025e-04
Validation prc-auc = 0.786083
Validation auc = 0.840761
Validation accuracy = 0.768595
Validation f1 = 0.728155
Epoch 12
Loss = 2.1419e-01, PNorm = 41.6867, GNorm = 0.2625, lr_0 = 4.2210e-04
Loss = 2.2448e-01, PNorm = 41.7324, GNorm = 0.3636, lr_0 = 4.1410e-04
Loss = 2.5741e-01, PNorm = 41.7759, GNorm = 0.4150, lr_0 = 4.0626e-04
Loss = 2.4576e-01, PNorm = 41.8174, GNorm = 0.5041, lr_0 = 3.9856e-04
Validation prc-auc = 0.784359
Validation auc = 0.842282
Validation accuracy = 0.764463
Validation f1 = 0.729858
Epoch 13
Loss = 2.4013e-01, PNorm = 41.8594, GNorm = 0.4062, lr_0 = 3.9101e-04
Loss = 2.1947e-01, PNorm = 41.9032, GNorm = 0.3535, lr_0 = 3.8361e-04
Loss = 2.4754e-01, PNorm = 41.9408, GNorm = 0.4315, lr_0 = 3.7634e-04
Loss = 2.3378e-01, PNorm = 41.9790, GNorm = 0.3506, lr_0 = 3.6921e-04
Validation prc-auc = 0.782407
Validation auc = 0.840209
Validation accuracy = 0.785124
Validation f1 = 0.757009
Epoch 14
Loss = 1.9320e-01, PNorm = 42.0195, GNorm = 0.2935, lr_0 = 3.6153e-04
Loss = 2.1464e-01, PNorm = 42.0551, GNorm = 0.4814, lr_0 = 3.5468e-04
Loss = 2.0671e-01, PNorm = 42.0919, GNorm = 0.4946, lr_0 = 3.4796e-04
Loss = 2.1773e-01, PNorm = 42.1275, GNorm = 0.3165, lr_0 = 3.4137e-04
Loss = 2.4982e-01, PNorm = 42.1604, GNorm = 0.4935, lr_0 = 3.3490e-04
Validation prc-auc = 0.782226
Validation auc = 0.841245
Validation accuracy = 0.776860
Validation f1 = 0.742857
Epoch 15
Loss = 1.9864e-01, PNorm = 42.1895, GNorm = 0.3198, lr_0 = 3.2856e-04
Loss = 2.2097e-01, PNorm = 42.2196, GNorm = 0.4344, lr_0 = 3.2233e-04
Loss = 2.3818e-01, PNorm = 42.2506, GNorm = 0.4937, lr_0 = 3.1623e-04
Loss = 2.1198e-01, PNorm = 42.2823, GNorm = 0.5684, lr_0 = 3.1024e-04
Validation prc-auc = 0.784569
Validation auc = 0.842593
Validation accuracy = 0.789256
Validation f1 = 0.758294
Epoch 16
Loss = 1.8096e-01, PNorm = 42.3148, GNorm = 0.3573, lr_0 = 3.0378e-04
Loss = 2.1987e-01, PNorm = 42.3454, GNorm = 0.3910, lr_0 = 2.9802e-04
Loss = 2.5496e-01, PNorm = 42.3727, GNorm = 0.4539, lr_0 = 2.9238e-04
Loss = 2.1609e-01, PNorm = 42.3970, GNorm = 0.3477, lr_0 = 2.8684e-04
Loss = 2.0125e-01, PNorm = 42.4245, GNorm = 0.5271, lr_0 = 2.8141e-04
Validation prc-auc = 0.783712
Validation auc = 0.841660
Validation accuracy = 0.780992
Validation f1 = 0.746411
Epoch 17
Loss = 2.4269e-01, PNorm = 42.4514, GNorm = 0.3386, lr_0 = 2.7608e-04
Loss = 2.0581e-01, PNorm = 42.4757, GNorm = 0.3751, lr_0 = 2.7085e-04
Loss = 2.2255e-01, PNorm = 42.5012, GNorm = 0.5438, lr_0 = 2.6572e-04
Loss = 2.0357e-01, PNorm = 42.5256, GNorm = 0.4926, lr_0 = 2.6068e-04
Validation prc-auc = 0.783055
Validation auc = 0.841245
Validation accuracy = 0.776860
Validation f1 = 0.742857
Epoch 18
Loss = 2.1446e-01, PNorm = 42.5553, GNorm = 0.3543, lr_0 = 2.5526e-04
Loss = 1.9041e-01, PNorm = 42.5823, GNorm = 0.4128, lr_0 = 2.5042e-04
Loss = 2.2923e-01, PNorm = 42.6068, GNorm = 0.3439, lr_0 = 2.4568e-04
Loss = 2.1237e-01, PNorm = 42.6297, GNorm = 0.2831, lr_0 = 2.4102e-04
Validation prc-auc = 0.782684
Validation auc = 0.841522
Validation accuracy = 0.785124
Validation f1 = 0.754717
Epoch 19
Loss = 2.1062e-01, PNorm = 42.6499, GNorm = 0.3212, lr_0 = 2.3646e-04
Loss = 1.9160e-01, PNorm = 42.6721, GNorm = 0.3265, lr_0 = 2.3198e-04
Loss = 2.2332e-01, PNorm = 42.6930, GNorm = 0.3787, lr_0 = 2.2758e-04
Loss = 2.3030e-01, PNorm = 42.7109, GNorm = 0.3487, lr_0 = 2.2327e-04
Loss = 2.1320e-01, PNorm = 42.7310, GNorm = 0.3604, lr_0 = 2.1904e-04
Loss = 1.1866e-01, PNorm = 42.7332, GNorm = 0.3741, lr_0 = 2.1863e-04
Validation prc-auc = 0.783674
Validation auc = 0.841418
Validation accuracy = 0.785124
Validation f1 = 0.752381
Epoch 20
Loss = 1.8422e-01, PNorm = 42.7542, GNorm = 0.4409, lr_0 = 2.1448e-04
Loss = 2.1575e-01, PNorm = 42.7748, GNorm = 0.6437, lr_0 = 2.1042e-04
Loss = 1.9934e-01, PNorm = 42.7956, GNorm = 0.4145, lr_0 = 2.0644e-04
Loss = 2.4413e-01, PNorm = 42.8129, GNorm = 0.3880, lr_0 = 2.0252e-04
Validation prc-auc = 0.783865
Validation auc = 0.841314
Validation accuracy = 0.785124
Validation f1 = 0.754717
Epoch 21
Loss = 2.2676e-01, PNorm = 42.8298, GNorm = 0.4356, lr_0 = 1.9869e-04
Loss = 1.8324e-01, PNorm = 42.8476, GNorm = 0.5999, lr_0 = 1.9492e-04
Loss = 2.3115e-01, PNorm = 42.8639, GNorm = 0.3141, lr_0 = 1.9123e-04
Loss = 2.0415e-01, PNorm = 42.8812, GNorm = 0.3575, lr_0 = 1.8761e-04
Validation prc-auc = 0.785288
Validation auc = 0.842109
Validation accuracy = 0.785124
Validation f1 = 0.752381
Epoch 22
Loss = 2.0025e-01, PNorm = 42.9000, GNorm = 0.4489, lr_0 = 1.8370e-04
Loss = 2.1468e-01, PNorm = 42.9177, GNorm = 0.4689, lr_0 = 1.8022e-04
Loss = 2.1934e-01, PNorm = 42.9330, GNorm = 0.7318, lr_0 = 1.7681e-04
Loss = 1.8677e-01, PNorm = 42.9485, GNorm = 0.4456, lr_0 = 1.7346e-04
Loss = 2.0745e-01, PNorm = 42.9643, GNorm = 0.4294, lr_0 = 1.7018e-04
Validation prc-auc = 0.785959
Validation auc = 0.843042
Validation accuracy = 0.789256
Validation f1 = 0.760563
Epoch 23
Loss = 1.9691e-01, PNorm = 42.9799, GNorm = 0.3148, lr_0 = 1.6695e-04
Loss = 2.1249e-01, PNorm = 42.9954, GNorm = 0.3479, lr_0 = 1.6379e-04
Loss = 1.8303e-01, PNorm = 43.0108, GNorm = 0.4658, lr_0 = 1.6069e-04
Loss = 2.4647e-01, PNorm = 43.0242, GNorm = 0.4963, lr_0 = 1.5764e-04
Validation prc-auc = 0.785604
Validation auc = 0.842143
Validation accuracy = 0.785124
Validation f1 = 0.752381
Epoch 24
Loss = 1.6939e-01, PNorm = 43.0388, GNorm = 0.2503, lr_0 = 1.5436e-04
Loss = 2.0717e-01, PNorm = 43.0523, GNorm = 0.4191, lr_0 = 1.5144e-04
Loss = 2.0001e-01, PNorm = 43.0663, GNorm = 0.3969, lr_0 = 1.4857e-04
Loss = 2.1774e-01, PNorm = 43.0803, GNorm = 0.5723, lr_0 = 1.4575e-04
Validation prc-auc = 0.784364
Validation auc = 0.842454
Validation accuracy = 0.785124
Validation f1 = 0.754717
Epoch 25
Loss = 1.9347e-01, PNorm = 43.0927, GNorm = 0.3885, lr_0 = 1.4299e-04
Loss = 2.1590e-01, PNorm = 43.1042, GNorm = 0.4104, lr_0 = 1.4028e-04
Loss = 2.0545e-01, PNorm = 43.1164, GNorm = 0.3899, lr_0 = 1.3763e-04
Loss = 2.0119e-01, PNorm = 43.1283, GNorm = 0.3067, lr_0 = 1.3502e-04
Loss = 1.9382e-01, PNorm = 43.1405, GNorm = 0.3806, lr_0 = 1.3246e-04
Validation prc-auc = 0.783747
Validation auc = 0.841798
Validation accuracy = 0.789256
Validation f1 = 0.760563
Epoch 26
Loss = 2.1818e-01, PNorm = 43.1523, GNorm = 0.3023, lr_0 = 1.2995e-04
Loss = 1.7019e-01, PNorm = 43.1643, GNorm = 0.3059, lr_0 = 1.2749e-04
Loss = 1.8046e-01, PNorm = 43.1764, GNorm = 0.2978, lr_0 = 1.2508e-04
Loss = 2.3147e-01, PNorm = 43.1874, GNorm = 0.3795, lr_0 = 1.2271e-04
Validation prc-auc = 0.782647
Validation auc = 0.841176
Validation accuracy = 0.780992
Validation f1 = 0.748815
Epoch 27
Loss = 2.3058e-01, PNorm = 43.1981, GNorm = 0.4879, lr_0 = 1.2015e-04
Loss = 1.9125e-01, PNorm = 43.2090, GNorm = 0.4228, lr_0 = 1.1788e-04
Loss = 1.9070e-01, PNorm = 43.2196, GNorm = 0.4209, lr_0 = 1.1564e-04
Loss = 2.1239e-01, PNorm = 43.2293, GNorm = 0.2518, lr_0 = 1.1345e-04
Validation prc-auc = 0.785108
Validation auc = 0.841625
Validation accuracy = 0.793388
Validation f1 = 0.764151
Epoch 28
Loss = 2.6142e-01, PNorm = 43.2390, GNorm = 0.3984, lr_0 = 1.1130e-04
Loss = 1.8712e-01, PNorm = 43.2487, GNorm = 0.3373, lr_0 = 1.0920e-04
Loss = 2.0480e-01, PNorm = 43.2585, GNorm = 0.3571, lr_0 = 1.0713e-04
Loss = 2.0831e-01, PNorm = 43.2677, GNorm = 0.2862, lr_0 = 1.0510e-04
Loss = 1.7976e-01, PNorm = 43.2774, GNorm = 0.4211, lr_0 = 1.0311e-04
Validation prc-auc = 0.786196
Validation auc = 0.843387
Validation accuracy = 0.789256
Validation f1 = 0.758294
Epoch 29
Loss = 1.8583e-01, PNorm = 43.2875, GNorm = 0.3895, lr_0 = 1.0096e-04
Loss = 2.0841e-01, PNorm = 43.2964, GNorm = 0.3995, lr_0 = 1.0000e-04
Loss = 1.9998e-01, PNorm = 43.3052, GNorm = 0.3171, lr_0 = 1.0000e-04
Loss = 2.0692e-01, PNorm = 43.3140, GNorm = 0.3986, lr_0 = 1.0000e-04
Validation prc-auc = 0.785757
Validation auc = 0.842143
Validation accuracy = 0.785124
Validation f1 = 0.752381
Model 0 best validation prc-auc = 0.792099 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.787641
Model 0 test auc = 0.859761
Model 0 test accuracy = 0.784522
Model 0 test f1 = 0.740876
Ensemble test prc-auc = 0.787641
Ensemble test auc = 0.859761
Ensemble test accuracy = 0.784522
Ensemble test f1 = 0.740876
Fold 2
Splitting data with seed 2
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Epoch 0
Loss = 6.8188e-01, PNorm = 37.2320, GNorm = 0.9395, lr_0 = 2.1512e-04
Loss = 6.6167e-01, PNorm = 37.2417, GNorm = 1.1460, lr_0 = 3.1977e-04
Loss = 6.0118e-01, PNorm = 37.2619, GNorm = 0.6225, lr_0 = 4.2442e-04
Loss = 5.5708e-01, PNorm = 37.2978, GNorm = 0.5080, lr_0 = 5.2907e-04
Validation prc-auc = 0.770576
Validation auc = 0.815328
Validation accuracy = 0.714876
Validation f1 = 0.731518
Epoch 1
Loss = 5.3759e-01, PNorm = 37.3534, GNorm = 1.0640, lr_0 = 6.4419e-04
Loss = 4.6895e-01, PNorm = 37.4292, GNorm = 0.5080, lr_0 = 7.4884e-04
Loss = 4.9974e-01, PNorm = 37.5267, GNorm = 0.7152, lr_0 = 8.5349e-04
Loss = 4.6901e-01, PNorm = 37.6376, GNorm = 1.1328, lr_0 = 9.5814e-04
Validation prc-auc = 0.787686
Validation auc = 0.829718
Validation accuracy = 0.731405
Validation f1 = 0.732510
Epoch 2
Loss = 4.5492e-01, PNorm = 37.7705, GNorm = 0.4442, lr_0 = 9.8859e-04
Loss = 3.9732e-01, PNorm = 37.9169, GNorm = 0.5109, lr_0 = 9.6986e-04
Loss = 3.8859e-01, PNorm = 38.0700, GNorm = 0.3926, lr_0 = 9.5149e-04
Loss = 3.8893e-01, PNorm = 38.2167, GNorm = 0.4127, lr_0 = 9.3347e-04
Loss = 4.2583e-01, PNorm = 38.3577, GNorm = 0.5173, lr_0 = 9.1579e-04
Loss = 4.6866e-01, PNorm = 38.3704, GNorm = 1.1435, lr_0 = 9.1404e-04
Validation prc-auc = 0.824618
Validation auc = 0.849670
Validation accuracy = 0.760331
Validation f1 = 0.736364
Epoch 3
Loss = 3.1950e-01, PNorm = 38.5084, GNorm = 0.2912, lr_0 = 8.9672e-04
Loss = 3.6482e-01, PNorm = 38.6435, GNorm = 0.5647, lr_0 = 8.7974e-04
Loss = 3.7581e-01, PNorm = 38.7644, GNorm = 0.4723, lr_0 = 8.6307e-04
Loss = 3.5349e-01, PNorm = 38.8822, GNorm = 0.5095, lr_0 = 8.4672e-04
Validation prc-auc = 0.822337
Validation auc = 0.851269
Validation accuracy = 0.768595
Validation f1 = 0.743119
Epoch 4
Loss = 3.3080e-01, PNorm = 38.9946, GNorm = 0.3726, lr_0 = 8.3068e-04
Loss = 3.0913e-01, PNorm = 39.1192, GNorm = 0.4799, lr_0 = 8.1495e-04
Loss = 3.1699e-01, PNorm = 39.2405, GNorm = 0.4149, lr_0 = 7.9951e-04
Loss = 3.4330e-01, PNorm = 39.3473, GNorm = 0.4292, lr_0 = 7.8437e-04
Validation prc-auc = 0.838695
Validation auc = 0.859020
Validation accuracy = 0.764463
Validation f1 = 0.742081
Epoch 5
Loss = 2.6320e-01, PNorm = 39.4622, GNorm = 0.3521, lr_0 = 7.6804e-04
Loss = 3.0149e-01, PNorm = 39.5656, GNorm = 0.4947, lr_0 = 7.5349e-04
Loss = 3.2144e-01, PNorm = 39.6673, GNorm = 0.6603, lr_0 = 7.3921e-04
Loss = 3.1149e-01, PNorm = 39.7622, GNorm = 0.3828, lr_0 = 7.2521e-04
Loss = 2.9431e-01, PNorm = 39.8588, GNorm = 0.6807, lr_0 = 7.1147e-04
Validation prc-auc = 0.821835
Validation auc = 0.846020
Validation accuracy = 0.772727
Validation f1 = 0.739336
Epoch 6
Loss = 3.0203e-01, PNorm = 39.9569, GNorm = 0.4863, lr_0 = 6.9800e-04
Loss = 2.5918e-01, PNorm = 40.0556, GNorm = 0.3772, lr_0 = 6.8478e-04
Loss = 2.6904e-01, PNorm = 40.1483, GNorm = 0.3229, lr_0 = 6.7180e-04
Loss = 3.1354e-01, PNorm = 40.2290, GNorm = 0.3416, lr_0 = 6.5908e-04
Validation prc-auc = 0.834986
Validation auc = 0.854049
Validation accuracy = 0.768595
Validation f1 = 0.728155
Epoch 7
Loss = 2.7634e-01, PNorm = 40.3154, GNorm = 0.6229, lr_0 = 6.4536e-04
Loss = 2.5420e-01, PNorm = 40.3974, GNorm = 0.6349, lr_0 = 6.3313e-04
Loss = 3.1930e-01, PNorm = 40.4696, GNorm = 0.5308, lr_0 = 6.2114e-04
Loss = 2.8510e-01, PNorm = 40.5456, GNorm = 0.3717, lr_0 = 6.0937e-04
Validation prc-auc = 0.838054
Validation auc = 0.857525
Validation accuracy = 0.785124
Validation f1 = 0.757009
Epoch 8
Loss = 2.6340e-01, PNorm = 40.6270, GNorm = 0.4347, lr_0 = 5.9783e-04
Loss = 2.3672e-01, PNorm = 40.7080, GNorm = 0.3779, lr_0 = 5.8651e-04
Loss = 2.8407e-01, PNorm = 40.7774, GNorm = 0.3503, lr_0 = 5.7540e-04
Loss = 2.6001e-01, PNorm = 40.8449, GNorm = 0.5046, lr_0 = 5.6450e-04
Loss = 2.7940e-01, PNorm = 40.9060, GNorm = 0.3959, lr_0 = 5.5380e-04
Validation prc-auc = 0.831434
Validation auc = 0.852172
Validation accuracy = 0.785124
Validation f1 = 0.754717
Epoch 9
Loss = 2.5504e-01, PNorm = 40.9783, GNorm = 0.5683, lr_0 = 5.4227e-04
Loss = 2.4061e-01, PNorm = 41.0418, GNorm = 0.3790, lr_0 = 5.3200e-04
Loss = 2.5649e-01, PNorm = 41.0999, GNorm = 0.5738, lr_0 = 5.2192e-04
Loss = 2.5096e-01, PNorm = 41.1601, GNorm = 0.3785, lr_0 = 5.1204e-04
Validation prc-auc = 0.833068
Validation auc = 0.853528
Validation accuracy = 0.805785
Validation f1 = 0.783410
Epoch 10
Loss = 2.1873e-01, PNorm = 41.2197, GNorm = 0.4251, lr_0 = 5.0234e-04
Loss = 2.3316e-01, PNorm = 41.2752, GNorm = 0.7040, lr_0 = 4.9282e-04
Loss = 2.5995e-01, PNorm = 41.3320, GNorm = 0.3013, lr_0 = 4.8349e-04
Loss = 2.7430e-01, PNorm = 41.3866, GNorm = 0.3651, lr_0 = 4.7433e-04
Validation prc-auc = 0.826500
Validation auc = 0.848697
Validation accuracy = 0.785124
Validation f1 = 0.759259
Epoch 11
Loss = 2.0807e-01, PNorm = 41.4427, GNorm = 0.3515, lr_0 = 4.6445e-04
Loss = 2.3160e-01, PNorm = 41.4964, GNorm = 0.3974, lr_0 = 4.5566e-04
Loss = 2.4135e-01, PNorm = 41.5467, GNorm = 0.5719, lr_0 = 4.4703e-04
Loss = 2.4894e-01, PNorm = 41.5955, GNorm = 0.4131, lr_0 = 4.3856e-04
Loss = 2.4885e-01, PNorm = 41.6411, GNorm = 0.5707, lr_0 = 4.3025e-04
Validation prc-auc = 0.832535
Validation auc = 0.853285
Validation accuracy = 0.789256
Validation f1 = 0.760563
Epoch 12
Loss = 2.3284e-01, PNorm = 41.6855, GNorm = 0.4400, lr_0 = 4.2210e-04
Loss = 2.1371e-01, PNorm = 41.7342, GNorm = 0.4748, lr_0 = 4.1410e-04
Loss = 2.3716e-01, PNorm = 41.7820, GNorm = 0.6334, lr_0 = 4.0626e-04
Loss = 2.7421e-01, PNorm = 41.8239, GNorm = 0.4307, lr_0 = 3.9856e-04
Validation prc-auc = 0.828503
Validation auc = 0.849913
Validation accuracy = 0.780992
Validation f1 = 0.748815
Epoch 13
Loss = 2.0510e-01, PNorm = 41.8647, GNorm = 0.4369, lr_0 = 3.9101e-04
Loss = 2.1858e-01, PNorm = 41.9086, GNorm = 0.3897, lr_0 = 3.8361e-04
Loss = 2.3367e-01, PNorm = 41.9478, GNorm = 0.4337, lr_0 = 3.7634e-04
Loss = 2.4626e-01, PNorm = 41.9855, GNorm = 0.4621, lr_0 = 3.6921e-04
Validation prc-auc = 0.827873
Validation auc = 0.849392
Validation accuracy = 0.780992
Validation f1 = 0.748815
Epoch 14
Loss = 1.7970e-01, PNorm = 42.0268, GNorm = 0.4596, lr_0 = 3.6153e-04
Loss = 2.1514e-01, PNorm = 42.0669, GNorm = 0.4562, lr_0 = 3.5468e-04
Loss = 2.0824e-01, PNorm = 42.1048, GNorm = 0.4159, lr_0 = 3.4796e-04
Loss = 2.7087e-01, PNorm = 42.1393, GNorm = 0.3812, lr_0 = 3.4137e-04
Loss = 2.4631e-01, PNorm = 42.1729, GNorm = 0.3819, lr_0 = 3.3490e-04
Validation prc-auc = 0.835586
Validation auc = 0.854119
Validation accuracy = 0.780992
Validation f1 = 0.748815
Epoch 15
Loss = 2.3405e-01, PNorm = 42.2068, GNorm = 0.3570, lr_0 = 3.2856e-04
Loss = 2.3380e-01, PNorm = 42.2377, GNorm = 0.5936, lr_0 = 3.2233e-04
Loss = 2.5634e-01, PNorm = 42.2663, GNorm = 0.3758, lr_0 = 3.1623e-04
Loss = 2.1012e-01, PNorm = 42.2992, GNorm = 0.3754, lr_0 = 3.1024e-04
Validation prc-auc = 0.828062
Validation auc = 0.849809
Validation accuracy = 0.789256
Validation f1 = 0.767123
Epoch 16
Loss = 2.3140e-01, PNorm = 42.3353, GNorm = 0.4566, lr_0 = 3.0378e-04
Loss = 2.2394e-01, PNorm = 42.3661, GNorm = 0.4863, lr_0 = 2.9802e-04
Loss = 2.2787e-01, PNorm = 42.3949, GNorm = 0.3381, lr_0 = 2.9238e-04
Loss = 1.8204e-01, PNorm = 42.4262, GNorm = 0.2887, lr_0 = 2.8684e-04
Loss = 2.5464e-01, PNorm = 42.4529, GNorm = 0.4985, lr_0 = 2.8141e-04
Validation prc-auc = 0.827217
Validation auc = 0.848766
Validation accuracy = 0.797521
Validation f1 = 0.772093
Epoch 17
Loss = 1.8781e-01, PNorm = 42.4811, GNorm = 0.3458, lr_0 = 2.7608e-04
Loss = 2.2626e-01, PNorm = 42.5071, GNorm = 0.6490, lr_0 = 2.7085e-04
Loss = 2.2162e-01, PNorm = 42.5301, GNorm = 0.4408, lr_0 = 2.6572e-04
Loss = 2.3631e-01, PNorm = 42.5535, GNorm = 0.4376, lr_0 = 2.6068e-04
Validation prc-auc = 0.828067
Validation auc = 0.848523
Validation accuracy = 0.789256
Validation f1 = 0.758294
Epoch 18
Loss = 1.8741e-01, PNorm = 42.5809, GNorm = 0.2602, lr_0 = 2.5526e-04
Loss = 2.4231e-01, PNorm = 42.6043, GNorm = 0.7825, lr_0 = 2.5042e-04
Loss = 2.3524e-01, PNorm = 42.6267, GNorm = 0.5183, lr_0 = 2.4568e-04
Loss = 2.1444e-01, PNorm = 42.6491, GNorm = 0.3507, lr_0 = 2.4102e-04
Validation prc-auc = 0.828443
Validation auc = 0.849322
Validation accuracy = 0.793388
Validation f1 = 0.764151
Epoch 19
Loss = 1.9873e-01, PNorm = 42.6728, GNorm = 0.2369, lr_0 = 2.3646e-04
Loss = 2.1397e-01, PNorm = 42.6939, GNorm = 0.4012, lr_0 = 2.3198e-04
Loss = 2.0889e-01, PNorm = 42.7149, GNorm = 0.4729, lr_0 = 2.2758e-04
Loss = 2.3247e-01, PNorm = 42.7368, GNorm = 0.4375, lr_0 = 2.2327e-04
Loss = 2.0759e-01, PNorm = 42.7585, GNorm = 0.5255, lr_0 = 2.1904e-04
Loss = 2.1536e-01, PNorm = 42.7607, GNorm = 0.5012, lr_0 = 2.1863e-04
Validation prc-auc = 0.828848
Validation auc = 0.849114
Validation accuracy = 0.797521
Validation f1 = 0.774194
Epoch 20
Loss = 2.2474e-01, PNorm = 42.7812, GNorm = 0.4207, lr_0 = 2.1448e-04
Loss = 1.9956e-01, PNorm = 42.8009, GNorm = 0.3641, lr_0 = 2.1042e-04
Loss = 2.0853e-01, PNorm = 42.8201, GNorm = 0.3965, lr_0 = 2.0644e-04
Loss = 2.1319e-01, PNorm = 42.8407, GNorm = 0.6131, lr_0 = 2.0252e-04
Validation prc-auc = 0.830854
Validation auc = 0.851616
Validation accuracy = 0.789256
Validation f1 = 0.769231
Epoch 21
Loss = 2.0191e-01, PNorm = 42.8594, GNorm = 0.4252, lr_0 = 1.9869e-04
Loss = 1.7122e-01, PNorm = 42.8785, GNorm = 0.2243, lr_0 = 1.9492e-04
Loss = 2.4060e-01, PNorm = 42.8971, GNorm = 0.3445, lr_0 = 1.9123e-04
Loss = 2.3669e-01, PNorm = 42.9142, GNorm = 0.3725, lr_0 = 1.8761e-04
Validation prc-auc = 0.828333
Validation auc = 0.848836
Validation accuracy = 0.789256
Validation f1 = 0.758294
Epoch 22
Loss = 2.0723e-01, PNorm = 42.9316, GNorm = 0.3953, lr_0 = 1.8370e-04
Loss = 1.9746e-01, PNorm = 42.9479, GNorm = 0.4010, lr_0 = 1.8022e-04
Loss = 1.9636e-01, PNorm = 42.9646, GNorm = 0.3172, lr_0 = 1.7681e-04
Loss = 2.3521e-01, PNorm = 42.9804, GNorm = 0.3650, lr_0 = 1.7346e-04
Loss = 2.2097e-01, PNorm = 42.9952, GNorm = 0.4425, lr_0 = 1.7018e-04
Validation prc-auc = 0.829829
Validation auc = 0.849844
Validation accuracy = 0.801653
Validation f1 = 0.775701
Epoch 23
Loss = 1.9520e-01, PNorm = 43.0108, GNorm = 0.4258, lr_0 = 1.6695e-04
Loss = 2.1811e-01, PNorm = 43.0257, GNorm = 0.5947, lr_0 = 1.6379e-04
Loss = 2.0833e-01, PNorm = 43.0404, GNorm = 0.3849, lr_0 = 1.6069e-04
Loss = 2.1884e-01, PNorm = 43.0548, GNorm = 0.5117, lr_0 = 1.5764e-04
Validation prc-auc = 0.827904
Validation auc = 0.847654
Validation accuracy = 0.797521
Validation f1 = 0.769953
Epoch 24
Loss = 2.1120e-01, PNorm = 43.0697, GNorm = 0.2823, lr_0 = 1.5436e-04
Loss = 2.2318e-01, PNorm = 43.0838, GNorm = 0.6073, lr_0 = 1.5144e-04
Loss = 2.1229e-01, PNorm = 43.0961, GNorm = 0.6523, lr_0 = 1.4857e-04
Loss = 1.8650e-01, PNorm = 43.1095, GNorm = 0.4180, lr_0 = 1.4575e-04
Validation prc-auc = 0.828362
Validation auc = 0.848175
Validation accuracy = 0.797521
Validation f1 = 0.769953
Epoch 25
Loss = 2.2411e-01, PNorm = 43.1231, GNorm = 0.3662, lr_0 = 1.4299e-04
Loss = 1.9903e-01, PNorm = 43.1358, GNorm = 0.3211, lr_0 = 1.4028e-04
Loss = 1.9013e-01, PNorm = 43.1487, GNorm = 0.2627, lr_0 = 1.3763e-04
Loss = 1.8255e-01, PNorm = 43.1628, GNorm = 0.5355, lr_0 = 1.3502e-04
Loss = 2.4527e-01, PNorm = 43.1744, GNorm = 0.2963, lr_0 = 1.3246e-04
Validation prc-auc = 0.826118
Validation auc = 0.847758
Validation accuracy = 0.797521
Validation f1 = 0.772093
Epoch 26
Loss = 2.0317e-01, PNorm = 43.1850, GNorm = 0.4313, lr_0 = 1.2995e-04
Loss = 2.1146e-01, PNorm = 43.1972, GNorm = 0.4333, lr_0 = 1.2749e-04
Loss = 2.1280e-01, PNorm = 43.2080, GNorm = 0.4434, lr_0 = 1.2508e-04
Loss = 1.9755e-01, PNorm = 43.2186, GNorm = 0.3284, lr_0 = 1.2271e-04
Validation prc-auc = 0.828909
Validation auc = 0.848905
Validation accuracy = 0.789256
Validation f1 = 0.758294
Epoch 27
Loss = 2.0659e-01, PNorm = 43.2305, GNorm = 0.3081, lr_0 = 1.2015e-04
Loss = 1.8046e-01, PNorm = 43.2411, GNorm = 0.4279, lr_0 = 1.1788e-04
Loss = 2.1617e-01, PNorm = 43.2516, GNorm = 0.4912, lr_0 = 1.1564e-04
Loss = 2.1320e-01, PNorm = 43.2613, GNorm = 0.3213, lr_0 = 1.1345e-04
Validation prc-auc = 0.825759
Validation auc = 0.846820
Validation accuracy = 0.797521
Validation f1 = 0.769953
Epoch 28
Loss = 2.3305e-01, PNorm = 43.2718, GNorm = 0.3648, lr_0 = 1.1130e-04
Loss = 1.8916e-01, PNorm = 43.2827, GNorm = 0.3686, lr_0 = 1.0920e-04
Loss = 2.0905e-01, PNorm = 43.2921, GNorm = 0.3389, lr_0 = 1.0713e-04
Loss = 1.9432e-01, PNorm = 43.3019, GNorm = 0.2870, lr_0 = 1.0510e-04
Loss = 2.2892e-01, PNorm = 43.3119, GNorm = 0.5579, lr_0 = 1.0311e-04
Validation prc-auc = 0.828901
Validation auc = 0.849009
Validation accuracy = 0.801653
Validation f1 = 0.777778
Epoch 29
Loss = 1.8890e-01, PNorm = 43.3232, GNorm = 0.3985, lr_0 = 1.0096e-04
Loss = 2.3008e-01, PNorm = 43.3324, GNorm = 0.3781, lr_0 = 1.0000e-04
Loss = 1.8574e-01, PNorm = 43.3418, GNorm = 0.3924, lr_0 = 1.0000e-04
Loss = 2.1074e-01, PNorm = 43.3506, GNorm = 0.4896, lr_0 = 1.0000e-04
Validation prc-auc = 0.827783
Validation auc = 0.847897
Validation accuracy = 0.801653
Validation f1 = 0.775701
Model 0 best validation prc-auc = 0.838695 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.794706
Model 0 test auc = 0.862244
Model 0 test accuracy = 0.789074
Model 0 test f1 = 0.750449
Ensemble test prc-auc = 0.794706
Ensemble test auc = 0.862244
Ensemble test accuracy = 0.789074
Ensemble test f1 = 0.750449
Fold 3
Splitting data with seed 3
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Epoch 0
Loss = 6.8612e-01, PNorm = 37.2319, GNorm = 1.0278, lr_0 = 2.1512e-04
Loss = 6.2605e-01, PNorm = 37.2435, GNorm = 0.8822, lr_0 = 3.1977e-04
Loss = 6.0955e-01, PNorm = 37.2647, GNorm = 1.3642, lr_0 = 4.2442e-04
Loss = 5.8163e-01, PNorm = 37.2940, GNorm = 0.5660, lr_0 = 5.2907e-04
Validation prc-auc = 0.813202
Validation auc = 0.807063
Validation accuracy = 0.719008
Validation f1 = 0.701754
Epoch 1
Loss = 4.8344e-01, PNorm = 37.3542, GNorm = 0.7870, lr_0 = 6.4419e-04
Loss = 4.6123e-01, PNorm = 37.4319, GNorm = 0.5583, lr_0 = 7.4884e-04
Loss = 4.8920e-01, PNorm = 37.5203, GNorm = 1.0474, lr_0 = 8.5349e-04
Loss = 4.7620e-01, PNorm = 37.6343, GNorm = 0.4838, lr_0 = 9.5814e-04
Validation prc-auc = 0.840108
Validation auc = 0.832680
Validation accuracy = 0.714876
Validation f1 = 0.698690
Epoch 2
Loss = 4.0617e-01, PNorm = 37.7617, GNorm = 0.5626, lr_0 = 9.8859e-04
Loss = 4.0042e-01, PNorm = 37.9105, GNorm = 0.6336, lr_0 = 9.6986e-04
Loss = 4.1863e-01, PNorm = 38.0510, GNorm = 0.3699, lr_0 = 9.5149e-04
Loss = 4.0914e-01, PNorm = 38.1846, GNorm = 0.5990, lr_0 = 9.3347e-04
Loss = 4.1391e-01, PNorm = 38.3175, GNorm = 0.7002, lr_0 = 9.1579e-04
Loss = 3.7014e-01, PNorm = 38.3301, GNorm = 0.5255, lr_0 = 9.1404e-04
Validation prc-auc = 0.857779
Validation auc = 0.848532
Validation accuracy = 0.760331
Validation f1 = 0.766129
Epoch 3
Loss = 3.4197e-01, PNorm = 38.4647, GNorm = 0.5166, lr_0 = 8.9672e-04
Loss = 3.7046e-01, PNorm = 38.5966, GNorm = 0.3813, lr_0 = 8.7974e-04
Loss = 3.5128e-01, PNorm = 38.7247, GNorm = 0.3676, lr_0 = 8.6307e-04
Loss = 3.7196e-01, PNorm = 38.8539, GNorm = 0.3699, lr_0 = 8.4672e-04
Validation prc-auc = 0.866016
Validation auc = 0.857953
Validation accuracy = 0.785124
Validation f1 = 0.805970
Epoch 4
Loss = 3.0720e-01, PNorm = 38.9778, GNorm = 0.5523, lr_0 = 8.3068e-04
Loss = 3.0210e-01, PNorm = 39.1080, GNorm = 0.7676, lr_0 = 8.1495e-04
Loss = 3.0469e-01, PNorm = 39.2271, GNorm = 0.4131, lr_0 = 7.9951e-04
Loss = 3.4018e-01, PNorm = 39.3340, GNorm = 0.3751, lr_0 = 7.8437e-04
Validation prc-auc = 0.858995
Validation auc = 0.853621
Validation accuracy = 0.793388
Validation f1 = 0.810606
Epoch 5
Loss = 3.0916e-01, PNorm = 39.4370, GNorm = 0.2982, lr_0 = 7.6804e-04
Loss = 2.9348e-01, PNorm = 39.5474, GNorm = 0.3386, lr_0 = 7.5349e-04
Loss = 3.1429e-01, PNorm = 39.6511, GNorm = 0.4646, lr_0 = 7.3921e-04
Loss = 3.0826e-01, PNorm = 39.7526, GNorm = 0.4211, lr_0 = 7.2521e-04
Loss = 3.1376e-01, PNorm = 39.8452, GNorm = 0.3908, lr_0 = 7.1147e-04
Validation prc-auc = 0.867637
Validation auc = 0.863180
Validation accuracy = 0.793388
Validation f1 = 0.807692
Epoch 6
Loss = 2.5852e-01, PNorm = 39.9484, GNorm = 0.3624, lr_0 = 6.9800e-04
Loss = 2.9002e-01, PNorm = 40.0431, GNorm = 0.4057, lr_0 = 6.8478e-04
Loss = 2.8315e-01, PNorm = 40.1363, GNorm = 0.3515, lr_0 = 6.7180e-04
Loss = 3.2359e-01, PNorm = 40.2250, GNorm = 0.4447, lr_0 = 6.5908e-04
Validation prc-auc = 0.856624
Validation auc = 0.852555
Validation accuracy = 0.785124
Validation f1 = 0.800000
Epoch 7
Loss = 2.6771e-01, PNorm = 40.3186, GNorm = 0.3490, lr_0 = 6.4536e-04
Loss = 2.4274e-01, PNorm = 40.4082, GNorm = 0.3514, lr_0 = 6.3313e-04
Loss = 2.7227e-01, PNorm = 40.4886, GNorm = 0.4413, lr_0 = 6.2114e-04
Loss = 3.1460e-01, PNorm = 40.5685, GNorm = 0.6080, lr_0 = 6.0937e-04
Validation prc-auc = 0.862075
Validation auc = 0.861598
Validation accuracy = 0.789256
Validation f1 = 0.806084
Epoch 8
Loss = 2.6885e-01, PNorm = 40.6442, GNorm = 0.3480, lr_0 = 5.9783e-04
Loss = 2.5450e-01, PNorm = 40.7264, GNorm = 0.3983, lr_0 = 5.8651e-04
Loss = 2.4201e-01, PNorm = 40.8039, GNorm = 0.3310, lr_0 = 5.7540e-04
Loss = 2.6487e-01, PNorm = 40.8778, GNorm = 0.5852, lr_0 = 5.6450e-04
Loss = 2.7665e-01, PNorm = 40.9499, GNorm = 0.3397, lr_0 = 5.5380e-04
Validation prc-auc = 0.859601
Validation auc = 0.860670
Validation accuracy = 0.756198
Validation f1 = 0.757202
Epoch 9
Loss = 2.5521e-01, PNorm = 41.0271, GNorm = 0.2933, lr_0 = 5.4227e-04
Loss = 2.5819e-01, PNorm = 41.0954, GNorm = 0.2981, lr_0 = 5.3200e-04
Loss = 2.4329e-01, PNorm = 41.1652, GNorm = 0.3811, lr_0 = 5.2192e-04
Loss = 2.8148e-01, PNorm = 41.2299, GNorm = 0.4214, lr_0 = 5.1204e-04
Validation prc-auc = 0.858411
Validation auc = 0.858607
Validation accuracy = 0.785124
Validation f1 = 0.798450
Epoch 10
Loss = 2.3125e-01, PNorm = 41.2912, GNorm = 0.4795, lr_0 = 5.0234e-04
Loss = 2.1691e-01, PNorm = 41.3516, GNorm = 0.4383, lr_0 = 4.9282e-04
Loss = 2.3959e-01, PNorm = 41.4050, GNorm = 0.3372, lr_0 = 4.8349e-04
Loss = 2.7227e-01, PNorm = 41.4551, GNorm = 0.3178, lr_0 = 4.7433e-04
Validation prc-auc = 0.863041
Validation auc = 0.864074
Validation accuracy = 0.793388
Validation f1 = 0.806202
Epoch 11
Loss = 1.7908e-01, PNorm = 41.5159, GNorm = 0.3699, lr_0 = 4.6445e-04
Loss = 2.3319e-01, PNorm = 41.5744, GNorm = 0.5100, lr_0 = 4.5566e-04
Loss = 2.4694e-01, PNorm = 41.6297, GNorm = 0.4308, lr_0 = 4.4703e-04
Loss = 2.5909e-01, PNorm = 41.6804, GNorm = 0.3233, lr_0 = 4.3856e-04
Loss = 2.3606e-01, PNorm = 41.7265, GNorm = 0.3109, lr_0 = 4.3025e-04
Validation prc-auc = 0.860431
Validation auc = 0.862148
Validation accuracy = 0.793388
Validation f1 = 0.804688
Epoch 12
Loss = 2.2119e-01, PNorm = 41.7763, GNorm = 0.3988, lr_0 = 4.2210e-04
Loss = 2.1646e-01, PNorm = 41.8243, GNorm = 0.5590, lr_0 = 4.1410e-04
Loss = 2.3511e-01, PNorm = 41.8740, GNorm = 0.3459, lr_0 = 4.0626e-04
Loss = 2.5739e-01, PNorm = 41.9225, GNorm = 0.7107, lr_0 = 3.9856e-04
Validation prc-auc = 0.858682
Validation auc = 0.861942
Validation accuracy = 0.793388
Validation f1 = 0.806202
Epoch 13
Loss = 2.1444e-01, PNorm = 41.9638, GNorm = 0.3642, lr_0 = 3.9101e-04
Loss = 2.1339e-01, PNorm = 42.0056, GNorm = 0.4988, lr_0 = 3.8361e-04
Loss = 2.1667e-01, PNorm = 42.0475, GNorm = 0.3075, lr_0 = 3.7634e-04
Loss = 2.4327e-01, PNorm = 42.0889, GNorm = 0.2832, lr_0 = 3.6921e-04
Validation prc-auc = 0.862845
Validation auc = 0.864934
Validation accuracy = 0.772727
Validation f1 = 0.777328
Epoch 14
Loss = 2.1212e-01, PNorm = 42.1304, GNorm = 0.3287, lr_0 = 3.6153e-04
Loss = 2.0381e-01, PNorm = 42.1702, GNorm = 0.4159, lr_0 = 3.5468e-04
Loss = 2.3779e-01, PNorm = 42.2092, GNorm = 0.2818, lr_0 = 3.4796e-04
Loss = 2.1492e-01, PNorm = 42.2444, GNorm = 0.4945, lr_0 = 3.4137e-04
Loss = 2.4911e-01, PNorm = 42.2780, GNorm = 0.3181, lr_0 = 3.3490e-04
Validation prc-auc = 0.861959
Validation auc = 0.863765
Validation accuracy = 0.789256
Validation f1 = 0.800000
Epoch 15
Loss = 2.1648e-01, PNorm = 42.3114, GNorm = 0.3249, lr_0 = 3.2856e-04
Loss = 2.1236e-01, PNorm = 42.3458, GNorm = 0.5393, lr_0 = 3.2233e-04
Loss = 2.3142e-01, PNorm = 42.3764, GNorm = 0.3049, lr_0 = 3.1623e-04
Loss = 2.2692e-01, PNorm = 42.4084, GNorm = 0.3819, lr_0 = 3.1024e-04
Validation prc-auc = 0.860269
Validation auc = 0.862355
Validation accuracy = 0.793388
Validation f1 = 0.806202
Epoch 16
Loss = 1.4878e-01, PNorm = 42.4429, GNorm = 0.3351, lr_0 = 3.0378e-04
Loss = 2.1392e-01, PNorm = 42.4747, GNorm = 0.4506, lr_0 = 2.9802e-04
Loss = 1.9908e-01, PNorm = 42.5064, GNorm = 0.5926, lr_0 = 2.9238e-04
Loss = 2.1946e-01, PNorm = 42.5363, GNorm = 0.5471, lr_0 = 2.8684e-04
Loss = 2.8039e-01, PNorm = 42.5622, GNorm = 0.5996, lr_0 = 2.8141e-04
Validation prc-auc = 0.862742
Validation auc = 0.864899
Validation accuracy = 0.789256
Validation f1 = 0.801556
Epoch 17
Loss = 2.1710e-01, PNorm = 42.5876, GNorm = 0.2638, lr_0 = 2.7608e-04
Loss = 2.3341e-01, PNorm = 42.6142, GNorm = 0.4131, lr_0 = 2.7085e-04
Loss = 2.1943e-01, PNorm = 42.6400, GNorm = 0.3707, lr_0 = 2.6572e-04
Loss = 1.9913e-01, PNorm = 42.6657, GNorm = 0.4619, lr_0 = 2.6068e-04
Validation prc-auc = 0.865221
Validation auc = 0.867341
Validation accuracy = 0.793388
Validation f1 = 0.806202
Epoch 18
Loss = 2.0112e-01, PNorm = 42.6976, GNorm = 0.3213, lr_0 = 2.5526e-04
Loss = 2.2829e-01, PNorm = 42.7236, GNorm = 0.5951, lr_0 = 2.5042e-04
Loss = 2.0656e-01, PNorm = 42.7483, GNorm = 0.5059, lr_0 = 2.4568e-04
Loss = 2.0102e-01, PNorm = 42.7723, GNorm = 0.4487, lr_0 = 2.4102e-04
Validation prc-auc = 0.865175
Validation auc = 0.867066
Validation accuracy = 0.789256
Validation f1 = 0.801556
Epoch 19
Loss = 1.5051e-01, PNorm = 42.7944, GNorm = 0.3335, lr_0 = 2.3646e-04
Loss = 2.1310e-01, PNorm = 42.8172, GNorm = 0.3925, lr_0 = 2.3198e-04
Loss = 2.3779e-01, PNorm = 42.8395, GNorm = 0.5555, lr_0 = 2.2758e-04
Loss = 1.9251e-01, PNorm = 42.8613, GNorm = 0.3860, lr_0 = 2.2327e-04
Loss = 2.1873e-01, PNorm = 42.8825, GNorm = 0.3565, lr_0 = 2.1904e-04
Loss = 4.0345e-01, PNorm = 42.8845, GNorm = 0.7685, lr_0 = 2.1863e-04
Validation prc-auc = 0.862012
Validation auc = 0.864865
Validation accuracy = 0.797521
Validation f1 = 0.809339
Epoch 20
Loss = 1.9817e-01, PNorm = 42.9048, GNorm = 0.3983, lr_0 = 2.1448e-04
Loss = 2.1696e-01, PNorm = 42.9249, GNorm = 0.3071, lr_0 = 2.1042e-04
Loss = 2.1246e-01, PNorm = 42.9439, GNorm = 0.3324, lr_0 = 2.0644e-04
Loss = 2.2381e-01, PNorm = 42.9636, GNorm = 0.3999, lr_0 = 2.0252e-04
Validation prc-auc = 0.862653
Validation auc = 0.866068
Validation accuracy = 0.797521
Validation f1 = 0.809339
Epoch 21
Loss = 1.9150e-01, PNorm = 42.9835, GNorm = 0.5129, lr_0 = 1.9869e-04
Loss = 2.0683e-01, PNorm = 43.0030, GNorm = 0.2427, lr_0 = 1.9492e-04
Loss = 2.1707e-01, PNorm = 43.0206, GNorm = 0.3975, lr_0 = 1.9123e-04
Loss = 2.0348e-01, PNorm = 43.0397, GNorm = 0.4777, lr_0 = 1.8761e-04
Validation prc-auc = 0.861905
Validation auc = 0.864659
Validation accuracy = 0.789256
Validation f1 = 0.801556
Epoch 22
Loss = 1.7449e-01, PNorm = 43.0583, GNorm = 0.2381, lr_0 = 1.8370e-04
Loss = 1.8582e-01, PNorm = 43.0760, GNorm = 0.4124, lr_0 = 1.8022e-04
Loss = 2.2156e-01, PNorm = 43.0938, GNorm = 0.5271, lr_0 = 1.7681e-04
Loss = 2.2203e-01, PNorm = 43.1094, GNorm = 0.4517, lr_0 = 1.7346e-04
Loss = 2.1176e-01, PNorm = 43.1242, GNorm = 0.3840, lr_0 = 1.7018e-04
Validation prc-auc = 0.862788
Validation auc = 0.864659
Validation accuracy = 0.793388
Validation f1 = 0.806202
Epoch 23
Loss = 1.8801e-01, PNorm = 43.1399, GNorm = 0.4125, lr_0 = 1.6695e-04
Loss = 1.8567e-01, PNorm = 43.1560, GNorm = 0.3921, lr_0 = 1.6379e-04
Loss = 2.1743e-01, PNorm = 43.1728, GNorm = 0.3998, lr_0 = 1.6069e-04
Loss = 2.1646e-01, PNorm = 43.1884, GNorm = 0.4769, lr_0 = 1.5764e-04
Validation prc-auc = 0.860433
Validation auc = 0.863868
Validation accuracy = 0.789256
Validation f1 = 0.801556
Epoch 24
Loss = 2.0521e-01, PNorm = 43.2030, GNorm = 0.5460, lr_0 = 1.5436e-04
Loss = 2.0314e-01, PNorm = 43.2170, GNorm = 0.3871, lr_0 = 1.5144e-04
Loss = 1.8820e-01, PNorm = 43.2307, GNorm = 0.3432, lr_0 = 1.4857e-04
Loss = 2.2780e-01, PNorm = 43.2445, GNorm = 0.3159, lr_0 = 1.4575e-04
Validation prc-auc = 0.864049
Validation auc = 0.866653
Validation accuracy = 0.793388
Validation f1 = 0.806202
Epoch 25
Loss = 2.8511e-01, PNorm = 43.2575, GNorm = 0.3731, lr_0 = 1.4299e-04
Loss = 1.9147e-01, PNorm = 43.2702, GNorm = 0.2416, lr_0 = 1.4028e-04
Loss = 1.9845e-01, PNorm = 43.2830, GNorm = 0.4032, lr_0 = 1.3763e-04
Loss = 2.0664e-01, PNorm = 43.2960, GNorm = 0.6928, lr_0 = 1.3502e-04
Loss = 2.0019e-01, PNorm = 43.3087, GNorm = 0.4088, lr_0 = 1.3246e-04
Validation prc-auc = 0.863818
Validation auc = 0.865725
Validation accuracy = 0.793388
Validation f1 = 0.803150
Epoch 26
Loss = 1.8249e-01, PNorm = 43.3222, GNorm = 0.3326, lr_0 = 1.2995e-04
Loss = 2.0222e-01, PNorm = 43.3353, GNorm = 0.4102, lr_0 = 1.2749e-04
Loss = 2.0724e-01, PNorm = 43.3469, GNorm = 0.3036, lr_0 = 1.2508e-04
Loss = 1.8939e-01, PNorm = 43.3592, GNorm = 0.3547, lr_0 = 1.2271e-04
Validation prc-auc = 0.863067
Validation auc = 0.864865
Validation accuracy = 0.793388
Validation f1 = 0.806202
Epoch 27
Loss = 1.7969e-01, PNorm = 43.3711, GNorm = 0.3711, lr_0 = 1.2015e-04
Loss = 1.9570e-01, PNorm = 43.3820, GNorm = 0.3747, lr_0 = 1.1788e-04
Loss = 2.1235e-01, PNorm = 43.3928, GNorm = 0.3258, lr_0 = 1.1564e-04
Loss = 2.0285e-01, PNorm = 43.4032, GNorm = 0.3485, lr_0 = 1.1345e-04
Validation prc-auc = 0.863442
Validation auc = 0.865037
Validation accuracy = 0.793388
Validation f1 = 0.806202
Epoch 28
Loss = 1.2721e-01, PNorm = 43.4140, GNorm = 0.2939, lr_0 = 1.1130e-04
Loss = 1.7229e-01, PNorm = 43.4246, GNorm = 0.3477, lr_0 = 1.0920e-04
Loss = 2.2547e-01, PNorm = 43.4354, GNorm = 0.4562, lr_0 = 1.0713e-04
Loss = 2.1141e-01, PNorm = 43.4447, GNorm = 0.4022, lr_0 = 1.0510e-04
Loss = 1.9890e-01, PNorm = 43.4542, GNorm = 0.3337, lr_0 = 1.0311e-04
Validation prc-auc = 0.863763
Validation auc = 0.865656
Validation accuracy = 0.793388
Validation f1 = 0.804688
Epoch 29
Loss = 2.0247e-01, PNorm = 43.4649, GNorm = 0.4190, lr_0 = 1.0096e-04
Loss = 2.1173e-01, PNorm = 43.4738, GNorm = 0.3444, lr_0 = 1.0000e-04
Loss = 1.7963e-01, PNorm = 43.4832, GNorm = 0.3283, lr_0 = 1.0000e-04
Loss = 2.0403e-01, PNorm = 43.4925, GNorm = 0.4196, lr_0 = 1.0000e-04
Validation prc-auc = 0.863578
Validation auc = 0.865415
Validation accuracy = 0.793388
Validation f1 = 0.804688
Model 0 best validation prc-auc = 0.867637 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.791480
Model 0 test auc = 0.860752
Model 0 test accuracy = 0.787557
Model 0 test f1 = 0.738806
Ensemble test prc-auc = 0.791480
Ensemble test auc = 0.860752
Ensemble test accuracy = 0.787557
Ensemble test f1 = 0.738806
Fold 4
Splitting data with seed 4
Class sizes
fluor 0: 52.42%, 1: 47.58%
Total size = 2,419 | train size = 2,177 | val size = 242 | test size = 659
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2348, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 969,601
Epoch 0
Loss = 6.9272e-01, PNorm = 37.2316, GNorm = 0.5670, lr_0 = 2.1512e-04
Loss = 6.3303e-01, PNorm = 37.2426, GNorm = 0.7967, lr_0 = 3.1977e-04
Loss = 6.0812e-01, PNorm = 37.2640, GNorm = 0.4670, lr_0 = 4.2442e-04
Loss = 5.5287e-01, PNorm = 37.3010, GNorm = 1.5616, lr_0 = 5.2907e-04
Validation prc-auc = 0.755442
Validation auc = 0.799760
Validation accuracy = 0.710744
Validation f1 = 0.751773
Epoch 1
Loss = 4.6053e-01, PNorm = 37.3614, GNorm = 0.6982, lr_0 = 6.4419e-04
Loss = 4.7738e-01, PNorm = 37.4427, GNorm = 0.5539, lr_0 = 7.4884e-04
Loss = 5.1177e-01, PNorm = 37.5350, GNorm = 0.4406, lr_0 = 8.5349e-04
Loss = 4.5343e-01, PNorm = 37.6514, GNorm = 0.5678, lr_0 = 9.5814e-04
Validation prc-auc = 0.783311
Validation auc = 0.835262
Validation accuracy = 0.731405
Validation f1 = 0.725738
Epoch 2
Loss = 4.0351e-01, PNorm = 37.7902, GNorm = 0.5134, lr_0 = 9.8859e-04
Loss = 3.7534e-01, PNorm = 37.9453, GNorm = 0.4160, lr_0 = 9.6986e-04
Loss = 4.0694e-01, PNorm = 38.0887, GNorm = 0.4380, lr_0 = 9.5149e-04
Loss = 3.8592e-01, PNorm = 38.2171, GNorm = 0.8711, lr_0 = 9.3347e-04
Loss = 4.2701e-01, PNorm = 38.3347, GNorm = 0.5045, lr_0 = 9.1579e-04
Loss = 4.2999e-01, PNorm = 38.3467, GNorm = 0.6449, lr_0 = 9.1404e-04
Validation prc-auc = 0.803286
Validation auc = 0.844848
Validation accuracy = 0.756198
Validation f1 = 0.748936
Epoch 3
Loss = 3.2539e-01, PNorm = 38.4818, GNorm = 0.3218, lr_0 = 8.9672e-04
Loss = 3.3355e-01, PNorm = 38.6276, GNorm = 0.5843, lr_0 = 8.7974e-04
Loss = 3.8277e-01, PNorm = 38.7569, GNorm = 0.5451, lr_0 = 8.6307e-04
Loss = 3.6407e-01, PNorm = 38.8633, GNorm = 0.6071, lr_0 = 8.4672e-04
Validation prc-auc = 0.800996
Validation auc = 0.838993
Validation accuracy = 0.756198
Validation f1 = 0.746781
Epoch 4
Loss = 3.2742e-01, PNorm = 38.9808, GNorm = 0.3055, lr_0 = 8.3068e-04
Loss = 3.1562e-01, PNorm = 39.1023, GNorm = 0.7466, lr_0 = 8.1495e-04
Loss = 3.1181e-01, PNorm = 39.2186, GNorm = 0.3190, lr_0 = 7.9951e-04
Loss = 3.4921e-01, PNorm = 39.3231, GNorm = 0.5844, lr_0 = 7.8437e-04
Validation prc-auc = 0.803154
Validation auc = 0.843889
Validation accuracy = 0.752066
Validation f1 = 0.756098
Epoch 5
Loss = 3.0029e-01, PNorm = 39.4485, GNorm = 0.4411, lr_0 = 7.6804e-04
Loss = 3.0660e-01, PNorm = 39.5572, GNorm = 0.3372, lr_0 = 7.5349e-04
Loss = 2.9523e-01, PNorm = 39.6619, GNorm = 0.7596, lr_0 = 7.3921e-04
Loss = 2.9224e-01, PNorm = 39.7606, GNorm = 0.5036, lr_0 = 7.2521e-04
Loss = 3.0258e-01, PNorm = 39.8566, GNorm = 0.3118, lr_0 = 7.1147e-04
Validation prc-auc = 0.814231
Validation auc = 0.849469
Validation accuracy = 0.747934
Validation f1 = 0.735931
Epoch 6
Loss = 2.8448e-01, PNorm = 39.9519, GNorm = 0.5143, lr_0 = 6.9800e-04
Loss = 2.5723e-01, PNorm = 40.0472, GNorm = 0.4162, lr_0 = 6.8478e-04
Loss = 2.7343e-01, PNorm = 40.1391, GNorm = 0.4301, lr_0 = 6.7180e-04
Loss = 3.0147e-01, PNorm = 40.2231, GNorm = 0.5989, lr_0 = 6.5908e-04
Validation prc-auc = 0.826952
Validation auc = 0.849641
Validation accuracy = 0.772727
Validation f1 = 0.757709
Epoch 7
Loss = 2.7203e-01, PNorm = 40.3166, GNorm = 0.4589, lr_0 = 6.4536e-04
Loss = 2.6156e-01, PNorm = 40.4034, GNorm = 0.4175, lr_0 = 6.3313e-04
Loss = 2.7409e-01, PNorm = 40.4789, GNorm = 0.4502, lr_0 = 6.2114e-04
Loss = 2.6726e-01, PNorm = 40.5536, GNorm = 0.3914, lr_0 = 6.0937e-04
Validation prc-auc = 0.812106
Validation auc = 0.839336
Validation accuracy = 0.756198
Validation f1 = 0.737778
Epoch 8
Loss = 2.4994e-01, PNorm = 40.6268, GNorm = 0.4362, lr_0 = 5.9783e-04
Loss = 2.2871e-01, PNorm = 40.7010, GNorm = 0.4114, lr_0 = 5.8651e-04
Loss = 2.8267e-01, PNorm = 40.7734, GNorm = 0.4528, lr_0 = 5.7540e-04
Loss = 2.6691e-01, PNorm = 40.8388, GNorm = 0.3102, lr_0 = 5.6450e-04
Loss = 2.5625e-01, PNorm = 40.9090, GNorm = 0.5695, lr_0 = 5.5380e-04
Validation prc-auc = 0.808443
Validation auc = 0.839302
Validation accuracy = 0.764463
Validation f1 = 0.753247
Epoch 9
Loss = 2.4430e-01, PNorm = 40.9833, GNorm = 0.3907, lr_0 = 5.4227e-04
Loss = 2.7990e-01, PNorm = 41.0490, GNorm = 0.3939, lr_0 = 5.3200e-04
Loss = 2.5931e-01, PNorm = 41.1099, GNorm = 0.4298, lr_0 = 5.2192e-04
Loss = 2.3872e-01, PNorm = 41.1679, GNorm = 0.4868, lr_0 = 5.1204e-04
Validation prc-auc = 0.810930
Validation auc = 0.843341
Validation accuracy = 0.760331
Validation f1 = 0.741071
Epoch 10
Loss = 1.9651e-01, PNorm = 41.2260, GNorm = 0.6094, lr_0 = 5.0234e-04
Loss = 2.2794e-01, PNorm = 41.2813, GNorm = 0.2864, lr_0 = 4.9282e-04
Loss = 2.2980e-01, PNorm = 41.3379, GNorm = 0.4434, lr_0 = 4.8349e-04
Loss = 2.7930e-01, PNorm = 41.3915, GNorm = 0.4259, lr_0 = 4.7433e-04
Validation prc-auc = 0.813134
Validation auc = 0.846388
Validation accuracy = 0.768595
Validation f1 = 0.756522
Epoch 11
Loss = 2.0866e-01, PNorm = 41.4495, GNorm = 0.3732, lr_0 = 4.6445e-04
Loss = 2.6236e-01, PNorm = 41.5014, GNorm = 0.4414, lr_0 = 4.5566e-04
Loss = 2.4236e-01, PNorm = 41.5528, GNorm = 0.6647, lr_0 = 4.4703e-04
Loss = 2.2415e-01, PNorm = 41.6024, GNorm = 0.4234, lr_0 = 4.3856e-04
Loss = 2.3596e-01, PNorm = 41.6514, GNorm = 0.4440, lr_0 = 4.3025e-04
Validation prc-auc = 0.811941
Validation auc = 0.844403
Validation accuracy = 0.764463
Validation f1 = 0.753247
Epoch 12
Loss = 2.2827e-01, PNorm = 41.6976, GNorm = 0.3038, lr_0 = 4.2210e-04
Loss = 2.3692e-01, PNorm = 41.7441, GNorm = 0.4209, lr_0 = 4.1410e-04
Loss = 2.3411e-01, PNorm = 41.7864, GNorm = 0.3400, lr_0 = 4.0626e-04
Loss = 2.0522e-01, PNorm = 41.8310, GNorm = 0.2787, lr_0 = 3.9856e-04
Validation prc-auc = 0.808421
Validation auc = 0.842794
Validation accuracy = 0.768595
Validation f1 = 0.747748
Epoch 13
Loss = 2.0607e-01, PNorm = 41.8715, GNorm = 0.4506, lr_0 = 3.9101e-04
Loss = 1.9435e-01, PNorm = 41.9110, GNorm = 0.3574, lr_0 = 3.8361e-04
Loss = 2.4342e-01, PNorm = 41.9495, GNorm = 0.3984, lr_0 = 3.7634e-04
Loss = 2.6226e-01, PNorm = 41.9859, GNorm = 0.3676, lr_0 = 3.6921e-04
Validation prc-auc = 0.818915
Validation auc = 0.846628
Validation accuracy = 0.760331
Validation f1 = 0.741071
Epoch 14
Loss = 2.6859e-01, PNorm = 42.0277, GNorm = 0.4771, lr_0 = 3.6153e-04
Loss = 2.0703e-01, PNorm = 42.0649, GNorm = 0.4174, lr_0 = 3.5468e-04
Loss = 2.3595e-01, PNorm = 42.1005, GNorm = 0.3565, lr_0 = 3.4796e-04
Loss = 2.0433e-01, PNorm = 42.1362, GNorm = 0.3274, lr_0 = 3.4137e-04
Loss = 2.2719e-01, PNorm = 42.1696, GNorm = 0.3536, lr_0 = 3.3490e-04
Validation prc-auc = 0.815285
Validation auc = 0.846868
Validation accuracy = 0.768595
Validation f1 = 0.747748
Epoch 15
Loss = 2.3713e-01, PNorm = 42.1966, GNorm = 0.4531, lr_0 = 3.2856e-04
Loss = 2.2375e-01, PNorm = 42.2250, GNorm = 0.2953, lr_0 = 3.2233e-04
Loss = 2.1509e-01, PNorm = 42.2580, GNorm = 0.4104, lr_0 = 3.1623e-04
Loss = 2.0791e-01, PNorm = 42.2885, GNorm = 0.3295, lr_0 = 3.1024e-04
Validation prc-auc = 0.809663
Validation auc = 0.845224
Validation accuracy = 0.772727
Validation f1 = 0.751131
Epoch 16
Loss = 2.3153e-01, PNorm = 42.3230, GNorm = 0.3095, lr_0 = 3.0378e-04
Loss = 2.5255e-01, PNorm = 42.3523, GNorm = 0.3385, lr_0 = 2.9802e-04
Loss = 1.7184e-01, PNorm = 42.3811, GNorm = 0.2501, lr_0 = 2.9238e-04
Loss = 2.3323e-01, PNorm = 42.4098, GNorm = 0.3923, lr_0 = 2.8684e-04
Loss = 2.0072e-01, PNorm = 42.4373, GNorm = 0.2353, lr_0 = 2.8141e-04
Validation prc-auc = 0.809392
Validation auc = 0.841869
Validation accuracy = 0.764463
Validation f1 = 0.744395
Epoch 17
Loss = 2.2553e-01, PNorm = 42.4649, GNorm = 0.2956, lr_0 = 2.7608e-04
Loss = 2.0047e-01, PNorm = 42.4917, GNorm = 0.3264, lr_0 = 2.7085e-04
Loss = 2.0442e-01, PNorm = 42.5179, GNorm = 0.5459, lr_0 = 2.6572e-04
Loss = 2.3637e-01, PNorm = 42.5412, GNorm = 0.4218, lr_0 = 2.6068e-04
Validation prc-auc = 0.815122
Validation auc = 0.845567
Validation accuracy = 0.776860
Validation f1 = 0.756757
Epoch 18
Loss = 2.4389e-01, PNorm = 42.5677, GNorm = 0.4416, lr_0 = 2.5526e-04
Loss = 1.9369e-01, PNorm = 42.5915, GNorm = 0.5735, lr_0 = 2.5042e-04
Loss = 2.1314e-01, PNorm = 42.6144, GNorm = 0.4145, lr_0 = 2.4568e-04
Loss = 2.0494e-01, PNorm = 42.6362, GNorm = 0.5234, lr_0 = 2.4102e-04
Validation prc-auc = 0.810182
Validation auc = 0.842212
Validation accuracy = 0.768595
Validation f1 = 0.747748
Epoch 19
Loss = 2.1442e-01, PNorm = 42.6588, GNorm = 0.4385, lr_0 = 2.3646e-04
Loss = 1.8409e-01, PNorm = 42.6826, GNorm = 0.4199, lr_0 = 2.3198e-04
Loss = 2.1554e-01, PNorm = 42.7030, GNorm = 0.3851, lr_0 = 2.2758e-04
Loss = 2.0539e-01, PNorm = 42.7218, GNorm = 0.3848, lr_0 = 2.2327e-04
Loss = 2.3069e-01, PNorm = 42.7410, GNorm = 0.4080, lr_0 = 2.1904e-04
Loss = 2.8810e-01, PNorm = 42.7428, GNorm = 0.5126, lr_0 = 2.1863e-04
Validation prc-auc = 0.811501
Validation auc = 0.843239
Validation accuracy = 0.764463
Validation f1 = 0.746667
Epoch 20
Loss = 2.1578e-01, PNorm = 42.7622, GNorm = 0.3979, lr_0 = 2.1448e-04
Loss = 2.0828e-01, PNorm = 42.7820, GNorm = 0.6324, lr_0 = 2.1042e-04
Loss = 1.9482e-01, PNorm = 42.8014, GNorm = 0.4476, lr_0 = 2.0644e-04
Loss = 2.1463e-01, PNorm = 42.8193, GNorm = 0.3631, lr_0 = 2.0252e-04
Validation prc-auc = 0.810414
Validation auc = 0.842485
Validation accuracy = 0.768595
Validation f1 = 0.750000
Epoch 21
Loss = 2.1844e-01, PNorm = 42.8363, GNorm = 0.3195, lr_0 = 1.9869e-04
Loss = 1.8865e-01, PNorm = 42.8552, GNorm = 0.4362, lr_0 = 1.9492e-04
Loss = 2.1278e-01, PNorm = 42.8729, GNorm = 0.4690, lr_0 = 1.9123e-04
Loss = 2.3625e-01, PNorm = 42.8893, GNorm = 0.3347, lr_0 = 1.8761e-04
Validation prc-auc = 0.810071
Validation auc = 0.842349
Validation accuracy = 0.772727
Validation f1 = 0.751131
Epoch 22
Loss = 2.1023e-01, PNorm = 42.9069, GNorm = 0.4445, lr_0 = 1.8370e-04
Loss = 1.9209e-01, PNorm = 42.9241, GNorm = 0.3522, lr_0 = 1.8022e-04
Loss = 2.2756e-01, PNorm = 42.9398, GNorm = 0.5029, lr_0 = 1.7681e-04
Loss = 1.9452e-01, PNorm = 42.9541, GNorm = 0.2718, lr_0 = 1.7346e-04
Loss = 2.0362e-01, PNorm = 42.9687, GNorm = 0.4122, lr_0 = 1.7018e-04
Validation prc-auc = 0.809259
Validation auc = 0.842759
Validation accuracy = 0.772727
Validation f1 = 0.751131
Epoch 23
Loss = 1.8868e-01, PNorm = 42.9844, GNorm = 0.4100, lr_0 = 1.6695e-04
Loss = 1.7038e-01, PNorm = 43.0000, GNorm = 0.3937, lr_0 = 1.6379e-04
Loss = 2.2225e-01, PNorm = 43.0156, GNorm = 0.3799, lr_0 = 1.6069e-04
Loss = 2.0953e-01, PNorm = 43.0297, GNorm = 0.3196, lr_0 = 1.5764e-04
Validation prc-auc = 0.807696
Validation auc = 0.841082
Validation accuracy = 0.776860
Validation f1 = 0.756757
Epoch 24
Loss = 1.7364e-01, PNorm = 43.0448, GNorm = 0.3370, lr_0 = 1.5436e-04
Loss = 2.2800e-01, PNorm = 43.0594, GNorm = 0.3311, lr_0 = 1.5144e-04
Loss = 1.8797e-01, PNorm = 43.0732, GNorm = 0.3172, lr_0 = 1.4857e-04
Loss = 2.1665e-01, PNorm = 43.0864, GNorm = 0.5944, lr_0 = 1.4575e-04
Validation prc-auc = 0.809055
Validation auc = 0.842040
Validation accuracy = 0.776860
Validation f1 = 0.756757
Epoch 25
Loss = 1.9599e-01, PNorm = 43.0986, GNorm = 0.3992, lr_0 = 1.4299e-04
Loss = 2.0694e-01, PNorm = 43.1110, GNorm = 0.4074, lr_0 = 1.4028e-04
Loss = 2.2078e-01, PNorm = 43.1224, GNorm = 0.3840, lr_0 = 1.3763e-04
Loss = 1.8784e-01, PNorm = 43.1333, GNorm = 0.3585, lr_0 = 1.3502e-04
Loss = 1.9232e-01, PNorm = 43.1456, GNorm = 0.3254, lr_0 = 1.3246e-04
Validation prc-auc = 0.806538
Validation auc = 0.840329
Validation accuracy = 0.764463
Validation f1 = 0.748899
Epoch 26
Loss = 2.1605e-01, PNorm = 43.1574, GNorm = 0.4812, lr_0 = 1.2995e-04
Loss = 2.0595e-01, PNorm = 43.1688, GNorm = 0.3588, lr_0 = 1.2749e-04
Loss = 2.1450e-01, PNorm = 43.1800, GNorm = 0.6056, lr_0 = 1.2508e-04
Loss = 1.8806e-01, PNorm = 43.1908, GNorm = 0.2843, lr_0 = 1.2271e-04
Validation prc-auc = 0.804910
Validation auc = 0.839439
Validation accuracy = 0.776860
Validation f1 = 0.756757
Epoch 27
Loss = 1.9699e-01, PNorm = 43.2032, GNorm = 0.5322, lr_0 = 1.2015e-04
Loss = 1.8770e-01, PNorm = 43.2142, GNorm = 0.6035, lr_0 = 1.1788e-04
Loss = 1.9456e-01, PNorm = 43.2253, GNorm = 0.4649, lr_0 = 1.1564e-04
Loss = 2.2293e-01, PNorm = 43.2345, GNorm = 0.4789, lr_0 = 1.1345e-04
Validation prc-auc = 0.806366
Validation auc = 0.840397
Validation accuracy = 0.760331
Validation f1 = 0.743363
Epoch 28
Loss = 1.5891e-01, PNorm = 43.2437, GNorm = 0.3449, lr_0 = 1.1130e-04
Loss = 2.2248e-01, PNorm = 43.2533, GNorm = 0.4176, lr_0 = 1.0920e-04
Loss = 2.0367e-01, PNorm = 43.2629, GNorm = 0.5818, lr_0 = 1.0713e-04
Loss = 1.7104e-01, PNorm = 43.2730, GNorm = 0.3391, lr_0 = 1.0510e-04
Loss = 1.8999e-01, PNorm = 43.2828, GNorm = 0.3273, lr_0 = 1.0311e-04
Validation prc-auc = 0.805863
Validation auc = 0.839952
Validation accuracy = 0.772727
Validation f1 = 0.753363
Epoch 29
Loss = 1.7521e-01, PNorm = 43.2918, GNorm = 0.3996, lr_0 = 1.0096e-04
Loss = 1.7786e-01, PNorm = 43.3009, GNorm = 0.4732, lr_0 = 1.0000e-04
Loss = 2.1003e-01, PNorm = 43.3102, GNorm = 0.3788, lr_0 = 1.0000e-04
Loss = 2.2819e-01, PNorm = 43.3189, GNorm = 0.4068, lr_0 = 1.0000e-04
Validation prc-auc = 0.805976
Validation auc = 0.840329
Validation accuracy = 0.772727
Validation f1 = 0.755556
Model 0 best validation prc-auc = 0.826952 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test prc-auc = 0.793395
Model 0 test auc = 0.861934
Model 0 test accuracy = 0.784522
Model 0 test f1 = 0.742754
Ensemble test prc-auc = 0.793395
Ensemble test auc = 0.861934
Ensemble test accuracy = 0.784522
Ensemble test f1 = 0.742754
5-fold cross validation
	Seed 0 ==> test prc-auc = 0.795653
	Seed 0 ==> test auc = 0.862091
	Seed 0 ==> test accuracy = 0.779970
	Seed 0 ==> test f1 = 0.738739
	Seed 1 ==> test prc-auc = 0.787641
	Seed 1 ==> test auc = 0.859761
	Seed 1 ==> test accuracy = 0.784522
	Seed 1 ==> test f1 = 0.740876
	Seed 2 ==> test prc-auc = 0.794706
	Seed 2 ==> test auc = 0.862244
	Seed 2 ==> test accuracy = 0.789074
	Seed 2 ==> test f1 = 0.750449
	Seed 3 ==> test prc-auc = 0.791480
	Seed 3 ==> test auc = 0.860752
	Seed 3 ==> test accuracy = 0.787557
	Seed 3 ==> test f1 = 0.738806
	Seed 4 ==> test prc-auc = 0.793395
	Seed 4 ==> test auc = 0.861934
	Seed 4 ==> test accuracy = 0.784522
	Seed 4 ==> test f1 = 0.742754
Overall test prc-auc = 0.792575 +/- 0.002837
Overall test auc = 0.861356 +/- 0.000956
Overall test accuracy = 0.785129 +/- 0.003125
Overall test f1 = 0.742325 +/- 0.004325
Elapsed time = 0:13:38
